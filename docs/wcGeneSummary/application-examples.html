<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 10 Application examples | wcGeneSummary (OSplot)</title>
<meta name="author" content="Noriaki Sato">
<meta name="generator" content="bookdown 0.33 with bs4_book()">
<meta property="og:title" content="Chapter 10 Application examples | wcGeneSummary (OSplot)">
<meta property="og:type" content="book">
<meta property="og:url" content="https://noriakis.github.io/software/wcGeneSummary/application-examples.html">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 10 Application examples | wcGeneSummary (OSplot)">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="We demonstrate an use case of the package, which investigates transcriptomic changes induced by BK polyomavirus (BKPyV) infection in renal proximal tubular epithelial cells (Assetta et al. 2016)....">
<meta property="og:description" content="We demonstrate an use case of the package, which investigates transcriptomic changes induced by BK polyomavirus (BKPyV) infection in renal proximal tubular epithelial cells (Assetta et al. 2016)....">
<meta name="twitter:description" content="We demonstrate an use case of the package, which investigates transcriptomic changes induced by BK polyomavirus (BKPyV) infection in renal proximal tubular epithelial cells (Assetta et al. 2016)....">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">wcGeneSummary (OSplot)</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> About</a></li>
<li><a class="" href="basic-usage.html"><span class="header-section-number">2</span> Basic usage</a></li>
<li><a class="" href="the-basic-usage-for-microbiome-related-data.html"><span class="header-section-number">3</span> The basic usage for microbiome-related data</a></li>
<li><a class="" href="interactive-inspection-of-gene-cluster-network-annotated-by-words.html"><span class="header-section-number">4</span> Interactive inspection of gene cluster network annotated by words</a></li>
<li><a class="" href="annotating-gene-cluster-dendrogram.html"><span class="header-section-number">5</span> Annotating gene cluster dendrogram</a></li>
<li><a class="" href="assess-the-occurrence-of-the-speicific-words-across-gene-clusters.html"><span class="header-section-number">6</span> Assess the occurrence of the speicific words across gene clusters</a></li>
<li><a class="" href="recluster-the-cluster-using-word-information.html"><span class="header-section-number">7</span> Recluster the cluster using word information</a></li>
<li><a class="" href="including-the-other-databases-an-example-in-metacyc.html"><span class="header-section-number">8</span> Including the other databases (an example in MetaCyc)</a></li>
<li><a class="" href="pathview-text.html"><span class="header-section-number">9</span> Pathview text</a></li>
<li><a class="active" href="application-examples.html"><span class="header-section-number">10</span> Application examples</a></li>
<li><a class="" href="single-cell-transcriptomic-data.html"><span class="header-section-number">11</span> Single-cell transcriptomic data</a></li>
<li><a class="" href="parsing.html"><span class="header-section-number">12</span> Parsing</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="application-examples" class="section level1" number="10">
<h1>
<span class="header-section-number">10</span> Application examples<a class="anchor" aria-label="anchor" href="#application-examples"><i class="fas fa-link"></i></a>
</h1>
<p>We demonstrate an use case of the package, which investigates transcriptomic changes induced by BK polyomavirus (BKPyV) infection in renal proximal tubular epithelial cells (<a href="https://pubmed.ncbi.nlm.nih.gov/27381292/">Assetta et al. 2016</a>). Differentially expressed mRNAs in 3 days post-infection were obtained, and down-regulated mRNAs in BKPyV infected cells were examined.</p>
<div id="load-the-necessary-packages-and-genes" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> Load the necessary packages and genes<a class="anchor" aria-label="anchor" href="#load-the-necessary-packages-and-genes"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">wcGeneSummary</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/biomedical-knowledge-mining-book/">ReactomePA</a></span><span class="op">)</span>;<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/biomedical-knowledge-mining-book/">clusterProfiler</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com">ggraph</a></span><span class="op">)</span>;<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggforce.data-imaginist.com">ggforce</a></span><span class="op">)</span> <span class="co">## For genePathPlot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sysdata.rda"</span>, package <span class="op">=</span> <span class="st">"wcGeneSummary"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">degs</span> <span class="op">&lt;-</span> <span class="va">d3degDownAssetta2016</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">degs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 191</span></span>
<span><span class="va">degs</span></span>
<span><span class="co">#&gt;   [1] "ABCB4"           "ABCB7"           "AKTIP"          </span></span>
<span><span class="co">#&gt;   [4] "ALS2"            "ANKRA2"          "ANTXR1"         </span></span>
<span><span class="co">#&gt;   [7] "APH1B"           "ARHGEF28"        "ARNTL"          </span></span>
<span><span class="co">#&gt;  [10] "ATMIN"           "BDH2"            "BIRC2"          </span></span>
<span><span class="co">#&gt;  [13] "BTG1"            "BTG2"            "C4A"            </span></span>
<span><span class="co">#&gt;  [16] "C7orf60"         "C8orf4"          "CALCOCO1"       </span></span>
<span><span class="co">#&gt;  [19] "CAPRIN2"         "CARS"            "CBLB"           </span></span>
<span><span class="co">#&gt;  [22] "CCNDBP1"         "CCNG2"           "CCZ1B"          </span></span>
<span><span class="co">#&gt;  [25] "CDC42EP3"        "CDH6"            "CFLAR"          </span></span>
<span><span class="co">#&gt;  [28] "CHMP1B"          "CHMP4C"          "CLUAP1"         </span></span>
<span><span class="co">#&gt;  [31] "COG2"            "COG3"            "CPQ"            </span></span>
<span><span class="co">#&gt;  [34] "CROT"            "CTTNBP2NL"       "CYP4V2"         </span></span>
<span><span class="co">#&gt;  [37] "DAB2"            "DDB2"            "DDX17"          </span></span>
<span><span class="co">#&gt;  [40] "DDX5"            "DGKA"            "DHX32"          </span></span>
<span><span class="co">#&gt;  [43] "DLG1"            "DYNC2LI1"        "DYRK2"          </span></span>
<span><span class="co">#&gt;  [46] "EFHC1"           "EIF4A2"          "ERMAP"          </span></span>
<span><span class="co">#&gt;  [49] "ERMARD"          "EXOC1"           "FAM134B"        </span></span>
<span><span class="co">#&gt;  [52] "FAM160B1"        "FAM21C"          "FAM84B"         </span></span>
<span><span class="co">#&gt;  [55] "FANK1"           "FAS"             "FBXO38"         </span></span>
<span><span class="co">#&gt;  [58] "FCHO2"           "FGD6"            "FLJ22447"       </span></span>
<span><span class="co">#&gt;  [61] "FMNL2"           "GADD45A"         "GJA1"           </span></span>
<span><span class="co">#&gt;  [64] "GLIDR"           "GLT8D1"          "GOPC"           </span></span>
<span><span class="co">#&gt;  [67] "GPBP1L1"         "GPR155"          "GPR75-ASB3"     </span></span>
<span><span class="co">#&gt;  [70] "GRAMD3"          "HADHB"           "HCG11"          </span></span>
<span><span class="co">#&gt;  [73] "HDAC9"           "HDHD2"           "HERPUD1"        </span></span>
<span><span class="co">#&gt;  [76] "HSDL2"           "ICA1"            "ICK"            </span></span>
<span><span class="co">#&gt;  [79] "IFNGR1"          "IFT46"           "IFT74"          </span></span>
<span><span class="co">#&gt;  [82] "IRF6"            "ITGA2"           "ITGA6"          </span></span>
<span><span class="co">#&gt;  [85] "ITGAV"           "ITGB6"           "KDM5B"          </span></span>
<span><span class="co">#&gt;  [88] "KIF3A"           "KIF5B"           "KLHL20"         </span></span>
<span><span class="co">#&gt;  [91] "KLHL24"          "KLHL9"           "KPNA5"          </span></span>
<span><span class="co">#&gt;  [94] "KRCC1"           "L3MBTL3"         "LINC00657"      </span></span>
<span><span class="co">#&gt;  [97] "LOC100131564"    "LZTFL1"          "MAMDC2"         </span></span>
<span><span class="co">#&gt; [100] "MAP4K5"          "MAT2B"           "MBNL2"          </span></span>
<span><span class="co">#&gt; [103] "MDM2"            "MECOM"           "MFSD1"          </span></span>
<span><span class="co">#&gt; [106] "MGEA5"           "MICU3"           "MSANTD4"        </span></span>
<span><span class="co">#&gt; [109] "NBPF11"          "NCBP2"           "NEAT1"          </span></span>
<span><span class="co">#&gt; [112] "NTM"             "OGT"             "PAFAH1B2"       </span></span>
<span><span class="co">#&gt; [115] "PAFAH2"          "PCMTD2"          "PDE4D"          </span></span>
<span><span class="co">#&gt; [118] "PDP1"            "PELI1"           "PEX1"           </span></span>
<span><span class="co">#&gt; [121] "PHF14"           "PHOSPHO2-KLHL23" "PIK3IP1"        </span></span>
<span><span class="co">#&gt; [124] "PLA2R1"          "PLCB4"           "PLK2"           </span></span>
<span><span class="co">#&gt; [127] "POLI"            "POSTN"           "PPAN-P2RY11"    </span></span>
<span><span class="co">#&gt; [130] "PPFIBP1"         "PPP2CB"          "PRICKLE1"       </span></span>
<span><span class="co">#&gt; [133] "PROS1"           "PSMD5-AS1"       "RAD17"          </span></span>
<span><span class="co">#&gt; [136] "RHOQ"            "RIMKLB"          "RNA18S5"        </span></span>
<span><span class="co">#&gt; [139] "RNF170"          "RNF20"           "RNU1-28P"       </span></span>
<span><span class="co">#&gt; [142] "RPL23AP53"       "RRM2B"           "RRN3"           </span></span>
<span><span class="co">#&gt; [145] "RRN3P1"          "SEMA3C"          "SERINC1"        </span></span>
<span><span class="co">#&gt; [148] "SESN1"           "SESN3"           "SGK1"           </span></span>
<span><span class="co">#&gt; [151] "SLC22A5"         "SLC37A3"         "SVIL"           </span></span>
<span><span class="co">#&gt; [154] "SYT11"           "TARSL2"          "TBC1D19"        </span></span>
<span><span class="co">#&gt; [157] "TBCK"            "TBRG1"           "TGFA"           </span></span>
<span><span class="co">#&gt; [160] "TGFB2"           "TIPARP"          "TMEM136"        </span></span>
<span><span class="co">#&gt; [163] "TNFRSF10B"       "TNFRSF10D"       "TOM1L1"         </span></span>
<span><span class="co">#&gt; [166] "TP53INP1"        "TRIM13"          "TRIM32"         </span></span>
<span><span class="co">#&gt; [169] "TRIM4"           "TSC1"            "TSPYL5"         </span></span>
<span><span class="co">#&gt; [172] "UGT2B7"          "UNC13B"          "UPRT"           </span></span>
<span><span class="co">#&gt; [175] "VPS41"           "VPS8"            "WDR11"          </span></span>
<span><span class="co">#&gt; [178] "WDR19"           "XPC"             "YPEL2"          </span></span>
<span><span class="co">#&gt; [181] "ZC2HC1A"         "ZFAND5"          "ZFP90"          </span></span>
<span><span class="co">#&gt; [184] "ZFR"             "ZMAT3"           "ZNF12"          </span></span>
<span><span class="co">#&gt; [187] "ZNF248"          "ZNF322"          "ZNF561"         </span></span>
<span><span class="co">#&gt; [190] "ZNF626"          "ZSCAN30"</span></span></code></pre></div>
</div>
<div id="enrichment-analysis" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> Enrichment analysis<a class="anchor" aria-label="anchor" href="#enrichment-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>First, we perform enrichment analysis using ReactomePA.
From the enrichment analysis results, the cluster is related to transcriptional regulation by TP53.</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Convert to ENTREZID</span></span>
<span><span class="va">entre</span> <span class="op">&lt;-</span> <span class="fu">AnnotationDbi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html">select</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span>, keytype<span class="op">=</span><span class="st">"SYMBOL"</span>,</span>
<span>                               keys <span class="op">=</span> <span class="va">degs</span>, columns <span class="op">=</span> <span class="st">"ENTREZID"</span><span class="op">)</span><span class="op">$</span><span class="va">ENTREZID</span></span>
<span><span class="va">pway</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DOSE/man/setReadable.html">setReadable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ReactomePA/man/enrichPathway.html">enrichPathway</a></span><span class="op">(</span><span class="va">entre</span><span class="op">)</span>, <span class="va">org.Hs.eg.db</span><span class="op">)</span></span>
<span><span class="va">sigpway</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">pway</span><span class="op">@</span><span class="va">result</span>, <span class="va">p.adjust</span><span class="op">&lt;</span><span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">sigpway</span><span class="op">$</span><span class="va">Description</span></span>
<span><span class="co">#&gt;  [1] "Transcriptional Regulation by TP53"                              </span></span>
<span><span class="co">#&gt;  [2] "RIPK1-mediated regulated necrosis"                               </span></span>
<span><span class="co">#&gt;  [3] "Regulation of necroptotic cell death"                            </span></span>
<span><span class="co">#&gt;  [4] "Regulated Necrosis"                                              </span></span>
<span><span class="co">#&gt;  [5] "Intraflagellar transport"                                        </span></span>
<span><span class="co">#&gt;  [6] "Regulation by c-FLIP"                                            </span></span>
<span><span class="co">#&gt;  [7] "CASP8 activity is inhibited"                                     </span></span>
<span><span class="co">#&gt;  [8] "Dimerization of procaspase-8"                                    </span></span>
<span><span class="co">#&gt;  [9] "TP53 Regulates Transcription of Death Receptors and Ligands"     </span></span>
<span><span class="co">#&gt; [10] "Caspase activation via Death Receptors in the presence of ligand"</span></span>
<span><span class="co">#&gt; [11] "FOXO-mediated transcription of cell cycle genes"                 </span></span>
<span><span class="co">#&gt; [12] "TP53 Regulates Transcription of Cell Death Genes"                </span></span>
<span><span class="co">#&gt; [13] "Cilium Assembly"</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/cnetplot.html">cnetplot</a></span><span class="op">(</span><span class="va">pway</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-application_example_BKPyV_files/figure-html/ea-1.png" width="672"></div>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## Genes involved in significant pathways</span></span>
<span><span class="va">excheck</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">sigpway</span><span class="op">$</span><span class="va">geneID</span>,</span>
<span>                                <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">x</span>,<span class="st">"/"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">excheck</span></span>
<span><span class="co">#&gt;  [1] "BTG2"      "DDB2"      "DYRK2"     "FAS"      </span></span>
<span><span class="co">#&gt;  [5] "GADD45A"   "MDM2"      "PLK2"      "PPP2CB"   </span></span>
<span><span class="co">#&gt;  [9] "RAD17"     "RRM2B"     "SESN1"     "SESN3"    </span></span>
<span><span class="co">#&gt; [13] "SGK1"      "TNFRSF10B" "TNFRSF10D" "TP53INP1" </span></span>
<span><span class="co">#&gt; [17] "TSC1"      "BIRC2"     "CFLAR"     "FAS"      </span></span>
<span><span class="co">#&gt; [21] "OGT"       "PELI1"     "TNFRSF10B" "BIRC2"    </span></span>
<span><span class="co">#&gt; [25] "CFLAR"     "CHMP4C"    "FAS"       "OGT"      </span></span>
<span><span class="co">#&gt; [29] "PELI1"     "TNFRSF10B" "CLUAP1"    "DYNC2LI1" </span></span>
<span><span class="co">#&gt; [33] "IFT46"     "IFT74"     "KIF3A"     "WDR19"    </span></span>
<span><span class="co">#&gt; [37] "CFLAR"     "FAS"       "TNFRSF10B" "FAS"      </span></span>
<span><span class="co">#&gt; [41] "TNFRSF10B" "TNFRSF10D" "BTG1"      "CCNG2"    </span></span>
<span><span class="co">#&gt; [45] "GADD45A"   "FAS"       "TNFRSF10B" "TNFRSF10D"</span></span>
<span><span class="co">#&gt; [49] "TP53INP1"  "CLUAP1"    "DYNC2LI1"  "EXOC1"    </span></span>
<span><span class="co">#&gt; [53] "IFT46"     "IFT74"     "KIF3A"     "LZTFL1"   </span></span>
<span><span class="co">#&gt; [57] "WDR19"</span></span></code></pre></div>
<p>We store the name of enriched pathways in the network for the downstream analysis.</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">netreac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/wcGeneSummary/man/wcGeneSummary.html">wcGeneSummary</a></span><span class="op">(</span><span class="va">degs</span>,</span>
<span>                         enrich<span class="op">=</span><span class="st">"reactome"</span>,</span>
<span>                         plotType<span class="op">=</span><span class="st">"network"</span>,</span>
<span>                         numWords<span class="op">=</span><span class="fl">50</span>,</span>
<span>                         colorText<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Input genes: 191</span></span>
<span><span class="co">#&gt; 'select()' returned 1:1 mapping between keys and</span></span>
<span><span class="co">#&gt; columns</span></span>
<span><span class="co">#&gt;   Converted input genes: 174</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 65 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; Performing enrichment analysis</span></span></code></pre></div>
</div>
<div id="text-mining-the-gene-summaries" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> Text mining the gene summaries<a class="anchor" aria-label="anchor" href="#text-mining-the-gene-summaries"><i class="fas fa-link"></i></a>
</h2>
<p>Next we perform the plain function producing a correlation network, with showing the top-genes related to high-frequency words in the text in RefSeq summary. We obtained the list of these genes from geneCount slot.</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">net1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/wcGeneSummary/man/wcGeneSummary.html">wcGeneSummary</a></span><span class="op">(</span><span class="va">excheck</span>,</span>
<span>                      plotType<span class="op">=</span><span class="st">"network"</span>,</span>
<span>                      colorText<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                      numWords<span class="op">=</span><span class="fl">30</span>,</span>
<span>                      corThresh<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>                      genePlot<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                      genePlotNum<span class="op">=</span><span class="fl">5</span>,</span>
<span>                      edgeLink<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                      genePathPlot<span class="op">=</span><span class="st">"reactome"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Input genes: 57</span></span>
<span><span class="co">#&gt;   Converted input genes: 57</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 65 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; Found 28 enriched term</span></span>
<span><span class="va">net1</span><span class="op">@</span><span class="va">net</span></span></code></pre></div>
<div class="inline-figure"><img src="06-application_example_BKPyV_files/figure-html/basic2app-1.png" width="960"></div>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">net1</span><span class="op">@</span><span class="va">geneCount</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     RAD17     SESN1      TSC1      DDB2 TNFRSF10B      BTG1 </span></span>
<span><span class="co">#&gt;         9         9         6         5         5         4 </span></span>
<span><span class="co">#&gt;     DYRK2     BIRC2     CCNG2       FAS   GADD45A    LZTFL1 </span></span>
<span><span class="co">#&gt;         4         3         3         3         3         3 </span></span>
<span><span class="co">#&gt;      MDM2     SESN3      SGK1     CFLAR    CHMP4C       OGT </span></span>
<span><span class="co">#&gt;         3         3         3         2         2         2 </span></span>
<span><span class="co">#&gt; TNFRSF10D     WDR19      BTG2  DYNC2LI1     EXOC1     IFT74 </span></span>
<span><span class="co">#&gt;         2         2         1         1         1         1 </span></span>
<span><span class="co">#&gt;    PPP2CB     RRM2B </span></span>
<span><span class="co">#&gt;         1         1</span></span>
<span><span class="va">top</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">net1</span><span class="op">@</span><span class="va">geneCount</span><span class="op">[</span><span class="va">net1</span><span class="op">@</span><span class="va">geneCount</span><span class="op">&gt;=</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">top</span></span>
<span><span class="co">#&gt; [1] "RAD17"     "SESN1"     "TSC1"      "DDB2"     </span></span>
<span><span class="co">#&gt; [5] "TNFRSF10B"</span></span></code></pre></div>
</div>
<div id="text-mining-the-available-literature" class="section level2" number="10.4">
<h2>
<span class="header-section-number">10.4</span> Text mining the available literature<a class="anchor" aria-label="anchor" href="#text-mining-the-available-literature"><i class="fas fa-link"></i></a>
</h2>
<p>These genes are further queried for PubMed information.
First, show the network for the article titles.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">titlenet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/wcGeneSummary/man/wcAbst.html">wcAbst</a></span><span class="op">(</span><span class="va">top</span>,</span>
<span>                   sortOrder<span class="op">=</span><span class="st">"relevance"</span>,</span>
<span>                   target<span class="op">=</span><span class="st">"title"</span>,</span>
<span>                   plotType<span class="op">=</span><span class="st">"network"</span>,</span>
<span>                   colorText<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   madeUpperGenes<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                   corThresh<span class="op">=</span><span class="fl">0.2</span>,</span>
<span>                   pre<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   retMax<span class="op">=</span><span class="fl">40</span>,</span>
<span>                   numWords<span class="op">=</span><span class="fl">40</span>,</span>
<span>                   edgeLink<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Proceeding without API key</span></span>
<span><span class="va">titlenet</span><span class="op">@</span><span class="va">net</span></span></code></pre></div>
<div class="inline-figure"><img src="06-application_example_BKPyV_files/figure-html/absttitleapp-1.png" width="864"></div>
<p>Obtain and show the network for the article abstract.</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">abstnet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/wcGeneSummary/man/wcAbst.html">wcAbst</a></span><span class="op">(</span><span class="va">top</span>,</span>
<span>                   target<span class="op">=</span><span class="st">"abstract"</span>,</span>
<span>                   plotType<span class="op">=</span><span class="st">"network"</span>,</span>
<span>                   colorText<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   madeUpperGenes<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                   corThresh<span class="op">=</span><span class="fl">0.2</span>,</span>
<span>                   pre<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   retMax<span class="op">=</span><span class="fl">40</span>,</span>
<span>                   numWords<span class="op">=</span><span class="fl">40</span>,</span>
<span>                   edgeLink<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Proceeding without API key</span></span>
<span><span class="va">abstnet</span><span class="op">@</span><span class="va">net</span></span></code></pre></div>
<div class="inline-figure"><img src="06-application_example_BKPyV_files/figure-html/abstmainapp-1.png" width="864"></div>
</div>
<div id="combine-and-compare-networks" class="section level2" number="10.5">
<h2>
<span class="header-section-number">10.5</span> Combine and compare networks<a class="anchor" aria-label="anchor" href="#combine-and-compare-networks"><i class="fas fa-link"></i></a>
</h2>
<p>From the RefSeq summary and articles related to important genes, the cluster could have functionality of DNA damage response, which is also upregulated by BKPyV infection. These networks can be combined to find intersections and differences. We can see that in addition to Reactome pathway names, plenty of information could be obtained and summarized by querying other databases, which could aid in interpreting clusters of genes and hypothesis generation.</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/wcGeneSummary/man/compareWordNet.html">compareWordNet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">abstnet</span>, <span class="va">titlenet</span>, <span class="va">netreac</span>, <span class="va">net1</span><span class="op">)</span>,</span>
<span>               titles<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Abstract"</span>,<span class="st">"Title"</span>,<span class="st">"Reactome"</span>,<span class="st">"RefSeq"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in RColorBrewer::brewer.pal(catNum, colPal): n too large, allowed maximum for palette Pastel1 is 9</span></span>
<span><span class="co">#&gt; Returning the palette you asked for with that many colors</span></span>
<span><span class="co">#&gt; Warning in grid.Call(C_stringMetric,</span></span>
<span><span class="co">#&gt; as.graphicsAnnot(x$label)): font family not found in</span></span>
<span><span class="co">#&gt; Windows font database</span></span>
<span></span>
<span><span class="co">#&gt; Warning in grid.Call(C_stringMetric,</span></span>
<span><span class="co">#&gt; as.graphicsAnnot(x$label)): font family not found in</span></span>
<span><span class="co">#&gt; Windows font database</span></span>
<span><span class="co">#&gt; Warning in grid.Call(C_textBounds,</span></span>
<span><span class="co">#&gt; as.graphicsAnnot(x$label), x$x, x$y, : font family not</span></span>
<span><span class="co">#&gt; found in Windows font database</span></span>
<span></span>
<span><span class="co">#&gt; Warning in grid.Call(C_textBounds,</span></span>
<span><span class="co">#&gt; as.graphicsAnnot(x$label), x$x, x$y, : font family not</span></span>
<span><span class="co">#&gt; found in Windows font database</span></span>
<span></span>
<span><span class="co">#&gt; Warning in grid.Call(C_textBounds,</span></span>
<span><span class="co">#&gt; as.graphicsAnnot(x$label), x$x, x$y, : font family not</span></span>
<span><span class="co">#&gt; found in Windows font database</span></span>
<span></span>
<span><span class="co">#&gt; Warning in grid.Call(C_textBounds,</span></span>
<span><span class="co">#&gt; as.graphicsAnnot(x$label), x$x, x$y, : font family not</span></span>
<span><span class="co">#&gt; found in Windows font database</span></span>
<span></span>
<span><span class="co">#&gt; Warning in grid.Call(C_textBounds,</span></span>
<span><span class="co">#&gt; as.graphicsAnnot(x$label), x$x, x$y, : font family not</span></span>
<span><span class="co">#&gt; found in Windows font database</span></span>
<span></span>
<span><span class="co">#&gt; Warning in grid.Call(C_textBounds,</span></span>
<span><span class="co">#&gt; as.graphicsAnnot(x$label), x$x, x$y, : font family not</span></span>
<span><span class="co">#&gt; found in Windows font database</span></span></code></pre></div>
<div class="inline-figure"><img src="06-application_example_BKPyV_files/figure-html/combineapp-1.png" width="1920"></div>
<p>From the network, DNA damage repair pathway, especially nucleotide excision repair related to DDB2, METTL14,and RAD17 might be related to BKPyV infection, which cannot be prioritize based on log2FoldChange or enrichment analysis.</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/wcGeneSummary/man/compareWordNet.html">compareWordNet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">netreac</span>,</span>
<span>                    <span class="va">net1</span>,</span>
<span>                    <span class="va">titlenet</span>,</span>
<span>                    <span class="va">abstnet</span><span class="op">)</span>,</span>
<span>               returnNet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ddrNms</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">nm</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">conet</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="va">nm</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dna"</span>,<span class="st">"damage"</span>,<span class="st">"repair"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">ddrNms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ddrNms</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/neighbors.html">neighbors</a></span><span class="op">(</span><span class="va">conet</span>, <span class="va">nm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">ddrNms</span></span>
<span><span class="co">#&gt;  [1] "checkpoint"      "cycle"           "DNA"            </span></span>
<span><span class="co">#&gt;  [4] "phosphorylation" "required"        "response"       </span></span>
<span><span class="co">#&gt;  [7] "DDB2"            "SESN1"           "RAD17"          </span></span>
<span><span class="co">#&gt; [10] "checkpoint"      "cycle"           "damage"         </span></span>
<span><span class="co">#&gt; [13] "phosphorylation" "required"        "response"       </span></span>
<span><span class="co">#&gt; [16] "DDB2"            "SESN1"           "RAD17"          </span></span>
<span><span class="co">#&gt; [19] "Cancer"          "complex"         "degradation"    </span></span>
<span><span class="co">#&gt; [22] "protein"         "regulates"       "CDT2"           </span></span>
<span><span class="co">#&gt; [25] "chromatin"       "Damage"          "function"       </span></span>
<span><span class="co">#&gt; [28] "induced"         "repair"          "Excision"       </span></span>
<span><span class="co">#&gt; [31] "Global"          "Nucleotide"      "Proteins"       </span></span>
<span><span class="co">#&gt; [34] "regulates"       "checkpoint"      "DNA"            </span></span>
<span><span class="co">#&gt; [37] "response"        "DDB2"            "RAD17"          </span></span>
<span><span class="co">#&gt; [40] "Cancer"          "chromatin"       "function"       </span></span>
<span><span class="co">#&gt; [43] "DNA"             "DDB2"            "protein"        </span></span>
<span><span class="co">#&gt; [46] "METTL14"</span></span>
<span></span>
<span><span class="va">ddrRelated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/subgraph.html">induced.subgraph</a></span><span class="op">(</span><span class="va">conet</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">conet</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">ddrNms</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">ddrRelated</span><span class="op">)</span><span class="op">$</span><span class="va">SYMBOL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">ddrRelated</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html">keys</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span>,<span class="st">"SYMBOL"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">ddrRelated</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_diagonal.html">geom_edge_diagonal2</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"grey80"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">SYMBOL</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_text.html">geom_node_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">name</span>, color<span class="op">=</span><span class="va">SYMBOL</span><span class="op">)</span>,check_overlap<span class="op">=</span><span class="cn">TRUE</span>, repel<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   bg.color <span class="op">=</span> <span class="st">"white"</span>, segment.color<span class="op">=</span><span class="st">"black"</span>,</span>
<span>                   bg.r <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>,<span class="st">"tomato"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/theme_graph.html">theme_graph</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using "stress" as default layout</span></span>
<span><span class="co">#&gt; Warning: Using the `size` aesthetic in this geom was deprecated in</span></span>
<span><span class="co">#&gt; ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; ℹ Please use `linewidth` in the `default_aes` field and</span></span>
<span><span class="co">#&gt;   elsewhere instead.</span></span>
<span><span class="co">#&gt; Warning in grid.Call(C_textBounds,</span></span>
<span><span class="co">#&gt; as.graphicsAnnot(x$label), x$x, x$y, : font family not</span></span>
<span><span class="co">#&gt; found in Windows font database</span></span>
<span></span>
<span><span class="co">#&gt; Warning in grid.Call(C_textBounds,</span></span>
<span><span class="co">#&gt; as.graphicsAnnot(x$label), x$x, x$y, : font family not</span></span>
<span><span class="co">#&gt; found in Windows font database</span></span>
<span></span>
<span><span class="co">#&gt; Warning in grid.Call(C_textBounds,</span></span>
<span><span class="co">#&gt; as.graphicsAnnot(x$label), x$x, x$y, : font family not</span></span>
<span><span class="co">#&gt; found in Windows font database</span></span>
<span></span>
<span><span class="co">#&gt; Warning in grid.Call(C_textBounds,</span></span>
<span><span class="co">#&gt; as.graphicsAnnot(x$label), x$x, x$y, : font family not</span></span>
<span><span class="co">#&gt; found in Windows font database</span></span></code></pre></div>
<div class="inline-figure"><img src="06-application_example_BKPyV_files/figure-html/ddr-1.png" width="672"></div>
<p>The network can be obtained by <code>returnNet=TRUE</code>, which can be used for downstream analysis like assessment of degrees and community detection.</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">conetDeg</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/degree.html">degree</a></span><span class="op">(</span><span class="va">conet</span><span class="op">)</span></span>
<span><span class="va">conetDeg</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">conetDeg</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="co">#&gt;        SESN1          DNA        RAD17      protein </span></span>
<span><span class="co">#&gt;           25           20           17           16 </span></span>
<span><span class="co">#&gt;   checkpoint       Cancer        Human         DDB2 </span></span>
<span><span class="co">#&gt;           15           15           15           14 </span></span>
<span><span class="co">#&gt;       growth         TP53         TSC1   activation </span></span>
<span><span class="co">#&gt;           13           12           12           10 </span></span>
<span><span class="co">#&gt;      complex inflammation        Death </span></span>
<span><span class="co">#&gt;           10           10            9</span></span>
<span></span>
<span><span class="va">conet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/subgraph.html">induced_subgraph</a></span><span class="op">(</span><span class="va">conet</span>, <span class="va">conetDeg</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wt</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/cluster_walktrap.html">walktrap.community</a></span><span class="op">(</span><span class="va">conet</span><span class="op">)</span></span>
<span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">conet</span><span class="op">)</span><span class="op">$</span><span class="va">walktrap</span> <span class="op">&lt;-</span> <span class="va">wt</span><span class="op">$</span><span class="va">membership</span></span>
<span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">wt</span><span class="op">$</span><span class="va">membership</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                <span class="st">"Dark2"</span><span class="op">)</span> </span>
<span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="va">pal</span><span class="op">)</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">conet</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"grey80"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">walktrap</span><span class="op">)</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_text.html">geom_node_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">name</span>, color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">walktrap</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   check_overlap<span class="op">=</span><span class="cn">TRUE</span>, repel<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   bg.color <span class="op">=</span> <span class="st">"white"</span>, segment.color<span class="op">=</span><span class="st">"black"</span>,</span>
<span>                   bg.r <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">pal</span>,</span>
<span>                         name<span class="op">=</span><span class="st">"Walktrap"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/theme_graph.html">theme_graph</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using "stress" as default layout</span></span>
<span><span class="co">#&gt; Warning in grid.Call(C_textBounds,</span></span>
<span><span class="co">#&gt; as.graphicsAnnot(x$label), x$x, x$y, : font family not</span></span>
<span><span class="co">#&gt; found in Windows font database</span></span>
<span></span>
<span><span class="co">#&gt; Warning in grid.Call(C_textBounds,</span></span>
<span><span class="co">#&gt; as.graphicsAnnot(x$label), x$x, x$y, : font family not</span></span>
<span><span class="co">#&gt; found in Windows font database</span></span>
<span></span>
<span><span class="co">#&gt; Warning in grid.Call(C_textBounds,</span></span>
<span><span class="co">#&gt; as.graphicsAnnot(x$label), x$x, x$y, : font family not</span></span>
<span><span class="co">#&gt; found in Windows font database</span></span>
<span></span>
<span><span class="co">#&gt; Warning in grid.Call(C_textBounds,</span></span>
<span><span class="co">#&gt; as.graphicsAnnot(x$label), x$x, x$y, : font family not</span></span>
<span><span class="co">#&gt; found in Windows font database</span></span></code></pre></div>
<div class="inline-figure"><img src="06-application_example_BKPyV_files/figure-html/combineNet-1.png" width="960"></div>
<p>Dynamic layout can be also used to compare the networks, by <code>graphlayouts</code>, for comparing the multiple graphs, especially useful for time-series analysis. See the documentation of <a href="http://graphlayouts.schochastics.net/reference/layout_dynamic.html"><code>layout_as_dynamic</code></a> for specifying the alpha, which is default to 0.5.</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span></span>
<span><span class="va">dyn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/wcGeneSummary/man/plotDynamic.html">plotDynamic</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">abstnet</span>, <span class="va">titlenet</span><span class="op">)</span>, concat<span class="op">=</span><span class="st">"intersection"</span>,</span>
<span>                   titles<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Abstract"</span>,<span class="st">"Title"</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">dyn</span></span></code></pre></div>
<div class="inline-figure"><img src="06-application_example_BKPyV_files/figure-html/dyn-1.png" width="1440"></div>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.2.2 (2022-10-31 ucrt)</span></span>
<span><span class="co">#&gt; Platform: x86_64-w64-mingw32/x64 (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Windows 10 x64 (build 19044)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] LC_COLLATE=Japanese_Japan.utf8 </span></span>
<span><span class="co">#&gt; [2] LC_CTYPE=Japanese_Japan.utf8   </span></span>
<span><span class="co">#&gt; [3] LC_MONETARY=Japanese_Japan.utf8</span></span>
<span><span class="co">#&gt; [4] LC_NUMERIC=C                   </span></span>
<span><span class="co">#&gt; [5] LC_TIME=Japanese_Japan.utf8    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils    </span></span>
<span><span class="co">#&gt; [6] datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] ggforce_0.4.1         igraph_1.4.1         </span></span>
<span><span class="co">#&gt;  [3] ggraph_2.1.0          clusterProfiler_4.6.2</span></span>
<span><span class="co">#&gt;  [5] ReactomePA_1.42.0     org.Hs.eg.db_3.16.0  </span></span>
<span><span class="co">#&gt;  [7] AnnotationDbi_1.60.0  IRanges_2.32.0       </span></span>
<span><span class="co">#&gt;  [9] S4Vectors_0.36.2      Biobase_2.58.0       </span></span>
<span><span class="co">#&gt; [11] BiocGenerics_0.44.0   wcGeneSummary_0.99.0 </span></span>
<span><span class="co">#&gt; [13] ggplot2_3.4.1        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] shadowtext_0.1.2       fastmatch_1.1-3       </span></span>
<span><span class="co">#&gt;   [3] plyr_1.8.8             lazyeval_0.2.2        </span></span>
<span><span class="co">#&gt;   [5] splines_4.2.2          BiocParallel_1.32.5   </span></span>
<span><span class="co">#&gt;   [7] GenomeInfoDb_1.34.9    digest_0.6.31         </span></span>
<span><span class="co">#&gt;   [9] yulab.utils_0.0.6      htmltools_0.5.4       </span></span>
<span><span class="co">#&gt;  [11] bugsigdbr_1.4.3        GOSemSim_2.24.0       </span></span>
<span><span class="co">#&gt;  [13] viridis_0.6.2          GO.db_3.16.0          </span></span>
<span><span class="co">#&gt;  [15] fansi_1.0.4            GeneSummary_0.99.4    </span></span>
<span><span class="co">#&gt;  [17] magrittr_2.0.3         memoise_2.0.1         </span></span>
<span><span class="co">#&gt;  [19] tm_0.7-11              Biostrings_2.66.0     </span></span>
<span><span class="co">#&gt;  [21] graphlayouts_0.8.4     pvclust_2.2-0         </span></span>
<span><span class="co">#&gt;  [23] wordcloud_2.6          enrichplot_1.18.3     </span></span>
<span><span class="co">#&gt;  [25] colorspace_2.1-0       rappdirs_0.3.3        </span></span>
<span><span class="co">#&gt;  [27] blob_1.2.3             ggrepel_0.9.3         </span></span>
<span><span class="co">#&gt;  [29] xfun_0.37              dplyr_1.1.0           </span></span>
<span><span class="co">#&gt;  [31] crayon_1.5.2           RCurl_1.98-1.10       </span></span>
<span><span class="co">#&gt;  [33] jsonlite_1.8.4         scatterpie_0.1.8.001  </span></span>
<span><span class="co">#&gt;  [35] graph_1.76.0           ape_5.7               </span></span>
<span><span class="co">#&gt;  [37] glue_1.6.2             polyclip_1.10-4       </span></span>
<span><span class="co">#&gt;  [39] gtable_0.3.1           zlibbioc_1.44.0       </span></span>
<span><span class="co">#&gt;  [41] XVector_0.38.0         GetoptLong_1.0.5      </span></span>
<span><span class="co">#&gt;  [43] graphite_1.44.0        rentrez_1.2.3         </span></span>
<span><span class="co">#&gt;  [45] scales_1.2.1           DOSE_3.24.2           </span></span>
<span><span class="co">#&gt;  [47] DBI_1.1.3              Rcpp_1.0.10           </span></span>
<span><span class="co">#&gt;  [49] viridisLite_0.4.1      xtable_1.8-4          </span></span>
<span><span class="co">#&gt;  [51] tidytree_0.4.2         gridGraphics_0.5-1    </span></span>
<span><span class="co">#&gt;  [53] reactome.db_1.82.0     bit_4.0.5             </span></span>
<span><span class="co">#&gt;  [55] htmlwidgets_1.6.1      httr_1.4.5            </span></span>
<span><span class="co">#&gt;  [57] fgsea_1.24.0           RColorBrewer_1.1-3    </span></span>
<span><span class="co">#&gt;  [59] ellipsis_0.3.2         pkgconfig_2.0.3       </span></span>
<span><span class="co">#&gt;  [61] XML_3.99-0.13          farver_2.1.1          </span></span>
<span><span class="co">#&gt;  [63] sass_0.4.5             utf8_1.2.3            </span></span>
<span><span class="co">#&gt;  [65] ggplotify_0.1.0        tidyselect_1.2.0      </span></span>
<span><span class="co">#&gt;  [67] rlang_1.0.6            reshape2_1.4.4        </span></span>
<span><span class="co">#&gt;  [69] later_1.3.0            munsell_0.5.0         </span></span>
<span><span class="co">#&gt;  [71] tools_4.2.2            cachem_1.0.7          </span></span>
<span><span class="co">#&gt;  [73] downloader_0.4         cli_3.6.0             </span></span>
<span><span class="co">#&gt;  [75] generics_0.1.3         RSQLite_2.3.0         </span></span>
<span><span class="co">#&gt;  [77] gson_0.0.9             evaluate_0.20         </span></span>
<span><span class="co">#&gt;  [79] stringr_1.5.0          fastmap_1.1.1         </span></span>
<span><span class="co">#&gt;  [81] ggdendro_0.1.23        yaml_2.3.7            </span></span>
<span><span class="co">#&gt;  [83] ggtree_3.6.2           knitr_1.42            </span></span>
<span><span class="co">#&gt;  [85] bit64_4.0.5            fs_1.6.1              </span></span>
<span><span class="co">#&gt;  [87] tidygraph_1.2.3        purrr_1.0.1           </span></span>
<span><span class="co">#&gt;  [89] KEGGREST_1.38.0        dendextend_1.16.0     </span></span>
<span><span class="co">#&gt;  [91] nlme_3.1-161           mime_0.12             </span></span>
<span><span class="co">#&gt;  [93] slam_0.1-50            aplot_0.1.9           </span></span>
<span><span class="co">#&gt;  [95] xml2_1.3.3             compiler_4.2.2        </span></span>
<span><span class="co">#&gt;  [97] rstudioapi_0.14        png_0.1-8             </span></span>
<span><span class="co">#&gt;  [99] treeio_1.22.0          tibble_3.1.8          </span></span>
<span><span class="co">#&gt; [101] tweenr_2.0.2           bslib_0.4.2           </span></span>
<span><span class="co">#&gt; [103] stringi_1.7.12         cyjShiny_1.0.34       </span></span>
<span><span class="co">#&gt; [105] lattice_0.20-45        Matrix_1.5-3          </span></span>
<span><span class="co">#&gt; [107] vctrs_0.5.2            pillar_1.8.1          </span></span>
<span><span class="co">#&gt; [109] lifecycle_1.0.3        jquerylib_0.1.4       </span></span>
<span><span class="co">#&gt; [111] GlobalOptions_0.1.2    data.table_1.14.8     </span></span>
<span><span class="co">#&gt; [113] cowplot_1.1.1          bitops_1.0-7          </span></span>
<span><span class="co">#&gt; [115] httpuv_1.6.9           patchwork_1.1.2       </span></span>
<span><span class="co">#&gt; [117] qvalue_2.30.0          R6_2.5.1              </span></span>
<span><span class="co">#&gt; [119] bookdown_0.33          promises_1.2.0.1      </span></span>
<span><span class="co">#&gt; [121] gridExtra_2.3          codetools_0.2-18      </span></span>
<span><span class="co">#&gt; [123] MASS_7.3-58.1          rjson_0.2.21          </span></span>
<span><span class="co">#&gt; [125] withr_2.5.0            GenomeInfoDbData_1.2.9</span></span>
<span><span class="co">#&gt; [127] parallel_4.2.2         grid_4.2.2            </span></span>
<span><span class="co">#&gt; [129] ggfun_0.0.9            tidyr_1.3.0           </span></span>
<span><span class="co">#&gt; [131] HDO.db_0.99.1          rmarkdown_2.20        </span></span>
<span><span class="co">#&gt; [133] downlit_0.4.2          NLP_0.2-1             </span></span>
<span><span class="co">#&gt; [135] shiny_1.7.4            base64enc_0.1-3</span></span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="pathview-text.html"><span class="header-section-number">9</span> Pathview text</a></div>
<div class="next"><a href="single-cell-transcriptomic-data.html"><span class="header-section-number">11</span> Single-cell transcriptomic data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#application-examples"><span class="header-section-number">10</span> Application examples</a></li>
<li><a class="nav-link" href="#load-the-necessary-packages-and-genes"><span class="header-section-number">10.1</span> Load the necessary packages and genes</a></li>
<li><a class="nav-link" href="#enrichment-analysis"><span class="header-section-number">10.2</span> Enrichment analysis</a></li>
<li><a class="nav-link" href="#text-mining-the-gene-summaries"><span class="header-section-number">10.3</span> Text mining the gene summaries</a></li>
<li><a class="nav-link" href="#text-mining-the-available-literature"><span class="header-section-number">10.4</span> Text mining the available literature</a></li>
<li><a class="nav-link" href="#combine-and-compare-networks"><span class="header-section-number">10.5</span> Combine and compare networks</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>wcGeneSummary (OSplot)</strong>" was written by Noriaki Sato. It was last built on 2023-03-30.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
