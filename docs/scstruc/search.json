[{"path":"index.html","id":"introduction","chapter":"1 Introduction","heading":"1 Introduction","text":"scstruc package designed estimate gene regulatory networks (GRNs) single-cell transcriptomics (SCT) data using Bayesian networks (BN). Notably, package focuses following points:Implementation algorithms tailored SCT data characteristics, dropouts (zero-inflation).Evaluating inferred networks based causal validity.Probabilistic reasoning extraction differences regulatory relationships groupsComprehensive visualization understanding resulting GRNs.BN estimate directed relationships genes useful GRN inference. package also supports DAG estimation popular GRN inference software tools, significantly expanding applicability GRNs SCT data analysis.","code":""},{"path":"index.html","id":"installation-and-prerequiresties","chapter":"1 Introduction","heading":"1.1 Installation and prerequiresties","text":"need packages needs installed using full functions scstruc.CCDr algorithm following repository:HurdleNormal package following repository:CCDr algorithm HurdleNormal package, please consult original papers (McDavid et al. 2019; Aragam Zhou 2015).","code":"\ndevtools::install_github(\"noriakis/scstruc\")\ndevtools::install_github(\"itsrainingdata/sparsebnUtils\")\ndevtools::install_github(\"noriakis/ccdrAlgorithm\")\ndevtools::install_github(\"amcdavid/HurdleNormal\")"},{"path":"basic-usage-of-scstruc.html","id":"basic-usage-of-scstruc","chapter":"2 Basic usage of scstruc","heading":"2 Basic usage of scstruc","text":"part present use package inference network evaluation. Basically, object storing (normalized) expression matrix, primary function scstruc can perform inference. use mock data generated scran::mockSCE function .obtain simulated data mockSCE function scuttle, log-normalize count default parameter.","code":"\nlibrary(scran)\nlibrary(scstruc)\nlibrary(ggraph)\nlibrary(bnlearn)\nlibrary(tibble)\nset.seed(0)\nsce <- mockSCE()\nsce <- logNormCounts(sce)\nsce\n#> class: SingleCellExperiment \n#> dim: 2000 200 \n#> metadata(0):\n#> assays(2): counts logcounts\n#> rownames(2000): Gene_0001 Gene_0002 ... Gene_1999\n#>   Gene_2000\n#> rowData names(0):\n#> colnames(200): Cell_001 Cell_002 ... Cell_199\n#>   Cell_200\n#> colData names(4): Mutation_Status Cell_Cycle\n#>   Treatment sizeFactor\n#> reducedDimNames(0):\n#> mainExpName: NULL\n#> altExpNames(1): Spikes"},{"path":"basic-usage-of-scstruc.html","id":"bayesian-network","chapter":"2 Basic usage of scstruc","heading":"2.1 Bayesian network","text":"Bayesian networks probabilistic graphical models represent set random variables \\(X = \\{X_1, \\dots, X_N\\}\\), conditional dependencies using directed acyclic graph (DAG). widely used various domains, economics, medicine, decision-making, modeling complex relationships among variables transcriptomics data. package, infer relationships among genes, representing transcriptional regulation .graphical separation nodes G implies conditional independence corresponding variables leads factorization:\\[\nP(X \\mid G; \\theta) = \\prod_{=1}^{N} P(X_i \\mid \\pi_{X_i}; \\theta_{X_i}) \\quad \\text{} \\pi_{X_i} = \\{ \\text{parents } X_i \\text{ } G \\}\n\\]package, various algorithms implemented tailored account nature SCT data, dropouts.","code":""},{"path":"basic-usage-of-scstruc.html","id":"preprocessing-of-single-cell-transcriptomics-data-and-preparation","chapter":"2 Basic usage of scstruc","heading":"2.2 Preprocessing of single-cell transcriptomics data and preparation","text":"reduce computational burden obtain interpretable results, preprocessing steps preparation suggested.","code":""},{"path":"basic-usage-of-scstruc.html","id":"coarse-graining-expression-data-metacell-expression","chapter":"2 Basic usage of scstruc","heading":"2.2.1 Coarse-graining expression data (metacell expression)","text":"package can use metacell approach reduce computational burden required perform structure learning SCT data. package features superCellMat function using SuperCell package available CRAN. employs cell aggregation approach reduce dataset complexity preserving key biological variabilityã€€(Bilous et al. 2022). step optional one can use untransformed data directly.matrix (p x n, unlike functions package) can supplied function well.","code":"\nlibrary(SuperCell)\ndim(sce)\n#> [1] 2000  200\nrowData(sce)[\"ID\"] <- row.names(sce)\nsce <- superCellMat(sce, ID=\"ID\")\n#>   SuperCell dimension: 2000 20\ndim(sce)\n#> [1] 2000   20\neco <- readRDS(\"../ecoli70.rds\")\nrawmat <- rbn(eco, 1000)\ncgmat <- superCellMat(t(rawmat), pca=FALSE)\n#>   SuperCell dimension: 46 100\ndim(cgmat)\n#> [1]  46 100"},{"path":"basic-usage-of-scstruc.html","id":"obtaining-interesting-gene-identifiers","chapter":"2 Basic usage of scstruc","heading":"2.2.2 Obtaining interesting gene identifiers","text":"inference, first subset genes interesting biological pathway (ECM receptor interaction cells annotated vascular endothelial cells). purpose, two functions prepared. One fetching gene identifiers Gene Ontology, another KEGG PATHWAY.","code":""},{"path":"basic-usage-of-scstruc.html","id":"getgogenes","chapter":"2 Basic usage of scstruc","heading":"2.2.2.1 getGOGenes","text":"can obtain genes involved gene ontology using identifier.","code":"\nlibrary(scstruc)\nlibrary(org.Mm.eg.db)\ngenes <- getGOGenes(\"GO:0030198\", orgDb=org.Mm.eg.db)\ngenes[1:5]\n#> [1] \"Abl1\"    \"Abl1\"    \"Abl2\"    \"Adamts1\" \"Adamts1\""},{"path":"basic-usage-of-scstruc.html","id":"getkeggpathwaygenes","chapter":"2 Basic usage of scstruc","heading":"2.2.2.2 getKEGGPathwayGenes","text":"can obtain genes involved KEGG PATHWAY using KEGG identifier organism identifier. obtaining genes involved mTOR signaling pathway Mus musculus. need specify organism database order correcrly convert obtained identifiers.can pass genes inference scstruc function. Also, published package estimates GRNs omics data based enrichment analysis results past, approach useful (Sato et al. 2022).","code":"\nlibrary(KEGGREST)\ngenes <- getKEGGPathwayGenes(\"mmu04150\", orgDb=org.Mm.eg.db)\ngenes[1:5]\n#> [1] \"Prkaa1\"  \"Prkaa2\"  \"Atp6v1h\" \"Prr5\"    \"Braf\""},{"path":"basic-usage-of-scstruc.html","id":"actual-structure-learning","chapter":"2 Basic usage of scstruc","heading":"2.3 Actual structure learning","text":"scstruc function needs SingleCellExperiment object storing gene expression data. Also, gene list must specified. analysis, randomly subset gene identifiers used input. changeSymbol argument refers changing gene names subset matrix specified symbolColumn argument (default Symbol). example, corresponding symbol argument set FALSE. Also, algorithm set mmhc default, performs max-min hill climbing approach.default, returns bn object bnlearn actual data used inference. returnBn set FALSE, function returns tidygraph object. can used various downstream tasks, visualization, probabilistic reasoning, evaluation based biological pathway information. details including use various algorithms learning described following sections.","code":"\nincluded_genes <- sample(row.names(sce), 100)\ngs <- scstruc(sce, included_genes, changeSymbol=FALSE)\nnames(gs)\n#> [1] \"net\"  \"data\"\ngs$net\n#> \n#>   Bayesian network learned via Hybrid methods\n#> \n#>   model:\n#>    [Gene_0018][Gene_0021][Gene_0037][Gene_0047][Gene_0074]\n#>    [Gene_0090][Gene_0092][Gene_0110][Gene_0124][Gene_0145]\n#>    [Gene_0176][Gene_0232][Gene_0244][Gene_0249][Gene_0253]\n#>    [Gene_0267][Gene_0346][Gene_0432][Gene_0453][Gene_0468]\n#>    [Gene_0471][Gene_0512][Gene_0537][Gene_0543][Gene_0544]\n#>    [Gene_0554][Gene_0574][Gene_0617][Gene_0647][Gene_0725]\n#>    [Gene_0900][Gene_0946][Gene_1002][Gene_1095][Gene_1400]\n#>    [Gene_1401][Gene_1428][Gene_1473][Gene_1614][Gene_1673]\n#>    [Gene_1738][Gene_1770][Gene_1803][Gene_1807][Gene_1815]\n#>    [Gene_1860][Gene_1923][Gene_1972][Gene_0324|Gene_0018]\n#>    [Gene_0356|Gene_0092][Gene_0458|Gene_0176]\n#>    [Gene_0621|Gene_0512][Gene_0817|Gene_0647]\n#>    [Gene_0867|Gene_0725][Gene_0908|Gene_0037]\n#>    [Gene_0940|Gene_0617][Gene_0978|Gene_0554]\n#>    [Gene_1027|Gene_0074][Gene_1031|Gene_0471]\n#>    [Gene_1070|Gene_0468:Gene_0544:Gene_1400]\n#>    [Gene_1087|Gene_0090][Gene_1101|Gene_0725]\n#>    [Gene_1170|Gene_0047][Gene_1244|Gene_0253]\n#>    [Gene_1347|Gene_0267][Gene_1365|Gene_0110]\n#>    [Gene_1379|Gene_0512][Gene_1541|Gene_0453]\n#>    [Gene_1544|Gene_1401][Gene_1594|Gene_0574]\n#>    [Gene_1604|Gene_0018][Gene_1634|Gene_0453]\n#>    [Gene_1757|Gene_1095][Gene_1784|Gene_0074]\n#>    [Gene_1788|Gene_0543][Gene_1849|Gene_0090]\n#>    [Gene_1878|Gene_0574][Gene_1887|Gene_0544]\n#>    [Gene_1890|Gene_1473][Gene_1956|Gene_0176]\n#>    [Gene_0056|Gene_1788][Gene_0396|Gene_0940:Gene_1770]\n#>    [Gene_0455|Gene_1170:Gene_1972]\n#>    [Gene_0741|Gene_0232:Gene_1604][Gene_0879|Gene_1878]\n#>    [Gene_0920|Gene_1849][Gene_0955|Gene_1031]\n#>    [Gene_1034|Gene_1544][Gene_1414|Gene_0249:Gene_1379]\n#>    [Gene_1436|Gene_1347][Gene_1443|Gene_0021:Gene_0978]\n#>    [Gene_1668|Gene_1594][Gene_1689|Gene_1101]\n#>    [Gene_1822|Gene_0458][Gene_0076|Gene_1034]\n#>    [Gene_0311|Gene_0879:Gene_1087][Gene_0363|Gene_1668]\n#>    [Gene_1496|Gene_0455][Gene_1591|Gene_0920]\n#>    [Gene_0051|Gene_0076:Gene_1860]\n#>   nodes:                                 100 \n#>   arcs:                                  61 \n#>     undirected arcs:                     0 \n#>     directed arcs:                       61 \n#>   average markov blanket size:           1.42 \n#>   average neighbourhood size:            1.22 \n#>   average branching factor:              0.61 \n#> \n#>   learning algorithm:                    \n#>                                         Max-Min Hill-Climbing \n#>   constraint-based method:               \n#>                                       Max-Min Parent Children \n#>   conditional independence test:         \n#>                                         Pearson's Correlation \n#>   score-based method:                    Hill-Climbing \n#>   score:                                 BIC (Gauss.) \n#>   alpha threshold:                       0.05 \n#>   penalization coefficient:              1.497866 \n#>   tests used in the learning procedure:  21744 \n#>   optimized:                             TRUE"},{"path":"penalized-regressions.html","id":"penalized-regressions","chapter":"3 Penalized regressions","heading":"3 Penalized regressions","text":"Penalized regression type regression analysis includes penalty term prevent overfitting improve generalizability model. particularly useful dealing high-dimensional data number predictors large compared number observations. terms inference GRN BN structure learning, penalized regression used successfully (Schmidt, Niculescu-Mizil, Murphy 2007). package implments core algorithms use penalization BN structure learning described .","code":""},{"path":"penalized-regressions.html","id":"algorithms","chapter":"3 Penalized regressions","heading":"3.1 Algorithms","text":"","code":""},{"path":"penalized-regressions.html","id":"glmnet_bic-and-glmnet_cv","chapter":"3 Penalized regressions","heading":"3.1.1 glmnet_BIC and glmnet_CV","text":"L1 regularization (LASSO), package uses popular R library glmnet. glmnet_BIC specified argument algo select lambda minimum BIC criteria, glmnet_CV choose lambda based cross validation specified fold numbers. glmnetBICpath returns BIC path given data.frame node name modeled. plot contains BIC path plot, fit contains fitted object BIC lambda BIC data.frame. maximize function can chosen maximize argument algorithm.args list. Greedy Equivalence Search can performed via setting argument ges.","code":"\nlibrary(scran)\nlibrary(scstruc)\nlibrary(bnlearn)\n\nsce <- mockSCE()\nsce <- logNormCounts(sce)\nincluded_genes <- sample(row.names(sce), 30)\n\n## Inference based on glmnet_CV and maximization by GES\ngs <- scstruc(sce, included_genes,\n    algorithm=\"glmnet_CV\",\n    algorithm.args=list(\"maximize\"=\"ges\"),\n    changeSymbol=FALSE)\ngs$net\n#> \n#>   Random/Generated Bayesian network\n#> \n#>   model:\n#>    [Gene_0023][Gene_0145][Gene_0156][Gene_0425][Gene_0544]\n#>    [Gene_0725][Gene_0814][Gene_0993][Gene_1085][Gene_1214]\n#>    [Gene_1267][Gene_1292][Gene_1330][Gene_1332][Gene_1375]\n#>    [Gene_1569][Gene_1683][Gene_1700][Gene_1744][Gene_1922]\n#>    [Gene_2000][Gene_0348|Gene_1085:Gene_1700]\n#>    [Gene_0863|Gene_0425][Gene_1091|Gene_0814]\n#>    [Gene_1520|Gene_0425][Gene_0118|Gene_0348]\n#>    [Gene_0887|Gene_0348][Gene_1921|Gene_0863:Gene_1700]\n#>    [Gene_0986|Gene_0887][Gene_1541|Gene_1921:Gene_2000]\n#>   nodes:                                 30 \n#>   arcs:                                  12 \n#>     undirected arcs:                     0 \n#>     directed arcs:                       12 \n#>   average markov blanket size:           1.00 \n#>   average neighbourhood size:            0.80 \n#>   average branching factor:              0.40 \n#> \n#>   generation algorithm:                  Empty\n\n## Visualization of glmnet_BIC criteria\n## Just to obtain data to be used in the inference\ngs <- scstruc(sce, included_genes,\n    changeSymbol=FALSE, returnData=TRUE)\n\nset.seed(10)\nglmnetBICpath(gs$data, sample(colnames(gs$data), 1))[[\"plot\"]]"},{"path":"penalized-regressions.html","id":"mcp_cv-and-scad_cv","chapter":"3 Penalized regressions","heading":"3.1.2 MCP_CV and SCAD_CV","text":"glmnet_CV, library performs penalized regression baed MCP SCAD using ncvreg library.","code":"\nlibrary(ncvreg)\n\nmcp.net <- scstruc(sce, included_genes,\n    algorithm=\"MCP_CV\", returnData=FALSE,\n    changeSymbol=FALSE)\n\nscad.net <- scstruc(sce, included_genes,\n    algorithm=\"SCAD_CV\", returnData=FALSE,\n    changeSymbol=FALSE)\n\n## Using the bnlearn function to compare two networks\nbnlearn::compare(mcp.net, scad.net)\n#> $tp\n#> [1] 6\n#> \n#> $fp\n#> [1] 4\n#> \n#> $fn\n#> [1] 0"},{"path":"penalized-regressions.html","id":"l0-regularized-regression","chapter":"3 Penalized regressions","heading":"3.1.3 L0-regularized regression","text":"Based L0Learn, package performs structure learning based L0-regularized regression. L0 regularization, also known best subset selection, technique used build simpler interpretable models selecting small number important variables. L0L1 L0L2 regularization combination L0, L1, L2 regularization. details L0-, L0L1-, L0L2-regularized regression, please consult original paper (Hazimeh, Mazumder, Nonet 2023).","code":"\nl0l2.net <- scstruc(sce, included_genes,\n    algorithm=\"L0L2_CV\", returnData=FALSE,\n    changeSymbol=FALSE)\nplotNet(l0l2.net)"},{"path":"penalized-regressions.html","id":"ccdr-algorithm","chapter":"3 Penalized regressions","heading":"3.1.4 CCDr algorithm","text":"Generally, CCDr algorithm fastest algorithm learns network multiple lambdas. default, function chooses network best BIC value among multiple lambdas. supress effect obtain networks, set bestScore FALSE algorithm.args.Therefore, bootstrap-based inference can performed fast using CCDr algorithm. bootstrapping specified, function performs learning bootstrapped network multiple lambdas across replicates.","code":"\nlibrary(ccdrAlgorithm);library(sparsebnUtils)\nccdr.res <- scstruc(sce, included_genes,\n    algorithm=\"ccdr\", changeSymbol=FALSE,\n    algorithm.args=list(bestScore=FALSE))\n#> Setting `lambdas.length` to 10\n#> Returning the bn per lambda from result of ccdr.run\nnames(ccdr.res$net)\n#> [1] \"14.1421356237309\"  \"8.47798757230114\" \n#> [3] \"5.08242002399425\"  \"3.04683075789017\" \n#> [5] \"1.82652705274248\"  \"1.09497420090059\" \n#> [7] \"0.656419787945471\" \"0.393513324471009\"\nccdr.res$net[[4]]\n#> \n#>   Random/Generated Bayesian network\n#> \n#>   model:\n#>    [Gene_0023][Gene_0118][Gene_0145][Gene_0156][Gene_0425]\n#>    [Gene_0544][Gene_0725][Gene_0814][Gene_0887][Gene_0986]\n#>    [Gene_0993][Gene_1085][Gene_1091][Gene_1214][Gene_1267]\n#>    [Gene_1292][Gene_1330][Gene_1332][Gene_1375][Gene_1520]\n#>    [Gene_1541][Gene_1569][Gene_1683][Gene_1700][Gene_1744]\n#>    [Gene_1921][Gene_1922][Gene_2000][Gene_0348|Gene_0118]\n#>    [Gene_0863|Gene_0425]\n#>   nodes:                                 30 \n#>   arcs:                                  2 \n#>     undirected arcs:                     0 \n#>     directed arcs:                       2 \n#>   average markov blanket size:           0.13 \n#>   average neighbourhood size:            0.13 \n#>   average branching factor:              0.067 \n#> \n#>   generation algorithm:                  Empty"},{"path":"penalized-regressions.html","id":"precision-lasso","chapter":"3 Penalized regressions","heading":"3.1.5 Precision lasso","text":"Precision Lasso combines LASSO precision matrix regularization process. approach particularly useful biological genomics studies, highly-correlated features often appear. implmented precision lasso R feature provided plasso.fit plasso.fit.single using RcppArmadillo. fixed lambda value specified.","code":"\npl.res <- scstruc(sce, included_genes, algorithm=\"plasso\", changeSymbol=FALSE)"},{"path":"hurdle-model.html","id":"hurdle-model","chapter":"4 Hurdle model","heading":"4 Hurdle model","text":"handling zero-inflated nature single-cell transcriptomics data, use hurdle model presented. hurdle model two-part model models whether observation zero , non-zero part separately. function, Hurdle algorithm specified algorithm argument scstruc.Based inferred network HurdleNormal, proposed multivariate Hurdle model grouped lasso learn undirected network (McDavid et al. 2019), directed acyclic graph inferred based score maximization using constraints. default, score BIC bnlearn. customized score also introduced section. first undirected network selected multiple lambdas based BIC criteria implemented HurdleNormal.score maximization function can set arbitrarily (maximizeFun), set hc default. Greedy Equivalence Search can performed via setting maximize argument ges.","code":"\nlibrary(HurdleNormal)\nlibrary(scstruc)\n\nsce <- mockSCE()\nsce <- logNormCounts(sce)\nincluded_genes <- sample(row.names(sce), 20)\ngs <- scstruc(sce, included_genes,\n    changeSymbol=FALSE, algorithm=\"Hurdle\")\ngs$net\n#> \n#>   Bayesian network learned via Score-based methods\n#> \n#>   model:\n#>    [Gene_0182][Gene_0419][Gene_0475][Gene_0708][Gene_0742]\n#>    [Gene_0780][Gene_0795][Gene_0848][Gene_0921][Gene_0940]\n#>    [Gene_1003][Gene_1110][Gene_1194][Gene_1291][Gene_1555]\n#>    [Gene_1557][Gene_1609][Gene_1663][Gene_1808][Gene_1844]\n#>   nodes:                                 20 \n#>   arcs:                                  0 \n#>     undirected arcs:                     0 \n#>     directed arcs:                       0 \n#>   average markov blanket size:           0.00 \n#>   average neighbourhood size:            0.00 \n#>   average branching factor:              0.00 \n#> \n#>   learning algorithm:                    Hill-Climbing \n#>   score:                                 BIC (Gauss.) \n#>   penalization coefficient:              2.649159 \n#>   tests used in the learning procedure:  0 \n#>   optimized:                             TRUE\ngs.tabu <- scstruc(sce, included_genes,\n    changeSymbol=FALSE, algorithm=\"Hurdle\",\n    algorithm.args=list(maximizeFun=bnlearn::tabu))\ngs.tabu$net\n#> \n#>   Bayesian network learned via Score-based methods\n#> \n#>   model:\n#>    [Gene_0182][Gene_0419][Gene_0475][Gene_0708][Gene_0742]\n#>    [Gene_0780][Gene_0795][Gene_0848][Gene_0921][Gene_0940]\n#>    [Gene_1003][Gene_1110][Gene_1194][Gene_1291][Gene_1555]\n#>    [Gene_1557][Gene_1609][Gene_1663][Gene_1808][Gene_1844]\n#>   nodes:                                 20 \n#>   arcs:                                  0 \n#>     undirected arcs:                     0 \n#>     directed arcs:                       0 \n#>   average markov blanket size:           0.00 \n#>   average neighbourhood size:            0.00 \n#>   average branching factor:              0.00 \n#> \n#>   learning algorithm:                    Tabu Search \n#>   score:                                 BIC (Gauss.) \n#>   penalization coefficient:              2.649159 \n#>   tests used in the learning procedure:  0 \n#>   optimized:                             TRUE\n## This performs GES as score-based learning\ngs.ges <- scstruc(sce, included_genes,\n    changeSymbol=FALSE, algorithm=\"Hurdle\",\n    algorithm.args=list(maximize=\"ges\"))\ngs.ges$net\n#> \n#>   Random/Generated Bayesian network\n#> \n#>   model:\n#>    [Gene_0182][Gene_0419][Gene_0475][Gene_0708][Gene_0742]\n#>    [Gene_0780][Gene_0795][Gene_0848][Gene_0921][Gene_0940]\n#>    [Gene_1003][Gene_1110][Gene_1194][Gene_1291][Gene_1555]\n#>    [Gene_1557][Gene_1609][Gene_1663][Gene_1808][Gene_1844]\n#>   nodes:                                 20 \n#>   arcs:                                  0 \n#>     undirected arcs:                     0 \n#>     directed arcs:                       0 \n#>   average markov blanket size:           0.00 \n#>   average neighbourhood size:            0.00 \n#>   average branching factor:              0.00 \n#> \n#>   generation algorithm:                  Empty"},{"path":"hurdle-model.html","id":"customized-score-for-hurdle-model","chapter":"4 Hurdle model","heading":"4.1 Customized score for hurdle model","text":"Additional score can specified using hurdle.bic function algorithm.args argument. score defined sum BIC values continuous logistic regression part hurdle model. Let \\(Y = [y_{ij}]\\) denote log-normalized expression value gene subset cell j \\(Z = [z_{ij}]\\) 0-1 indicator value whether gene expression zero. score defined :\\[\n\\text{logit}\\left(\\Pr(Z_{ij} = 1)\\right) \\sim \\beta_i G_j,\n\\]\\[\n\\Pr(Y_{ij} = y \\mid Z_{ij} = 1) \\sim N(\\beta_i G_j, \\sigma^2).\n\\]proposed MAST library, cellular detection rate adjustment (CDR) can performed scoring phase cdrAdjuetment TRUE. applies inclusion CDR term hurdle modeling score maximizing phase.","code":"\ngs2 <- scstruc(sce, included_genes,\n    changeSymbol=FALSE, algorithm=\"Hurdle\",\n    algorithm.args=list(\"score\"=hurdle.bic))\ngs2$net\n#> \n#>   Bayesian network learned via Score-based methods\n#> \n#>   model:\n#>    [Gene_0182][Gene_0419][Gene_0475][Gene_0708][Gene_0742]\n#>    [Gene_0780][Gene_0795][Gene_0848][Gene_0921][Gene_0940]\n#>    [Gene_1003][Gene_1110][Gene_1194][Gene_1291][Gene_1555]\n#>    [Gene_1557][Gene_1609][Gene_1663][Gene_1808][Gene_1844]\n#>   nodes:                                 20 \n#>   arcs:                                  0 \n#>     undirected arcs:                     0 \n#>     directed arcs:                       0 \n#>   average markov blanket size:           0.00 \n#>   average neighbourhood size:            0.00 \n#>   average branching factor:              0.00 \n#> \n#>   learning algorithm:                    Hill-Climbing \n#>   score:                                 \n#>                                  User-Provided Score Function \n#>   tests used in the learning procedure:  0 \n#>   optimized:                             TRUE"},{"path":"hurdle-model.html","id":"add.dropout","chapter":"4 Hurdle model","heading":"4.2 add.dropout","text":"Like SCT data simulator, excessive zero matrix can simulated add.dropout. function takes absolute expression values expression matrix negative.","code":"\nnet <- readRDS(\"../arth150.rds\")\nsim <- rbn(net, 100)\ntable(sim == 0)\n#> \n#> FALSE \n#> 10700\nsim.do <- sim * add.dropout(sim)\ntable(sim.do == 0)\n#> \n#> FALSE  TRUE \n#>  4361  6339"},{"path":"other-algorithms-and-software.html","id":"other-algorithms-and-software","chapter":"5 Other algorithms and software","heading":"5 Other algorithms and software","text":"","code":""},{"path":"other-algorithms-and-software.html","id":"bootstrapping","chapter":"5 Other algorithms and software","heading":"5.1 Bootstrapping","text":"obtaining reliable network, can use bootstrapping approach randomly subsampling data, infer network , average bootstrapped networks. algorithms can use bootstrapping specifying boot=TRUE. instance, use bootstrapping CCDr algorithm (fast), example codes shown . Replication number can specified R sampling number can specified m argument. way, bn.strength object returned net.","code":"\nlibrary(scstruc)\n\nsce <- mockSCE()\nsce <- logNormCounts(sce)\nincluded_genes <- sample(row.names(sce), 40)\ngs <- scstruc(sce, included_genes, R=30,\n              changeSymbol=FALSE, algorithm=\"ccdr\", boot=TRUE)\n#> Bootstrapping specified\n#> Returning the list of bn.strength\n\n## It consists of strength from multiple lambdas\nhead(gs$net[[5]])\n#>        from        to strength direction\n#> 1 Gene_0156 Gene_0229        0         0\n#> 2 Gene_0156 Gene_0231        0         0\n#> 3 Gene_0156 Gene_0323        0         0\n#> 4 Gene_0156 Gene_0336        0         0\n#> 5 Gene_0156 Gene_0350        0         0\n#> 6 Gene_0156 Gene_0376        0         0"},{"path":"other-algorithms-and-software.html","id":"pidc","chapter":"5 Other algorithms and software","heading":"5.2 PIDC","text":"PIDC algorithm based information theory leverages partial information decomposition (PID) analyze quantify relationships multiple variables (Chan, Stumpf, Babtie 2017). scstruc uses undirected network produced PIDC, implemented Julia. JuliaCall used call Julia R, users first set Julia environment. Also, path main library (NetworkInference.jl) specified NetworkInference_HOME argument. directed acyclic graph obtained based score maximization constraints produced PIDC. example code shown follows:bootstrapped-based inference can also performed. case, averaged network obtained per thresholds parameters algorithm.args. default, network thresholded seq(0.1, 0.4, 0.1).maximization can chosen scoring function available bnlearn Greedy Equivalence Search (ges), can specified parameter maximize algorithm.args.Note raw network output scaled thresholded stored temporary directory.","code":"\nlibrary(JuliaCall)\njulia <- julia_setup(JULIA_HOME = \"./Julia-1.10.5/bin\")\ngs <- scstruc(sce, included_genes,\n              changeSymbol=FALSE,\n              algorithm=\"pidc\",\n              algorithm.args=list(NetworkInference_HOME=\"./NetworkInference.jl\"))\ngs$net\ngs <- scstruc(sce, included_genes,\n              changeSymbol=FALSE,\n              algorithm=\"pidc\", boot=TRUE, R=30,\n              algorithm.args=list(NetworkInference_HOME=\"./NetworkInference.jl\"))\ngs$net"},{"path":"other-algorithms-and-software.html","id":"genie3","chapter":"5 Other algorithms and software","heading":"5.3 GENIE3","text":"GENIE3 widely used method inferring directed interactions genes based ensemble regression trees. specifying genie3 algorithm, function performs GENIE3 algorithm subsequently threshold arcs. , function returns list original results networks thresholded network DAG.","code":"\ngs <- scstruc(sce, included_genes,\n              changeSymbol=FALSE,\n              algorithm=\"genie3\")\nhead(gs$net$original)\n#>            Gene_0156  Gene_0229  Gene_0231   Gene_0323\n#> Gene_0156 0.00000000 0.03028585 0.03391460 0.028297127\n#> Gene_0229 0.03485903 0.00000000 0.02685464 0.023199691\n#> Gene_0231 0.02504192 0.02325473 0.00000000 0.018069640\n#> Gene_0323 0.01330440 0.01289305 0.01165647 0.000000000\n#> Gene_0336 0.01387871 0.01000074 0.01248417 0.009755696\n#> Gene_0350 0.03365878 0.02816917 0.03527866 0.024367847\n#>             Gene_0336   Gene_0350   Gene_0376  Gene_0444\n#> Gene_0156 0.070875001 0.035628644 0.034072305 0.03610615\n#> Gene_0229 0.025028168 0.030756747 0.032017148 0.03047891\n#> Gene_0231 0.022989495 0.026319057 0.016737978 0.03054703\n#> Gene_0323 0.009869578 0.013729302 0.021490612 0.01224105\n#> Gene_0336 0.000000000 0.007330711 0.008323914 0.01051796\n#> Gene_0350 0.020088861 0.000000000 0.030250537 0.02957796\n#>             Gene_0487  Gene_0804  Gene_0846  Gene_0856\n#> Gene_0156 0.027183744 0.02686804 0.03104218 0.02501029\n#> Gene_0229 0.033594750 0.02750657 0.02897075 0.04739677\n#> Gene_0231 0.019500411 0.02036525 0.03566455 0.01975604\n#> Gene_0323 0.013909248 0.01418789 0.02271942 0.02982123\n#> Gene_0336 0.007838251 0.01182224 0.01161484 0.01398596\n#> Gene_0350 0.033563407 0.03037086 0.02856881 0.03013948\n#>            Gene_0955  Gene_1024  Gene_1025  Gene_1095\n#> Gene_0156 0.04415820 0.03707054 0.02987893 0.03411332\n#> Gene_0229 0.02551375 0.02526397 0.02492996 0.03685898\n#> Gene_0231 0.01765163 0.05755167 0.02365340 0.02120446\n#> Gene_0323 0.00924323 0.01134262 0.01520570 0.03066596\n#> Gene_0336 0.01456278 0.01820598 0.01109332 0.01147988\n#> Gene_0350 0.03159843 0.03257884 0.02872809 0.03191452\n#>             Gene_1117   Gene_1153  Gene_1186  Gene_1202\n#> Gene_0156 0.033519299 0.023575979 0.03278377 0.04166837\n#> Gene_0229 0.023120704 0.034732414 0.03311580 0.03056318\n#> Gene_0231 0.015526007 0.020404076 0.02300868 0.02740384\n#> Gene_0323 0.008892518 0.012305456 0.01849592 0.01489978\n#> Gene_0336 0.023706508 0.008458542 0.01176431 0.01090599\n#> Gene_0350 0.048786133 0.033617082 0.03125257 0.03529774\n#>             Gene_1257  Gene_1290   Gene_1297   Gene_1321\n#> Gene_0156 0.031691666 0.02550102 0.044217887 0.026045983\n#> Gene_0229 0.029435506 0.02901794 0.032874545 0.029900634\n#> Gene_0231 0.021768284 0.02010626 0.020335334 0.026729682\n#> Gene_0323 0.017240952 0.01289683 0.011303454 0.012148152\n#> Gene_0336 0.009658607 0.02648709 0.008851073 0.008587002\n#> Gene_0350 0.028932234 0.02582708 0.028632917 0.023811084\n#>            Gene_1372  Gene_1457  Gene_1471  Gene_1537\n#> Gene_0156 0.02784701 0.02988726 0.02845569 0.02707732\n#> Gene_0229 0.02780712 0.03744497 0.02609542 0.03712001\n#> Gene_0231 0.02405152 0.01902755 0.02167770 0.02410179\n#> Gene_0323 0.01398449 0.03161001 0.01170533 0.01381456\n#> Gene_0336 0.01299827 0.02251519 0.01067377 0.01350765\n#> Gene_0350 0.02822658 0.02237824 0.03072959 0.02867282\n#>             Gene_1545  Gene_1593  Gene_1670   Gene_1727\n#> Gene_0156 0.033948275 0.02985123 0.02447357 0.041362762\n#> Gene_0229 0.030545531 0.02088252 0.03696399 0.040073972\n#> Gene_0231 0.029501297 0.01641544 0.02041282 0.017931735\n#> Gene_0323 0.011327183 0.01587072 0.01330209 0.011527915\n#> Gene_0336 0.009613473 0.01149877 0.01696952 0.009199474\n#> Gene_0350 0.030764519 0.03571193 0.03207682 0.040063411\n#>            Gene_1849  Gene_1905  Gene_1921  Gene_1938\n#> Gene_0156 0.03306036 0.03233509 0.03281073 0.02866882\n#> Gene_0229 0.03090804 0.02514331 0.03191349 0.03733548\n#> Gene_0231 0.01896607 0.03050193 0.02650402 0.01851383\n#> Gene_0323 0.01234698 0.02280683 0.02842592 0.01311272\n#> Gene_0336 0.02067467 0.01005650 0.02645692 0.01462112\n#> Gene_0350 0.03954748 0.03086294 0.02116200 0.02998779\n#>            Gene_1966   Gene_1981   Gene_1983  Gene_1997\n#> Gene_0156 0.02514435 0.037165455 0.024047831 0.01921417\n#> Gene_0229 0.02649093 0.035184183 0.045474490 0.03456340\n#> Gene_0231 0.01920766 0.020855721 0.022368184 0.01654087\n#> Gene_0323 0.01745645 0.009293087 0.013671040 0.01523694\n#> Gene_0336 0.01356252 0.014113312 0.007202735 0.00902023\n#> Gene_0350 0.02427172 0.031094622 0.029315544 0.03629895"},{"path":"evaluating-the-inferred-networks.html","id":"evaluating-the-inferred-networks","chapter":"6 Evaluating the inferred networks","heading":"6 Evaluating the inferred networks","text":"interpretation results, assessment inferred networks crucial. necessary determine network used downstream analysis, assess closely inferred causal relationships resemble biologically validated networks. One core features scstruc evaluating selecting optimal algorithms inferred networks. describe evaluate inferred networks using various metrics section. implemented metrics include:True positive arcsFalse positive arcsFalse negative arcsPrecisionRecallF1-scoreBayesian Information Criterion (data fitted provided)Structural Hamming DistanceStructural Intervention Distance (without symmetrization)Kullbackâ€“Leibler divergenceAUPRC (bootstrapped network )","code":""},{"path":"evaluating-the-inferred-networks.html","id":"evaluation-functions","chapter":"6 Evaluating the inferred networks","heading":"6.1 Evaluation functions","text":"","code":""},{"path":"evaluating-the-inferred-networks.html","id":"metrics-function","chapter":"6 Evaluating the inferred networks","heading":"6.1.1 metrics function","text":"function accepts learned networks reference network (bn object) outputs data.frame consisting various metrics.sid_sym argument can choose whether symmetrze SID, SID.cran can choose whether use SID implemented CRAN package SID.","code":"\nlibrary(scstruc)\nnet <- readRDS(\"ecoli70.rds\")\ndata.inference <- rbn(net, 50)\ninfer <- hc(data.inference)\nmetrics(bn.net(net), list(\"inferred\"=infer))\n#>       algo referenceNode InferenceNode s0 edges SHD TP FP\n#> 1 inferred            46            46 70    99 107 28 42\n#>   FN TPR Precision    Recall        F1 SID KL BIC\n#> 1 71 0.4       0.4 0.2828283 0.3313609 958 NA  NA"},{"path":"evaluating-the-inferred-networks.html","id":"metricsfromfitted-function","chapter":"6 Evaluating the inferred networks","heading":"6.1.2 metricsFromFitted function","text":"function accepts parameter-fitted network sampling number, well algorithms used inference. Using rbn function bnlearn, logic sampling performed fitted network. , use ECOLI70 network GeneNet R package, sampling 50 observations network. testing algorithms can specifed argument algos. special algorithms, arguments name provided. function return_data return_net argument, returns data used inference inferred networks. default, metrics returned.results can visualized usual way using library like ggplot2. use plotthis library visualizing.","code":"\nmf <- metricsFromFitted(net, 50, algos=c(\"glmnet_CV\", \"glmnet_BIC\", \"L0_CV\"))\n#> glmnet_CV 5.95810103416443\n#> glmnet_BIC 0.471029996871948\n#> L0_CV\n#> 5.5213348865509\n#> MMHC 0.001 0.0360720157623291\n#> MMHC 0.005 0.0354738235473633\n#> MMHC 0.01 0.0376400947570801\n#> MMHC 0.05 0.0452709197998047\n#> Network computing finished\nhead(mf$metrics)\n#>         algo s0 edges        KL       BIC SHD TP FP FN\n#> 1  glmnet_CV 70    68  5.145568 -2347.568  69 31 39 37\n#> 2 glmnet_BIC 70    38 14.594425 -2508.020  55 23 47 15\n#> 3      L0_CV 70    30 64.437907 -2893.720  67 13 57 17\n#> 4 mmhc_0.001 70    26 54.579934 -2797.366  59 15 55 11\n#> 5 mmhc_0.005 70    28 44.462021 -2747.934  60 16 54 12\n#> 6  mmhc_0.01 70    29 43.507040 -2728.172  59 17 53 12\n#>         TPR Precision    Recall        F1 SID PPI\n#> 1 0.4428571 0.4428571 0.4558824 0.4492754  NA  NA\n#> 2 0.3285714 0.3285714 0.6052632 0.4259259  NA  NA\n#> 3 0.1857143 0.1857143 0.4333333 0.2600000  NA  NA\n#> 4 0.2142857 0.2142857 0.5769231 0.3125000  NA  NA\n#> 5 0.2285714 0.2285714 0.5714286 0.3265306  NA  NA\n#> 6 0.2428571 0.2428571 0.5862069 0.3434343  NA  NA\n#>         time   BICnorm  N  p\n#> 1 5.95810103 1.0000000 50 46\n#> 2 0.47103000 0.8938548 50 46\n#> 3 5.52133489 0.6387000 50 46\n#> 4 0.03607202 0.7024417 50 46\n#> 5 0.03547382 0.7351427 50 46\n#> 6 0.03764009 0.7482163 50 46\nlibrary(plotthis)\nlibrary(ggplot2)\nlibrary(ggrepel)\nScatterPlot(mf$metrics, x=\"SHD\", y=\"F1\", color_by=\"algo\", legend.position=\"none\") +\n    geom_text_repel(aes(label=algo), bg.colour=\"white\")"},{"path":"evaluating-the-inferred-networks.html","id":"evaluating-the-causal-validity","chapter":"6 Evaluating the inferred networks","heading":"6.2 Evaluating the causal validity","text":"primary objective package evaluating causal validity inferred networks. Two approach can used, situations reference directed network available . cases, reference networks readily available.","code":""},{"path":"evaluating-the-inferred-networks.html","id":"obtaining-the-directed-acyclic-graphs-dags-for-the-evaluation","chapter":"6 Evaluating the inferred networks","heading":"6.2.1 Obtaining the directed acyclic graphs (DAGs) for the evaluation","text":"interesting biological pathway, one can obtain DAG KEGG PATHWAY. getKEGGEdges function accepts pathway identifier returns DAG, though always succeed. function first parses pathway information using ggkegg, identify largest components evaluated. removeCycle TRUE, function identifies minimum feedback using igraph function remove edges. returns bn object.Suppose interested inferring gene regulatory networks mTOR signaling pathway dataset, first load DAG KEGG API.Using genes candidate pathway, inference performed performance metrics can obtained based reference DAG.","code":"\nlibrary(scstruc)\ndags <- getKEGGEdges(\"mmu04150\", removeCycle=TRUE)\n#> Removing Pik3ca|Mtor\ngraphviz.plot(dags)\nmymet <- metrics(dags, list(\"Algo1\"=net))"},{"path":"evaluating-the-inferred-networks.html","id":"intersection-validation-approach","chapter":"6 Evaluating the inferred networks","heading":"6.2.2 Intersection-Validation approach","text":"case reference networks, can use Insersection-Validation approach, proposed Viinikka et al. (Viinikka, Eggeling, Koivisto 2018) evaluate algorithm optimal terms SHD SID. purpose, interVal function prepared. function accepts input data, multiple algorithms tested, parameters related Intersection-Validation. implemented metrics SHD SID.user provide data algorithms tested,r argument used specify iteration number, ss argument used specify sub-sampling number. leaves message connected node pairs, defined number edges agreement graph, 15. returnA0 option can used return intersection inferred networks first stage. output option can specified output relevant data (data used inference, A0, bn object).","code":"\ntest.data <- head(gaussian.test, 50)\ntest <- interVal(test.data, algos=c(\"hc\",\"mmhc\",\"tabu\"), ss=30)\ntest\n#> $A0\n#> \n#>   Random/Generated Bayesian network\n#> \n#>   model:\n#>    [A][B][C][D][E][G][F|E:G] \n#>   nodes:                                 7 \n#>   arcs:                                  2 \n#>     undirected arcs:                     0 \n#>     directed arcs:                       2 \n#>   average markov blanket size:           0.86 \n#>   average neighbourhood size:            0.57 \n#>   average branching factor:              0.29 \n#> \n#>   generation algorithm:                  Empty \n#> \n#> \n#> $stat\n#> # A tibble: 3 Ã— 4\n#>   AlgoNum SHD.stat SID.stat    en\n#>     <dbl>    <dbl>    <dbl> <dbl>\n#> 1       1      5.2      0     7.2\n#> 2       2      2.7      1.5   2.3\n#> 3       3      5.4      0     7.4\n#> \n#> $raw.stat\n#>     R AlgoNum SHD SID EdgeNumber\n#> 1   1       1   6   0          8\n#> 2   1       2   1   0          3\n#> 3   1       3   6   0          8\n#> 4   2       1   6   0          8\n#> 5   2       2   3   3          2\n#> 6   2       3   6   0          8\n#> 7   3       1   4   0          6\n#> 8   3       2   3   1          2\n#> 9   3       3   5   0          7\n#> 10  4       1   7   0          9\n#> 11  4       2   3   1          2\n#> 12  4       3   7   0          9\n#> 13  5       1   5   0          7\n#> 14  5       2   3   1          2\n#> 15  5       3   5   0          7\n#> 16  6       1   6   0          8\n#> 17  6       2   3   3          2\n#> 18  6       3   6   0          8\n#> 19  7       1   4   0          6\n#> 20  7       2   3   1          3\n#> 21  7       3   5   0          7\n#> 22  8       1   4   0          6\n#> 23  8       2   3   3          2\n#> 24  8       3   4   0          6\n#> 25  9       1   5   0          7\n#> 26  9       2   1   0          3\n#> 27  9       3   5   0          7\n#> 28 10       1   5   0          7\n#> 29 10       2   4   2          2\n#> 30 10       3   5   0          7"},{"path":"evaluating-the-inferred-networks.html","id":"auprc","chapter":"6 Evaluating the inferred networks","heading":"6.3 AUPRC","text":"Although package focuses Bayesian network evaluation, commonly used metrics area precision-recall curve (AUPRC) can calculated. calc.auprc accepts reference bn object bn.strength object obtained bootstrapping, returns AUPRC value. function uses yardstick calculate value. target argument specifies column used weight, useful output software like GENIE3. example uses bootstrapped GES network inference calculates AUPRC.Accompanied prc.plot function also prepared, accepts reference bn object named list strength plots PRC. Note weight (corresponding edge confidence) column shuold named strength function.combining methods, possible determine network suitable assessment.","code":"\nnet <- readRDS(\"ecoli70.rds\")\ndata.inference <- rbn(net, 50)\ninfer <- pcalg.boot(data.inference, R=30)\ncalc.auprc(bn.net(net), infer)\n#> # A tibble: 1 Ã— 3\n#>   .metric .estimator .estimate\n#>   <chr>   <chr>          <dbl>\n#> 1 pr_auc  binary         0.407"},{"path":"evaluating-the-inferred-networks.html","id":"evaluation-based-on-sergio","chapter":"6 Evaluating the inferred networks","heading":"6.4 Evaluation based on SERGIO","text":"","code":""},{"path":"evaluating-the-inferred-networks.html","id":"load-and-plot","chapter":"6 Evaluating the inferred networks","heading":"6.4.1 Load and plot","text":"SERGIO, simulator single-cell gene expression data, models single-cell gene expression data based user-specified GRN. cloning repository, first load GRN dataset. plot loaded network using plotNet.","code":"\nlibrary(scstruc)\nlibrary(dplyr);library(igraph);library(bnlearn)\n\n## De-noised_100G_9T_300cPerT_4_DS1\ngt <- read.csv(\"De-noised_100G_9T_300cPerT_4_DS1/gt_GRN.csv\", header=FALSE)\ngt <- gt %>% `colnames<-`(c(\"from\",\"to\"))\ngt$from <- paste0(\"G\",gt$from)\ngt$to <- paste0(\"G\",gt$to)\ng <- graph_from_data_frame(gt)\n\n### Consider the GRN as DAG\nis_dag(g)\n#> [1] TRUE\nref.bn.ds1 <- bnlearn::as.bn(g)\nds1 <- plotNet(ref.bn.ds1, showText=FALSE)\n\n## De-noised_400G_9T_300cPerT_5_DS2\ngt <- read.csv(\"De-noised_400G_9T_300cPerT_5_DS2/gt_GRN.csv\", header=FALSE)\ngt <- gt %>% `colnames<-`(c(\"from\",\"to\"))\ngt$from <- paste0(\"G\",gt$from)\ngt$to <- paste0(\"G\",gt$to)\ng <- graph_from_data_frame(gt)\n\n### Consider the GRN as DAG\nis_dag(g)\n#> [1] TRUE\nref.bn.ds2 <- bnlearn::as.bn(g)\nds2 <- plotNet(ref.bn.ds2, showText=FALSE)\n\nlibrary(patchwork)\nds1 + ds2"},{"path":"evaluating-the-inferred-networks.html","id":"inference-and-evaluation","chapter":"6 Evaluating the inferred networks","heading":"6.4.2 Inference and evaluation","text":"Load expression data, bootstrapped network obtained using GES algorithm. expression coarse-grained beforehand. performance metrics calculated based functions scstruc.","code":"\n## DS1\ndf <- read.csv(\"De-noised_100G_9T_300cPerT_4_DS1/simulated_noNoise_0.csv\", row.names=1)\ndim(df)\n#> [1]  100 2700\nrow.names(df) <- paste0(\"G\",row.names(df))\ndf <- scstruc::superCellMat(as.matrix(df), pca=FALSE)\n#>   SuperCell dimension: 100 270\ninput <- data.frame(t(as.matrix(df)))\nges.res <- pcalg.boot(input, R=25)\n\ncalc.auprc(ref.bn.ds1, ges.res)\n#> # A tibble: 1 Ã— 3\n#>   .metric .estimator .estimate\n#>   <chr>   <chr>          <dbl>\n#> 1 pr_auc  binary        0.0728\nprc.plot(ref.bn.ds1, list(\"GES\"=ges.res))+\n    cowplot::theme_cowplot()"},{"path":"evaluating-the-inferred-networks.html","id":"adding-dropout-to-gbn","chapter":"6 Evaluating the inferred networks","heading":"6.5 Adding dropout to GBN","text":"another method reproduce dropout non-SCT data, add.dropout function provided. example, function applied data sampled Gaussian Bayesian network, estimation accuracy compared using inference methods.","code":"\nnet <- readRDS(\"ecoli70.rds\")\n\ndat <- rbn(net, 100)\ndat2 <- dat * add.dropout(dat, q=0.2)\n\nraw <- pcalg.boot(dat, R=25)\nraw.2 <- pcalg.boot(dat2, R=25)\n\nprc.plot(bn.net(net),\n    list(\"Raw\"=raw, \"DO\"=raw.2))+\n    cowplot::theme_cowplot()"},{"path":"fitting-and-comparing-the-parameters.html","id":"fitting-and-comparing-the-parameters","chapter":"7 Fitting and comparing the parameters","heading":"7 Fitting and comparing the parameters","text":"","code":""},{"path":"fitting-and-comparing-the-parameters.html","id":"strucvalues-function","chapter":"7 Fitting and comparing the parameters","heading":"7.1 strucValues function","text":"selecting network, can fit parameters arcs obtained networks. analysis, strucValues function prepared. function enables comparison networks groups identifying regulatory relationships arcs cell group SCT data. function accepts network (bn tbl_graph) SingleCellExperiment data. labels specified interesting grouping.returns fitted parameters edge specified group.","code":"\nset.seed(1)\nlibrary(scstruc)\nsce <- mockSCE()\nsce <- logNormCounts(sce)\nincluded_genes <- sample(row.names(sce), 20)\ngs <- scstruc(sce, included_genes, changeSymbol=FALSE)\n\nsv <- strucValues(sce, labels=c(\"Treatment\"), bn = gs$net)\n#> Coefficient calculation per specified group: Treatment\nhead(sv)\n#>        from        to coefficient Treatment\n#> 1 Gene_0556 Gene_0816   0.3136802    treat1\n#> 2 Gene_0017 Gene_0909   0.1301085    treat1\n#> 3 Gene_0556 Gene_1647   0.2261649    treat1\n#> 4 Gene_0695 Gene_1794  -0.2075066    treat1\n#> 5 Gene_0017 Gene_1806  -0.2137052    treat1\n#> 6 Gene_1827 Gene_1806   0.2607372    treat1"},{"path":"fitting-and-comparing-the-parameters.html","id":"plotsubnet","chapter":"7 Fitting and comparing the parameters","heading":"7.2 plotSubNet","text":"plotSubNet plots network centered interesting genes based returned data.frame strucValues. plots separated specified label.","code":"\nlibrary(ggraph)\nplotSubNet(sv, sv$from[4], label = \"Treatment\")"},{"path":"fitting-and-comparing-the-parameters.html","id":"markercoefs-function","chapter":"7 Fitting and comparing the parameters","heading":"7.3 markerCoefs function","text":"marker arcs distinguishing groups can identified markerCoefs function. function accepts returned data.frame strucValues.cell_column cell_label used subset results based cell labels (.e.Â obtained cell clustering annotation). classif_label used specify group interest. sample_column specified additionally sample identifier information group interest.function default uses Boruta algorithm identifying candidate arcs.\nxgboost argument TRUE, classification performed R package xgboost.\nanalyses using algorithms, return_mat option allows output matrix actually used classification.","code":"\nmarks <- markerCoefs(sv, classif_label =  \"Treatment\", cell_column = NULL, sample_column = \"Treatment\")\n#> Performing Boruta algorithm ...\nmarks\n#> [[1]]\n#> Boruta performed 10 iterations in 0.3576541 secs.\n#>  No attributes deemed important.\n#>  7 attributes confirmed unimportant:\n#> Gene_0017->Gene_0909, Gene_0017->Gene_1806,\n#> Gene_0556->Gene_0816, Gene_0556->Gene_1647,\n#> Gene_0695->Gene_1794 and 2 more;\n#> \n#> [[2]]\n#> character(0)"},{"path":"plot.html","id":"plot","chapter":"8 Plotting functions","heading":"8 Plotting functions","text":"library various functions visualizing inferred networks highlighting important regulatory relationships comparing inferred networks multiple algorithms, using ggraph, tidygraph ggfx. can useful diagnosis publication figure. Mostly, function accepts bn object bnlearn.","code":""},{"path":"plot.html","id":"plotnet","chapter":"8 Plotting functions","heading":"8.1 plotNet","text":"plotNet function accepts bn object.Optionally, data can passed fit parameters function colors edge using fitted parameters. nodes sized degrees. degreeMode argument can specified degree calculated. default, mode=\"\" specified.","code":"\nlibrary(scstruc)\nsce <- mockSCE()\nsce <- logNormCounts(sce)\nincluded_genes <- sample(row.names(sce), 50)\ngs <- scstruc(sce, included_genes, changeSymbol=FALSE,\n    algorithm=\"glmnet_BIC\", returnData=TRUE)\n\n## Vanilla plot\nplotNet(gs$net)"},{"path":"plot.html","id":"plotavn","chapter":"8 Plotting functions","heading":"8.2 plotAVN","text":"function intended specifically visualizing bootstrapped networks. can pass results functions returning bn.strength object, function. threshold automatically determined specified. plot, strength shown edge width, direction shown edge color. node sizes determined degree.Edges can highlighted specifying highlightEdges argument, plotNet. plotAVN, with_outer_glow function ggfx package used highlight edges preserve strength direction mapping plot.","code":"\nlibrary(ggraph)\ngs.boot <- scstruc(sce, included_genes, changeSymbol=FALSE, boot=TRUE, R=10,\n             algorithm=\"glmnet_BIC\", returnData=TRUE)\n#> Bootstrapping specified\n\nplotAVN(gs.boot$net)"},{"path":"plot.html","id":"ggraph.compare","chapter":"8 Plotting functions","heading":"8.3 ggraph.compare","text":"Similar graphviz.compare function bnlearn, diagnostic plot can made ggraph.compare. accepts list bn object plot nodes edge associated graphs geom_edge_parallel. agreement edges multiple graphs can understood function, however, get complicated many graphs provided.","code":"\nggraph.compare(list(\"boot\"=averaged.network(gs.boot$net), \"raw\"=gs$net))"},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
