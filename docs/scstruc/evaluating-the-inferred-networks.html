<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Evaluating the inferred networks | scstruc: causal assessment of gene regulatory network using Bayesian network</title>
<meta name="author" content="Noriaki Sato">
<meta name="description" content="For the interpretation of the results, the assessment of inferred networks is crucial. This is because it is necessary to determine which network should be used for downstream analysis, and to...">
<meta name="generator" content="bookdown 0.41 with bs4_book()">
<meta property="og:title" content="Chapter 6 Evaluating the inferred networks | scstruc: causal assessment of gene regulatory network using Bayesian network">
<meta property="og:type" content="book">
<meta property="og:description" content="For the interpretation of the results, the assessment of inferred networks is crucial. This is because it is necessary to determine which network should be used for downstream analysis, and to...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Evaluating the inferred networks | scstruc: causal assessment of gene regulatory network using Bayesian network">
<meta name="twitter:description" content="For the interpretation of the results, the assessment of inferred networks is crucial. This is because it is necessary to determine which network should be used for downstream analysis, and to...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">scstruc: causal assessment of gene regulatory network using Bayesian network</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="basic-usage-of-scstruc.html"><span class="header-section-number">2</span> Basic usage of scstruc</a></li>
<li><a class="" href="penalized-regressions.html"><span class="header-section-number">3</span> Penalized regressions</a></li>
<li><a class="" href="hurdle-model.html"><span class="header-section-number">4</span> Hurdle model</a></li>
<li><a class="" href="other-algorithms-and-software.html"><span class="header-section-number">5</span> Other algorithms and software</a></li>
<li><a class="active" href="evaluating-the-inferred-networks.html"><span class="header-section-number">6</span> Evaluating the inferred networks</a></li>
<li><a class="" href="fitting-and-comparing-the-parameters.html"><span class="header-section-number">7</span> Fitting and comparing the parameters</a></li>
<li><a class="" href="plot.html"><span class="header-section-number">8</span> Plotting functions</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="evaluating-the-inferred-networks" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Evaluating the inferred networks<a class="anchor" aria-label="anchor" href="#evaluating-the-inferred-networks"><i class="fas fa-link"></i></a>
</h1>
<p>For the interpretation of the results, the assessment of inferred networks is crucial. This is because it is necessary to determine which network should be used for downstream analysis, and to assess how closely the inferred causal relationships resemble those of biologically validated networks. One of the core features of the <code>scstruc</code> is evaluating and selecting optimal algorithms from the inferred networks. We describe how to evaluate the inferred networks using various metrics in this section. The implemented metrics include:</p>
<ul>
<li>True positive arcs</li>
<li>False positive arcs</li>
<li>False negative arcs</li>
<li>Precision</li>
<li>Recall</li>
<li>F1-score</li>
<li>Bayesian Information Criterion (if the data to be fitted is provided)</li>
<li>Structural Hamming Distance</li>
<li>Structural Intervention Distance (with or without symmetrization)</li>
<li>Kullback–Leibler divergence</li>
<li>AUPRC (for bootstrapped network only)</li>
</ul>
<div id="evaluation-functions" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Evaluation functions<a class="anchor" aria-label="anchor" href="#evaluation-functions"><i class="fas fa-link"></i></a>
</h2>
<div id="metrics-function" class="section level3" number="6.1.1">
<h3>
<span class="header-section-number">6.1.1</span> <code>metrics</code> function<a class="anchor" aria-label="anchor" href="#metrics-function"><i class="fas fa-link"></i></a>
</h3>
<p>This function accepts learned networks and the reference network (both should be <code>bn</code> object) and outputs <code>data.frame</code> consisting of various metrics.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/noriakis/scstruc">scstruc</a></span><span class="op">)</span></span>
<span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"ecoli70.rds"</span><span class="op">)</span></span>
<span><span class="va">data.inference</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/rbn.html">rbn</a></span><span class="op">(</span><span class="va">net</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">infer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/hc.html">hc</a></span><span class="op">(</span><span class="va">data.inference</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/scstruc/man/metrics.html">metrics</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/bn.fit.html">bn.net</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"inferred"</span><span class="op">=</span><span class="va">infer</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       algo referenceNode InferenceNode s0 edges SHD TP FP</span></span>
<span><span class="co">#&gt; 1 inferred            46            46 70   106 112 29 41</span></span>
<span><span class="co">#&gt;   FN       TPR Precision    Recall        F1  SID KL BIC</span></span>
<span><span class="co">#&gt; 1 77 0.4142857 0.4142857 0.2735849 0.3295455 1061 NA  NA</span></span></code></pre></div>
<p><code>sid_sym</code> argument can choose whether to symmetrze the SID, and <code>SID.cran</code> can choose whether to use SID implemented in CRAN package <code>SID</code>.</p>
</div>
<div id="metricsfromfitted-function" class="section level3" number="6.1.2">
<h3>
<span class="header-section-number">6.1.2</span> <code>metricsFromFitted</code> function<a class="anchor" aria-label="anchor" href="#metricsfromfitted-function"><i class="fas fa-link"></i></a>
</h3>
<p>This function accepts parameter-fitted network and sampling number, as well as the algorithms to be used in the inference. Using <code>rbn</code> function in <code>bnlearn</code>, logic sampling is performed from fitted network. Here, we use <code>ECOLI70</code> network from <code>GeneNet</code> R package, sampling 50 observations from the network. The testing algorithms can be specifed by argument <code>algos</code>. For the special algorithms, the arguments with the same name are provided. The function has <code>return_data</code> and <code>return_net</code> argument, which returns the data used in the inference and inferred networks. By default, only the <code>metrics</code> is returned.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scstruc/man/metricsFromFitted.html">metricsFromFitted</a></span><span class="op">(</span><span class="va">net</span>, <span class="fl">50</span>, algos<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"glmnet_CV"</span>, <span class="st">"glmnet_BIC"</span>, <span class="st">"L0_CV"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; glmnet_CV 12.1235988140106</span></span>
<span><span class="co">#&gt; glmnet_BIC 0.902992010116577</span></span>
<span><span class="co">#&gt; L0_CV</span></span>
<span><span class="co">#&gt; 10.8184690475464</span></span>
<span><span class="co">#&gt; MMHC 0.001 0.118052959442139</span></span>
<span><span class="co">#&gt; MMHC 0.005 0.0820488929748535</span></span>
<span><span class="co">#&gt; MMHC 0.01 0.0785148143768311</span></span>
<span><span class="co">#&gt; MMHC 0.05 0.0989677906036377</span></span>
<span><span class="co">#&gt; Network computing finished</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mf</span><span class="op">$</span><span class="va">metrics</span><span class="op">)</span></span>
<span><span class="co">#&gt;         algo s0 edges       KL       BIC SHD TP FP FN</span></span>
<span><span class="co">#&gt; 1  glmnet_CV 70    59 12.58813 -2418.812  77 23 47 36</span></span>
<span><span class="co">#&gt; 2 glmnet_BIC 70    39 16.74091 -2501.538  53 22 48 17</span></span>
<span><span class="co">#&gt; 3      L0_CV 70    30 83.81795 -2993.413  74  8 62 22</span></span>
<span><span class="co">#&gt; 4 mmhc_0.001 70    25 53.17069 -2829.217  59 12 58 13</span></span>
<span><span class="co">#&gt; 5 mmhc_0.005 70    26 53.08280 -2826.306  59 13 57 13</span></span>
<span><span class="co">#&gt; 6  mmhc_0.01 70    29 36.29393 -2710.490  58 15 55 14</span></span>
<span><span class="co">#&gt;         TPR Precision    Recall        F1 SID PPI</span></span>
<span><span class="co">#&gt; 1 0.3285714 0.3285714 0.3898305 0.3565891  NA  NA</span></span>
<span><span class="co">#&gt; 2 0.3142857 0.3142857 0.5641026 0.4036697  NA  NA</span></span>
<span><span class="co">#&gt; 3 0.1142857 0.1142857 0.2666667 0.1600000  NA  NA</span></span>
<span><span class="co">#&gt; 4 0.1714286 0.1714286 0.4800000 0.2526316  NA  NA</span></span>
<span><span class="co">#&gt; 5 0.1857143 0.1857143 0.5000000 0.2708333  NA  NA</span></span>
<span><span class="co">#&gt; 6 0.2142857 0.2142857 0.5172414 0.3030303  NA  NA</span></span>
<span><span class="co">#&gt;          time   BICnorm  N  p</span></span>
<span><span class="co">#&gt; 1 12.12359881 0.9389295 50 46</span></span>
<span><span class="co">#&gt; 2  0.90299201 0.8854144 50 46</span></span>
<span><span class="co">#&gt; 3 10.81846905 0.5672219 50 46</span></span>
<span><span class="co">#&gt; 4  0.11805296 0.6734400 50 46</span></span>
<span><span class="co">#&gt; 5  0.08204889 0.6753229 50 46</span></span>
<span><span class="co">#&gt; 6  0.07851481 0.7502440 50 46</span></span></code></pre></div>
<p>The results can be visualized in the usual way by using the library like <code>ggplot2</code>. We use here <code>plotthis</code> library for visualizing.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pwwang/plotthis">plotthis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrepel.slowkow.com/">ggrepel</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pwwang.github.io/plotthis/reference/ScatterPlot.html">ScatterPlot</a></span><span class="op">(</span><span class="va">mf</span><span class="op">$</span><span class="va">metrics</span>, x<span class="op">=</span><span class="st">"SHD"</span>, y<span class="op">=</span><span class="st">"F1"</span>, color_by<span class="op">=</span><span class="st">"algo"</span>, legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">algo</span><span class="op">)</span>, bg.colour<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-evaluation_files/figure-html/mf2-1.png" width="60%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="evaluating-the-causal-validity" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Evaluating the causal validity<a class="anchor" aria-label="anchor" href="#evaluating-the-causal-validity"><i class="fas fa-link"></i></a>
</h2>
<p>The primary objective of the package is evaluating the causal validity of the inferred networks. Two approach can be used, in the situations that the reference directed network is available or not. In most of the cases, the reference networks is not readily available.</p>
<div id="obtaining-the-directed-acyclic-graphs-dags-for-the-evaluation" class="section level3" number="6.2.1">
<h3>
<span class="header-section-number">6.2.1</span> Obtaining the directed acyclic graphs (DAGs) for the evaluation<a class="anchor" aria-label="anchor" href="#obtaining-the-directed-acyclic-graphs-dags-for-the-evaluation"><i class="fas fa-link"></i></a>
</h3>
<p>For the interesting biological pathway, one can obtain DAG from the KEGG PATHWAY. The <code>getKEGGEdges</code> function accepts the pathway identifier and returns the DAG, though it will not always succeed. The function first parses the pathway information using <code>ggkegg</code>, and identify the largest components to be evaluated. If <code>removeCycle</code> is TRUE, the function identifies the minimum feedback using igraph function and remove these edges. This returns the <code>bn</code> object.</p>
<p>Suppose you are interested in inferring gene regulatory networks in mTOR signaling pathway from your dataset, you should first load DAG from the KEGG API.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/noriakis/scstruc">scstruc</a></span><span class="op">)</span></span>
<span><span class="va">dags</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scstruc/man/getKEGGEdges.html">getKEGGEdges</a></span><span class="op">(</span><span class="st">"mmu04150"</span>, removeCycle<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Removing Pik3ca|Mtor</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/graphviz.plot.html">graphviz.plot</a></span><span class="op">(</span><span class="va">dags</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-evaluation_files/figure-html/getkeggedges-1.png" width="50%" style="display: block; margin: auto;"></div>
<p>Using the genes in this candidate pathway, inference is performed and performance metrics can be obtained based on the reference DAG.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mymet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scstruc/man/metrics.html">metrics</a></span><span class="op">(</span><span class="va">dags</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Algo1"</span><span class="op">=</span><span class="va">net</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="intersection-validation-approach" class="section level3" number="6.2.2">
<h3>
<span class="header-section-number">6.2.2</span> Intersection-Validation approach<a class="anchor" aria-label="anchor" href="#intersection-validation-approach"><i class="fas fa-link"></i></a>
</h3>
<p>In case there are no reference networks, we can use Insersection-Validation approach, proposed by Viinikka et al. <span class="citation">(<a href="references.html#ref-viinikka_intersection-validation_2018">Viinikka, Eggeling, and Koivisto 2018</a>)</span> to evaluate which algorithm is optimal in terms of SHD and SID. For this purpose, <code>interVal</code> function is prepared. The function accepts input data, multiple algorithms to be tested, and parameters related to Intersection-Validation. The implemented metrics are SHD and SID.</p>
<p>The user should provide <code>data</code> and algorithms to be tested,</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">gaussian.test</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scstruc/man/interVal.html">interVal</a></span><span class="op">(</span><span class="va">test.data</span>, algos<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hc"</span>,<span class="st">"mmhc"</span>,<span class="st">"tabu"</span><span class="op">)</span>, ss<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">test</span></span>
<span><span class="co">#&gt; $A0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Random/Generated Bayesian network</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   model:</span></span>
<span><span class="co">#&gt;    [A][B][C][D][E][G][F|E:G] </span></span>
<span><span class="co">#&gt;   nodes:                                 7 </span></span>
<span><span class="co">#&gt;   arcs:                                  2 </span></span>
<span><span class="co">#&gt;     undirected arcs:                     0 </span></span>
<span><span class="co">#&gt;     directed arcs:                       2 </span></span>
<span><span class="co">#&gt;   average markov blanket size:           0.86 </span></span>
<span><span class="co">#&gt;   average neighbourhood size:            0.57 </span></span>
<span><span class="co">#&gt;   average branching factor:              0.29 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   generation algorithm:                  Empty </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $stat</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 4</span></span>
<span><span class="co">#&gt;   AlgoNum SHD.stat SID.stat    en</span></span>
<span><span class="co">#&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1       1      5.2      0     7.2</span></span>
<span><span class="co">#&gt; 2       2      2.7      1.5   2.3</span></span>
<span><span class="co">#&gt; 3       3      5.4      0     7.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $raw.stat</span></span>
<span><span class="co">#&gt;     R AlgoNum SHD SID EdgeNumber</span></span>
<span><span class="co">#&gt; 1   1       1   6   0          8</span></span>
<span><span class="co">#&gt; 2   1       2   1   0          3</span></span>
<span><span class="co">#&gt; 3   1       3   6   0          8</span></span>
<span><span class="co">#&gt; 4   2       1   6   0          8</span></span>
<span><span class="co">#&gt; 5   2       2   3   3          2</span></span>
<span><span class="co">#&gt; 6   2       3   6   0          8</span></span>
<span><span class="co">#&gt; 7   3       1   4   0          6</span></span>
<span><span class="co">#&gt; 8   3       2   3   1          2</span></span>
<span><span class="co">#&gt; 9   3       3   5   0          7</span></span>
<span><span class="co">#&gt; 10  4       1   7   0          9</span></span>
<span><span class="co">#&gt; 11  4       2   3   1          2</span></span>
<span><span class="co">#&gt; 12  4       3   7   0          9</span></span>
<span><span class="co">#&gt; 13  5       1   5   0          7</span></span>
<span><span class="co">#&gt; 14  5       2   3   1          2</span></span>
<span><span class="co">#&gt; 15  5       3   5   0          7</span></span>
<span><span class="co">#&gt; 16  6       1   6   0          8</span></span>
<span><span class="co">#&gt; 17  6       2   3   3          2</span></span>
<span><span class="co">#&gt; 18  6       3   6   0          8</span></span>
<span><span class="co">#&gt; 19  7       1   4   0          6</span></span>
<span><span class="co">#&gt; 20  7       2   3   1          3</span></span>
<span><span class="co">#&gt; 21  7       3   5   0          7</span></span>
<span><span class="co">#&gt; 22  8       1   4   0          6</span></span>
<span><span class="co">#&gt; 23  8       2   3   3          2</span></span>
<span><span class="co">#&gt; 24  8       3   4   0          6</span></span>
<span><span class="co">#&gt; 25  9       1   5   0          7</span></span>
<span><span class="co">#&gt; 26  9       2   1   0          3</span></span>
<span><span class="co">#&gt; 27  9       3   5   0          7</span></span>
<span><span class="co">#&gt; 28 10       1   5   0          7</span></span>
<span><span class="co">#&gt; 29 10       2   4   2          2</span></span>
<span><span class="co">#&gt; 30 10       3   5   0          7</span></span></code></pre></div>
<p><code>r</code> argument is used to specify the iteration number, and <code>ss</code> argument is used to specify sub-sampling number. It leaves a message if connected node pairs, defined as the number of edges in the agreement graph, is below 15. <code>returnA0</code> option can be used to return only the intersection of inferred networks at the first stage. <code>output</code> option can be specified to output the relevant data (data used for the inference, <code>A0</code>, and all the <code>bn</code> object).</p>
</div>
</div>
<div id="auprc" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> AUPRC<a class="anchor" aria-label="anchor" href="#auprc"><i class="fas fa-link"></i></a>
</h2>
<p>Although the package focuses on Bayesian network evaluation, the commonly used metrics of area under precision-recall curve (AUPRC) can be calculated. <code>calc.auprc</code> accepts reference <code>bn</code> object and <code>bn.strength</code> object obtained by bootstrapping, and returns the AUPRC value. The function uses <code>yardstick</code> to calculate the value. The <code>target</code> argument specifies which column is to be used as weight, which is useful for the output from the software like <code>GENIE3</code>. The below example uses bootstrapped GES network for inference and calculates the AUPRC.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"ecoli70.rds"</span><span class="op">)</span></span>
<span><span class="va">data.inference</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/rbn.html">rbn</a></span><span class="op">(</span><span class="va">net</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">infer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scstruc/man/pcalg.boot.html">pcalg.boot</a></span><span class="op">(</span><span class="va">data.inference</span>, R<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/scstruc/man/calc.auprc.html">calc.auprc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/bn.fit.html">bn.net</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span>, <span class="va">infer</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span><span class="co">#&gt;   .metric .estimator .estimate</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 pr_auc  binary         0.407</span></span></code></pre></div>
<p>By combining these methods, it is possible to determine which network is most suitable for assessment.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="other-algorithms-and-software.html"><span class="header-section-number">5</span> Other algorithms and software</a></div>
<div class="next"><a href="fitting-and-comparing-the-parameters.html"><span class="header-section-number">7</span> Fitting and comparing the parameters</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#evaluating-the-inferred-networks"><span class="header-section-number">6</span> Evaluating the inferred networks</a></li>
<li>
<a class="nav-link" href="#evaluation-functions"><span class="header-section-number">6.1</span> Evaluation functions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#metrics-function"><span class="header-section-number">6.1.1</span> metrics function</a></li>
<li><a class="nav-link" href="#metricsfromfitted-function"><span class="header-section-number">6.1.2</span> metricsFromFitted function</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#evaluating-the-causal-validity"><span class="header-section-number">6.2</span> Evaluating the causal validity</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#obtaining-the-directed-acyclic-graphs-dags-for-the-evaluation"><span class="header-section-number">6.2.1</span> Obtaining the directed acyclic graphs (DAGs) for the evaluation</a></li>
<li><a class="nav-link" href="#intersection-validation-approach"><span class="header-section-number">6.2.2</span> Intersection-Validation approach</a></li>
</ul>
</li>
<li><a class="nav-link" href="#auprc"><span class="header-section-number">6.3</span> AUPRC</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>scstruc: causal assessment of gene regulatory network using Bayesian network</strong>" was written by Noriaki Sato. It was last built on 2025-04-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
