<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 8 Plotting functions | scstruc: causal assessment of gene regulatory network using Bayesian network</title>
<meta name="author" content="Noriaki Sato">
<meta name="description" content="The library has various functions for visualizing the inferred networks with highlighting the important regulatory relationships and comparing the inferred networks by multiple algorithms, using...">
<meta name="generator" content="bookdown 0.41 with bs4_book()">
<meta property="og:title" content="Chapter 8 Plotting functions | scstruc: causal assessment of gene regulatory network using Bayesian network">
<meta property="og:type" content="book">
<meta property="og:description" content="The library has various functions for visualizing the inferred networks with highlighting the important regulatory relationships and comparing the inferred networks by multiple algorithms, using...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 8 Plotting functions | scstruc: causal assessment of gene regulatory network using Bayesian network">
<meta name="twitter:description" content="The library has various functions for visualizing the inferred networks with highlighting the important regulatory relationships and comparing the inferred networks by multiple algorithms, using...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">scstruc: causal assessment of gene regulatory network using Bayesian network</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="basic-usage-of-scstruc.html"><span class="header-section-number">2</span> Basic usage of scstruc</a></li>
<li><a class="" href="penalized-regressions.html"><span class="header-section-number">3</span> Penalized regressions</a></li>
<li><a class="" href="hurdle-model.html"><span class="header-section-number">4</span> Hurdle model</a></li>
<li><a class="" href="other-algorithms-and-software.html"><span class="header-section-number">5</span> Other algorithms and software</a></li>
<li><a class="" href="evaluating-the-inferred-networks.html"><span class="header-section-number">6</span> Evaluating the inferred networks</a></li>
<li><a class="" href="fitting-and-comparing-the-parameters.html"><span class="header-section-number">7</span> Fitting and comparing the parameters</a></li>
<li><a class="active" href="plot.html"><span class="header-section-number">8</span> Plotting functions</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="plot" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> Plotting functions<a class="anchor" aria-label="anchor" href="#plot"><i class="fas fa-link"></i></a>
</h1>
<p>The library has various functions for visualizing the inferred networks with highlighting the important regulatory relationships and comparing the inferred networks by multiple algorithms, using the <code>ggraph</code>, <code>tidygraph</code> and <code>ggfx</code>. These can be useful for the diagnosis and for the publication figure. Mostly, the function accepts the <code>bn</code> object from <code>bnlearn</code>.</p>
<div id="plotnet" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> <code>plotNet</code><a class="anchor" aria-label="anchor" href="#plotnet"><i class="fas fa-link"></i></a>
</h2>
<p><code>plotNet</code> function accepts <code>bn</code> object.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/noriakis/scstruc">scstruc</a></span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scuttle/man/mockSCE.html">mockSCE</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scuttle/man/logNormCounts.html">logNormCounts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span>
<span><span class="va">included_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-envirAPI.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scstruc/man/scstruc.html">scstruc</a></span><span class="op">(</span><span class="va">sce</span>, <span class="va">included_genes</span>, changeSymbol<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>    algorithm<span class="op">=</span><span class="st">"glmnet_BIC"</span>, returnData<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Vanilla plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/scstruc/man/plotNet.html">plotNet</a></span><span class="op">(</span><span class="va">gs</span><span class="op">$</span><span class="va">net</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="07-plotting_files/figure-html/plotNet1-1.png" width="65%" style="display: block; margin: auto;"></div>
<p>Optionally, <code>data</code> can be passed to fit the parameters and the function colors the edge using the fitted parameters. The nodes will be sized by their degrees. <code>degreeMode</code> argument can be specified for how the degree will be calculated. By default, <code>mode="all"</code> is specified.</p>
</div>
<div id="plotavn" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> <code>plotAVN</code><a class="anchor" aria-label="anchor" href="#plotavn"><i class="fas fa-link"></i></a>
</h2>
<p>This function is intended specifically for visualizing the bootstrapped networks. You can pass the results of functions returning <code>bn.strength</code> object, to this function. The threshold will be automatically determined if not specified. In the plot, the strength are shown as edge width, and the direction are shown as edge color. The node sizes will be determined by the degree.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com">ggraph</a></span><span class="op">)</span></span>
<span><span class="va">gs.boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scstruc/man/scstruc.html">scstruc</a></span><span class="op">(</span><span class="va">sce</span>, <span class="va">included_genes</span>, changeSymbol<span class="op">=</span><span class="cn">FALSE</span>, boot<span class="op">=</span><span class="cn">TRUE</span>, R<span class="op">=</span><span class="fl">10</span>,</span>
<span>             algorithm<span class="op">=</span><span class="st">"glmnet_BIC"</span>, returnData<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Bootstrapping specified</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/scstruc/man/plotAVN.html">plotAVN</a></span><span class="op">(</span><span class="va">gs.boot</span><span class="op">$</span><span class="va">net</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="07-plotting_files/figure-html/plotavn1-1.png" width="65%" style="display: block; margin: auto;"></div>
<p>Edges can be highlighted by specifying <code>highlightEdges</code> argument, as same as <code>plotNet</code>. In the <code>plotAVN</code>, the <code>with_outer_glow</code> function in <code>ggfx</code> package is used to highlight edges as to preserve the strength and direction mapping in the plot.</p>
</div>
<div id="ggraph.compare" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> <code>ggraph.compare</code><a class="anchor" aria-label="anchor" href="#ggraph.compare"><i class="fas fa-link"></i></a>
</h2>
<p>Similar to <code>graphviz.compare</code> function in <code>bnlearn</code>, the diagnostic plot can be made by <code>ggraph.compare</code>. This accepts the list of <code>bn</code> object and plot the nodes and each edge associated with the graphs by <code>geom_edge_parallel</code>. The agreement of edges in multiple graphs can be understood with the function, however, it will get too complicated if many graphs are provided.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/scstruc/man/ggraph.compare.html">ggraph.compare</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"boot"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/arc.strength.html">averaged.network</a></span><span class="op">(</span><span class="va">gs.boot</span><span class="op">$</span><span class="va">net</span><span class="op">)</span>, <span class="st">"raw"</span><span class="op">=</span><span class="va">gs</span><span class="op">$</span><span class="va">net</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="07-plotting_files/figure-html/ggraph.compare-1.png" width="65%" style="display: block; margin: auto;"></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="fitting-and-comparing-the-parameters.html"><span class="header-section-number">7</span> Fitting and comparing the parameters</a></div>
<div class="next"><a href="references.html">References</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#plot"><span class="header-section-number">8</span> Plotting functions</a></li>
<li><a class="nav-link" href="#plotnet"><span class="header-section-number">8.1</span> plotNet</a></li>
<li><a class="nav-link" href="#plotavn"><span class="header-section-number">8.2</span> plotAVN</a></li>
<li><a class="nav-link" href="#ggraph.compare"><span class="header-section-number">8.3</span> ggraph.compare</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>scstruc: causal assessment of gene regulatory network using Bayesian network</strong>" was written by Noriaki Sato. It was last built on 2025-04-15.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
