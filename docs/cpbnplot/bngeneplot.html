<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 bngeneplot | cpbnplot</title>
  <meta name="description" content="Plotting Bayesian network based on enrichment analysis including clusterProfiler and ReactomePA" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 bngeneplot | cpbnplot" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://noriakis.github.io/software/cpbnplot/" />
  
  <meta property="og:description" content="Plotting Bayesian network based on enrichment analysis including clusterProfiler and ReactomePA" />
  <meta name="github-repo" content="noriakis/cpbnplot" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 bngeneplot | cpbnplot" />
  
  <meta name="twitter:description" content="Plotting Bayesian network based on enrichment analysis including clusterProfiler and ReactomePA" />
  

<meta name="author" content="Noriaki Sato" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bootstrap-based-inference.html"/>
<link rel="next" href="bnpathplot.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">cpbnplot</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> cpbnplot: Bayesian network plot for enrichment analysis results</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-preprocessing-and-deg-identification-of-gse133624"><i class="fa fa-check"></i><b>1.1</b> The preprocessing and DEG identification of GSE133624</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="bootstrap-based-inference.html"><a href="bootstrap-based-inference.html"><i class="fa fa-check"></i><b>2</b> bootstrap-based inference</a>
<ul>
<li class="chapter" data-level="2.1" data-path="bootstrap-based-inference.html"><a href="bootstrap-based-inference.html#bootstrap-based-inference-1"><i class="fa fa-check"></i><b>2.1</b> bootstrap-based inference</a></li>
<li class="chapter" data-level="2.2" data-path="bootstrap-based-inference.html"><a href="bootstrap-based-inference.html#multiscale-boostrap-based-inference"><i class="fa fa-check"></i><b>2.2</b> Multiscale boostrap-based inference</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bngeneplot.html"><a href="bngeneplot.html"><i class="fa fa-check"></i><b>3</b> <code>bngeneplot</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="bngeneplot.html"><a href="bngeneplot.html#barplot"><i class="fa fa-check"></i><b>3.1</b> <code>barplot</code></a></li>
<li class="chapter" data-level="3.2" data-path="bngeneplot.html"><a href="bngeneplot.html#the-vanilla-plot"><i class="fa fa-check"></i><b>3.2</b> The vanilla plot</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="bngeneplot.html"><a href="bngeneplot.html#show-the-confidence-of-direction"><i class="fa fa-check"></i><b>3.2.1</b> Show the confidence of direction</a></li>
<li class="chapter" data-level="3.2.2" data-path="bngeneplot.html"><a href="bngeneplot.html#show-the-hub-genes"><i class="fa fa-check"></i><b>3.2.2</b> Show the hub genes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="bngeneplot.html"><a href="bngeneplot.html#the-plot-with-the-reference"><i class="fa fa-check"></i><b>3.3</b> The plot with the reference</a></li>
<li class="chapter" data-level="3.4" data-path="bngeneplot.html"><a href="bngeneplot.html#the-plot-with-the-depmap-information"><i class="fa fa-check"></i><b>3.4</b> The plot with the DepMap information</a></li>
<li class="chapter" data-level="3.5" data-path="bngeneplot.html"><a href="bngeneplot.html#plotting-edge-strengths"><i class="fa fa-check"></i><b>3.5</b> Plotting edge strengths</a></li>
<li class="chapter" data-level="3.6" data-path="bngeneplot.html"><a href="bngeneplot.html#plotting-genes-in-multiple-pathways"><i class="fa fa-check"></i><b>3.6</b> Plotting genes in multiple pathways</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bnpathplot.html"><a href="bnpathplot.html"><i class="fa fa-check"></i><b>4</b> <code>bnpathplot</code></a>
<ul>
<li class="chapter" data-level="4.1" data-path="bnpathplot.html"><a href="bnpathplot.html#emapplot"><i class="fa fa-check"></i><b>4.1</b> <code>emapplot</code></a></li>
<li class="chapter" data-level="4.2" data-path="bnpathplot.html"><a href="bnpathplot.html#the-vanilla-plot-1"><i class="fa fa-check"></i><b>4.2</b> The vanilla plot</a></li>
<li class="chapter" data-level="4.3" data-path="bnpathplot.html"><a href="bnpathplot.html#compare-with-the-reference"><i class="fa fa-check"></i><b>4.3</b> Compare with the reference</a></li>
<li class="chapter" data-level="4.4" data-path="bnpathplot.html"><a href="bnpathplot.html#reflect-depmap-information-to-pathways"><i class="fa fa-check"></i><b>4.4</b> Reflect DepMap information to pathways</a></li>
<li class="chapter" data-level="4.5" data-path="bnpathplot.html"><a href="bnpathplot.html#aggregating-the-pathway-databases"><i class="fa fa-check"></i><b>4.5</b> Aggregating the pathway databases</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="including-clinical-variables.html"><a href="including-clinical-variables.html"><i class="fa fa-check"></i><b>5</b> Including clinical variables</a>
<ul>
<li class="chapter" data-level="5.1" data-path="including-clinical-variables.html"><a href="including-clinical-variables.html#preparation-of-data"><i class="fa fa-check"></i><b>5.1</b> Preparation of data</a></li>
<li class="chapter" data-level="5.2" data-path="including-clinical-variables.html"><a href="including-clinical-variables.html#inference-of-pathway-relationship-including-clinical-variables"><i class="fa fa-check"></i><b>5.2</b> Inference of pathway relationship including clinical variables</a></li>
<li class="chapter" data-level="5.3" data-path="including-clinical-variables.html"><a href="including-clinical-variables.html#conditional-probability-query"><i class="fa fa-check"></i><b>5.3</b> Conditional probability query</a></li>
<li class="chapter" data-level="5.4" data-path="including-clinical-variables.html"><a href="including-clinical-variables.html#gene-relationship-with-variables"><i class="fa fa-check"></i><b>5.4</b> Gene relationship with variables</a></li>
<li class="chapter" data-level="5.5" data-path="including-clinical-variables.html"><a href="including-clinical-variables.html#confirming-the-existing-knowledge"><i class="fa fa-check"></i><b>5.5</b> Confirming the existing knowledge</a></li>
<li class="chapter" data-level="5.6" data-path="including-clinical-variables.html"><a href="including-clinical-variables.html#investigating-the-network-based-on-the-clinical-question"><i class="fa fa-check"></i><b>5.6</b> Investigating the network based on the clinical question</a></li>
<li class="chapter" data-level="5.7" data-path="including-clinical-variables.html"><a href="including-clinical-variables.html#classification-using-bn"><i class="fa fa-check"></i><b>5.7</b> Classification using BN</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-other-options.html"><a href="the-other-options.html"><i class="fa fa-check"></i><b>6</b> The other options</a>
<ul>
<li class="chapter" data-level="6.1" data-path="the-other-options.html"><a href="the-other-options.html#bootstrap-reasoning"><i class="fa fa-check"></i><b>6.1</b> Bootstrap reasoning</a></li>
<li class="chapter" data-level="6.2" data-path="the-other-options.html"><a href="the-other-options.html#discretization"><i class="fa fa-check"></i><b>6.2</b> Discretization</a></li>
<li class="chapter" data-level="6.3" data-path="the-other-options.html"><a href="the-other-options.html#custom-visualization"><i class="fa fa-check"></i><b>6.3</b> Custom visualization</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="the-other-options.html"><a href="the-other-options.html#the-glowing-nodes-and-edges"><i class="fa fa-check"></i><b>6.3.1</b> The glowing nodes and edges</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="testing-the-score-inside-the-pathway.html"><a href="testing-the-score-inside-the-pathway.html"><i class="fa fa-check"></i><b>7</b> Testing the score inside the pathway</a></li>
<li class="chapter" data-level="8" data-path="testing-r.html"><a href="testing-r.html"><i class="fa fa-check"></i><b>8</b> Testing R</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">cpbnplot</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bngeneplot" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> <code>bngeneplot</code></h1>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="bngeneplot.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show top-30 pathways sorted by p-value in descending order.</span></span>
<span id="cb5-2"><a href="bngeneplot.html#cb5-2" aria-hidden="true" tabindex="-1"></a>pway<span class="sc">@</span>result<span class="sc">$</span>Description[<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>]</span></code></pre></div>
<pre><code>FALSE  [1] &quot;Cell Cycle Checkpoints&quot;                                                              
FALSE  [2] &quot;Amplification of signal from the kinetochores&quot;                                       
FALSE  [3] &quot;Amplification  of signal from unattached  kinetochores via a MAD2  inhibitory signal&quot;
FALSE  [4] &quot;Mitotic Prometaphase&quot;                                                                
FALSE  [5] &quot;Resolution of Sister Chromatid Cohesion&quot;                                             
FALSE  [6] &quot;Mitotic Spindle Checkpoint&quot;                                                          
FALSE  [7] &quot;Activation of ATR in response to replication stress&quot;                                 
FALSE  [8] &quot;DNA strand elongation&quot;                                                               
FALSE  [9] &quot;Mitotic Metaphase and Anaphase&quot;                                                      
FALSE [10] &quot;Muscle contraction&quot;                                                                  
FALSE [11] &quot;DNA Replication&quot;                                                                     
FALSE [12] &quot;RHO GTPases Activate Formins&quot;                                                        
FALSE [13] &quot;Mitotic Anaphase&quot;                                                                    
FALSE [14] &quot;Homologous DNA Pairing and Strand Exchange&quot;                                          
FALSE [15] &quot;HDR through Homologous Recombination (HRR)&quot;                                          
FALSE [16] &quot;S Phase&quot;                                                                             
FALSE [17] &quot;Separation of Sister Chromatids&quot;                                                     
FALSE [18] &quot;Synthesis of DNA&quot;                                                                    
FALSE [19] &quot;Activation of the pre-replicative complex&quot;                                           
FALSE [20] &quot;Extension of Telomeres&quot;                                                              
FALSE [21] &quot;Extracellular matrix organization&quot;                                                   
FALSE [22] &quot;M Phase&quot;                                                                             
FALSE [23] &quot;Presynaptic phase of homologous DNA pairing and strand exchange&quot;                     
FALSE [24] &quot;Resolution of D-loop Structures through Holliday Junction Intermediates&quot;             
FALSE [25] &quot;Mitotic G1-G1/S phases&quot;                                                              
FALSE [26] &quot;CDC6 association with the ORC:origin complex&quot;                                        
FALSE [27] &quot;Resolution of D-Loop Structures&quot;                                                     
FALSE [28] &quot;DNA Double-Strand Break Repair&quot;                                                      
FALSE [29] &quot;G1/S Transition&quot;                                                                     
FALSE [30] &quot;Resolution of D-loop Structures through Synthesis-Dependent Strand Annealing (SDSA)&quot;</code></pre>
<div id="barplot" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> <code>barplot</code></h2>
<p>The default <code>barplot()</code> from clusterProfiler.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="bngeneplot.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(pway, <span class="at">showCategory =</span> <span class="dv">15</span>)</span></code></pre></div>
<p><img src="cpbnplot_doc_files/figure-html/unnamed-chunk-2-1.png" width="960" /></p>
</div>
<div id="the-vanilla-plot" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> The vanilla plot</h2>
<p>This function plots inferred relationship between genes in the specific pathway, with the boot-strapped strength between genes. The normal plot can be plotted by passing the results of clusterProfiler or ReactomePA, and (normalized) expression values as well as candidate samples to be included in the inference. For the pathway including many genes, parallel computing of bootstrap-based inference can be specified with <code>cl</code> parameter.</p>
<p>Running <code>bngeneplot</code> in the default parameter.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="bngeneplot.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bngeneplot</span>(<span class="at">results =</span> pway, <span class="at">exp =</span> vsted, <span class="at">pathNum =</span> <span class="dv">17</span>)</span></code></pre></div>
<p><img src="cpbnplot_doc_files/figure-html/geneplot_raw-1.png" width="960" /></p>
<p>Change the label for the better readability.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="bngeneplot.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bngeneplot</span>(<span class="at">results =</span> pway, <span class="at">exp =</span> vsted, <span class="at">pathNum =</span> <span class="dv">17</span>, <span class="at">labelSize=</span><span class="dv">7</span>, <span class="at">shadowText=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="cpbnplot_doc_files/figure-html/geneplot_raw2-1.png" width="960" /></p>
<p>In general, specify samples to be included.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="bngeneplot.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bngeneplot</span>(<span class="at">results =</span> pway, <span class="at">exp =</span> vsted, <span class="at">expSample =</span> incSample, <span class="at">pathNum =</span> <span class="dv">17</span>)</span></code></pre></div>
<p><img src="cpbnplot_doc_files/figure-html/geneplot-1.png" width="960" /></p>
<p>If the resulting network is messy, we can set threshold for the averaged network, which is automatically set by function <code>threshold()</code> from <code>blnearn</code> if not specified. <code>convertSymbol</code> converts the output to SYMBOL.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="bngeneplot.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bngeneplot</span>(<span class="at">results =</span> pway,</span>
<span id="cb11-2"><a href="bngeneplot.html#cb11-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">exp =</span> vsted,</span>
<span id="cb11-3"><a href="bngeneplot.html#cb11-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">expSample =</span> incSample,</span>
<span id="cb11-4"><a href="bngeneplot.html#cb11-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">pathNum =</span> <span class="dv">17</span>, <span class="at">R =</span> <span class="dv">10</span>,</span>
<span id="cb11-5"><a href="bngeneplot.html#cb11-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">convertSymbol =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-6"><a href="bngeneplot.html#cb11-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">expRow =</span> <span class="st">&quot;ENSEMBL&quot;</span>,</span>
<span id="cb11-7"><a href="bngeneplot.html#cb11-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">strThresh =</span> <span class="fl">0.75</span>)</span></code></pre></div>
<p><img src="cpbnplot_doc_files/figure-html/geneplot_thresh-1.png" width="960" /></p>
<div id="show-the-confidence-of-direction" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Show the confidence of direction</h3>
<p>The value of the confidence of edge direction can be plotted by setting <code>showDir = T</code>. Note that the color represents the strength value.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="bngeneplot.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bngeneplot</span>(<span class="at">results =</span> pway,</span>
<span id="cb12-2"><a href="bngeneplot.html#cb12-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">exp =</span> vsted,</span>
<span id="cb12-3"><a href="bngeneplot.html#cb12-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">expSample =</span> incSample,</span>
<span id="cb12-4"><a href="bngeneplot.html#cb12-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">pathNum =</span> <span class="dv">13</span>, <span class="at">R =</span> <span class="dv">50</span>, <span class="at">showDir =</span> T,</span>
<span id="cb12-5"><a href="bngeneplot.html#cb12-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">convertSymbol =</span> T,</span>
<span id="cb12-6"><a href="bngeneplot.html#cb12-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">expRow =</span> <span class="st">&quot;ENSEMBL&quot;</span>,</span>
<span id="cb12-7"><a href="bngeneplot.html#cb12-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">strThresh =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="cpbnplot_doc_files/figure-html/geneplot_thresh_direc-1.png" width="960" /></p>
</div>
<div id="show-the-hub-genes" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Show the hub genes</h3>
<p>Additionally, showing the hub gene (defined by <code>hub</code> parameter which highlights genes with top-<span class="math inline">\(n\)</span> hub scores) is informative. Weighted Kleinbergâ€™s hub centrality scores are calculated by <code>igraph::hub_score()</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="bngeneplot.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bngeneplot</span>(<span class="at">results =</span> pway,</span>
<span id="cb13-2"><a href="bngeneplot.html#cb13-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">exp =</span> vsted,</span>
<span id="cb13-3"><a href="bngeneplot.html#cb13-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">expSample =</span> incSample,</span>
<span id="cb13-4"><a href="bngeneplot.html#cb13-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">pathNum =</span> <span class="dv">13</span>, <span class="at">R =</span> <span class="dv">50</span>, <span class="at">showDir =</span> T,</span>
<span id="cb13-5"><a href="bngeneplot.html#cb13-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">convertSymbol =</span> T,</span>
<span id="cb13-6"><a href="bngeneplot.html#cb13-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">expRow =</span> <span class="st">&quot;ENSEMBL&quot;</span>, <span class="at">hub=</span><span class="dv">5</span>,</span>
<span id="cb13-7"><a href="bngeneplot.html#cb13-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">strThresh =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="cpbnplot_doc_files/figure-html/geneplot_thresh_hub-1.png" width="960" /></p>
</div>
</div>
<div id="the-plot-with-the-reference" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> The plot with the reference</h2>
<p>The relationship between genes can be compared with the reference network by the option <code>compareRef=TRUE</code> and specifying <code>pathDb</code>.
By default, the intersection of two directed network is shown with the number of overlapping edges.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="bngeneplot.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb14-2"><a href="bngeneplot.html#cb14-2" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="dv">4</span>)</span>
<span id="cb14-3"><a href="bngeneplot.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">bngeneplot</span>(<span class="at">results =</span> pway,</span>
<span id="cb14-4"><a href="bngeneplot.html#cb14-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">exp =</span> vsted,</span>
<span id="cb14-5"><a href="bngeneplot.html#cb14-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">expSample =</span> incSample,</span>
<span id="cb14-6"><a href="bngeneplot.html#cb14-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">pathNum =</span> <span class="dv">13</span>, <span class="at">R =</span> <span class="dv">30</span>, <span class="at">compareRef =</span> T,</span>
<span id="cb14-7"><a href="bngeneplot.html#cb14-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">convertSymbol =</span> T, <span class="at">pathDb =</span> <span class="st">&quot;reactome&quot;</span>,</span>
<span id="cb14-8"><a href="bngeneplot.html#cb14-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">expRow =</span> <span class="st">&quot;ENSEMBL&quot;</span>, <span class="at">cl =</span> cl)</span></code></pre></div>
<p><img src="cpbnplot_doc_files/figure-html/geneplot_withreference-1.png" width="1440" /></p>
<p>We can plot the difference between the reference network by specifying <code>compareRefType="difference"</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="bngeneplot.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bngeneplot</span>(<span class="at">results =</span> pway,</span>
<span id="cb15-2"><a href="bngeneplot.html#cb15-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">exp =</span> vsted,</span>
<span id="cb15-3"><a href="bngeneplot.html#cb15-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">expSample =</span> incSample,</span>
<span id="cb15-4"><a href="bngeneplot.html#cb15-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">pathNum =</span> <span class="dv">15</span>, <span class="at">R =</span> <span class="dv">10</span>, <span class="at">compareRef =</span> T,</span>
<span id="cb15-5"><a href="bngeneplot.html#cb15-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">convertSymbol =</span> T, <span class="at">pathDb =</span> <span class="st">&quot;reactome&quot;</span>, <span class="at">compareRefType =</span> <span class="st">&quot;difference&quot;</span>,</span>
<span id="cb15-6"><a href="bngeneplot.html#cb15-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">expRow =</span> <span class="st">&quot;ENSEMBL&quot;</span>)</span></code></pre></div>
<p><img src="cpbnplot_doc_files/figure-html/geneplot_withdifference-1.png" width="1440" /></p>
</div>
<div id="the-plot-with-the-depmap-information" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> The plot with the DepMap information</h2>
<p>Additionally, DepMap dependency scores can be plotted as the size of nodes using <code>depmap</code> package by specifying <code>sizeDep=TRUE</code>. It is especially useful for cancer-related research. You must provide <code>depmap::depmap_crispr()</code> or the other data describing the dependency score to <code>dep</code> variable. If not, CRISPR scores are downloaded, cached and used. Additionally, the name of cell line interested must be specified. If <code>sizeDep=T</code>, the histogram of overall and within-pathway dependency scores will be plotted besides the network.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="bngeneplot.html#cb16-1" aria-hidden="true" tabindex="-1"></a>dep <span class="ot">=</span> depmap<span class="sc">::</span><span class="fu">depmap_crispr</span>()</span>
<span id="cb16-2"><a href="bngeneplot.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bngeneplot</span>(<span class="at">results =</span> pway,</span>
<span id="cb16-3"><a href="bngeneplot.html#cb16-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">exp =</span> vsted,</span>
<span id="cb16-4"><a href="bngeneplot.html#cb16-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">expSample =</span> incSample,</span>
<span id="cb16-5"><a href="bngeneplot.html#cb16-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">pathNum =</span> <span class="dv">15</span>, <span class="at">R =</span> <span class="dv">5</span>,<span class="at">compareRef =</span> T,</span>
<span id="cb16-6"><a href="bngeneplot.html#cb16-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">convertSymbol =</span> T, <span class="at">pathDb =</span> <span class="st">&quot;reactome&quot;</span>, <span class="at">compareRefType =</span> <span class="st">&quot;intersection&quot;</span>,</span>
<span id="cb16-7"><a href="bngeneplot.html#cb16-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">expRow =</span> <span class="st">&quot;ENSEMBL&quot;</span>, <span class="at">sizeDep =</span> T, <span class="at">dep =</span> dep)</span></code></pre></div>
<p><img src="cpbnplot_doc_files/figure-html/geneplot_depmap-1.png" width="1920" /></p>
<p>It can be the RNA interference based score.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="bngeneplot.html#cb17-1" aria-hidden="true" tabindex="-1"></a>rnai <span class="ot">=</span> depmap<span class="sc">::</span><span class="fu">depmap_rnai</span>()</span>
<span id="cb17-2"><a href="bngeneplot.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bngeneplot</span>(<span class="at">results =</span> pway,</span>
<span id="cb17-3"><a href="bngeneplot.html#cb17-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">exp =</span> vsted,</span>
<span id="cb17-4"><a href="bngeneplot.html#cb17-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">expSample =</span> incSample,</span>
<span id="cb17-5"><a href="bngeneplot.html#cb17-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">pathNum =</span> <span class="dv">3</span>, <span class="at">R =</span> <span class="dv">5</span>,<span class="at">compareRef =</span> T,</span>
<span id="cb17-6"><a href="bngeneplot.html#cb17-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">convertSymbol =</span> T, <span class="at">pathDb =</span> <span class="st">&quot;reactome&quot;</span>, <span class="at">compareRefType =</span> <span class="st">&quot;intersection&quot;</span>,</span>
<span id="cb17-7"><a href="bngeneplot.html#cb17-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">expRow =</span> <span class="st">&quot;ENSEMBL&quot;</span>, <span class="at">sizeDep =</span> T, <span class="at">dep =</span> rnai, <span class="at">cellLineName =</span> <span class="st">&quot;UMUC3_URINARY_TRACT&quot;</span>)</span></code></pre></div>
<p><img src="cpbnplot_doc_files/figure-html/geneplot_depmap_rnai-1.png" width="1920" /></p>
<p>Additionally, we can plot the dependency scores of interested genes across the lineage by specifying <code>showLineage=TRUE</code>. We must provide metadata from <code>depmap::depmap_metadata()</code> to <code>depMeta</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="bngeneplot.html#cb18-1" aria-hidden="true" tabindex="-1"></a>depMeta <span class="ot">=</span> depmap<span class="sc">::</span><span class="fu">depmap_metadata</span>()</span>
<span id="cb18-2"><a href="bngeneplot.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bngeneplot</span>(<span class="at">results =</span> pway,</span>
<span id="cb18-3"><a href="bngeneplot.html#cb18-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">exp =</span> vsted,</span>
<span id="cb18-4"><a href="bngeneplot.html#cb18-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">expSample =</span> incSample,</span>
<span id="cb18-5"><a href="bngeneplot.html#cb18-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">pathNum =</span> <span class="dv">15</span>, <span class="at">R =</span> <span class="dv">10</span>, <span class="at">compareRef =</span> T,</span>
<span id="cb18-6"><a href="bngeneplot.html#cb18-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">convertSymbol =</span> T, <span class="at">pathDb =</span> <span class="st">&quot;reactome&quot;</span>, <span class="at">compareRefType =</span> <span class="st">&quot;intersection&quot;</span>,</span>
<span id="cb18-7"><a href="bngeneplot.html#cb18-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">expRow =</span> <span class="st">&quot;ENSEMBL&quot;</span>, <span class="at">sizeDep =</span> T, <span class="at">dep =</span> dep, <span class="at">showLineage =</span> T, <span class="at">depMeta =</span> depMeta)</span></code></pre></div>
<p><img src="cpbnplot_doc_files/figure-html/geneplot_lineage-1.png" width="1920" /></p>
</div>
<div id="plotting-edge-strengths" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plotting edge strengths</h2>
<p>We can add a barplot depicting the edge strength and direction (probability), by specifying <code>strengthPlot=TRUE</code> and <code>nStrength</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="bngeneplot.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bngeneplot</span>(<span class="at">results =</span> pway,</span>
<span id="cb19-2"><a href="bngeneplot.html#cb19-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">exp =</span> vsted,</span>
<span id="cb19-3"><a href="bngeneplot.html#cb19-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">expSample =</span> incSample,</span>
<span id="cb19-4"><a href="bngeneplot.html#cb19-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">pathNum =</span> <span class="dv">15</span>, <span class="at">R =</span> <span class="dv">10</span>, <span class="at">compareRef =</span> T,</span>
<span id="cb19-5"><a href="bngeneplot.html#cb19-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">convertSymbol =</span> T, <span class="at">pathDb =</span> <span class="st">&quot;reactome&quot;</span>, <span class="at">compareRefType =</span> <span class="st">&quot;intersection&quot;</span>,</span>
<span id="cb19-6"><a href="bngeneplot.html#cb19-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">expRow =</span> <span class="st">&quot;ENSEMBL&quot;</span>, <span class="at">sizeDep =</span> T, <span class="at">dep =</span> dep, <span class="at">strengthPlot =</span> T, <span class="at">nStrength =</span> <span class="dv">10</span>)</span></code></pre></div>
<p><img src="cpbnplot_doc_files/figure-html/geneplot_edgestrength-1.png" width="1920" /></p>
</div>
<div id="plotting-genes-in-multiple-pathways" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Plotting genes in multiple pathways</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="bngeneplot.html#cb20-1" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="dv">8</span>)</span>
<span id="cb20-2"><a href="bngeneplot.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bngeneplot</span>(<span class="at">results =</span> pway,</span>
<span id="cb20-3"><a href="bngeneplot.html#cb20-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">exp =</span> vsted,</span>
<span id="cb20-4"><a href="bngeneplot.html#cb20-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">expSample =</span> incSample,</span>
<span id="cb20-5"><a href="bngeneplot.html#cb20-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">pathNum =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>), <span class="at">R =</span> <span class="dv">10</span>,</span>
<span id="cb20-6"><a href="bngeneplot.html#cb20-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">convertSymbol =</span> T,</span>
<span id="cb20-7"><a href="bngeneplot.html#cb20-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">expRow =</span> <span class="st">&quot;ENSEMBL&quot;</span>)</span></code></pre></div>
<p><img src="cpbnplot_doc_files/figure-html/geneplot_mult-1.png" width="1920" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bootstrap-based-inference.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bnpathplot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["cpbnplot_doc.pdf", "cpbnplot_doc.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
