<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 8 Single-cell transcriptomic data | biotextgraph</title>
<meta name="author" content="Noriaki Sato">
<meta name="generator" content="bookdown 0.35 with bs4_book()">
<meta property="og:title" content="Chapter 8 Single-cell transcriptomic data | biotextgraph">
<meta property="og:type" content="book">
<meta property="og:url" content="https://noriakis.github.io/software/biotextgraph/single-cell-transcriptomic-data.html">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 8 Single-cell transcriptomic data | biotextgraph">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-9FXY6YW4YZ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-9FXY6YW4YZ');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="For use with single-cell transcriptomic data, some functions are prepared. The example data used here is for the demonstrative purpose and the necessary preprocessing should be performed.  8.1...">
<meta property="og:description" content="For use with single-cell transcriptomic data, some functions are prepared. The example data used here is for the demonstrative purpose and the necessary preprocessing should be performed.  8.1...">
<meta name="twitter:description" content="For use with single-cell transcriptomic data, some functions are prepared. The example data used here is for the demonstrative purpose and the necessary preprocessing should be performed.  8.1...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">biotextgraph</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> About</a></li>
<li><a class="" href="basic-usage.html"><span class="header-section-number">2</span> Basic usage</a></li>
<li><a class="" href="metacyc.html"><span class="header-section-number">3</span> Microbial functional analysis</a></li>
<li><a class="" href="the-other-usage-for-microbiome-related-data.html"><span class="header-section-number">4</span> The other usage for microbiome-related data</a></li>
<li><a class="" href="interactive-inspection-of-gene-cluster-network-annotated-by-words.html"><span class="header-section-number">5</span> Interactive inspection of gene cluster network annotated by words</a></li>
<li><a class="" href="annotating-gene-cluster-dendrogram.html"><span class="header-section-number">6</span> Annotating gene cluster dendrogram</a></li>
<li><a class="" href="quantitative-analysis.html"><span class="header-section-number">7</span> Quantitative analysis</a></li>
<li><a class="active" href="single-cell-transcriptomic-data.html"><span class="header-section-number">8</span> Single-cell transcriptomic data</a></li>
<li><a class="" href="app.html"><span class="header-section-number">9</span> Application examples</a></li>
<li><a class="" href="parsing.html"><span class="header-section-number">10</span> Parsing</a></li>
<li><a class="" href="tidy.html"><span class="header-section-number">11</span> Perform each process separately</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="single-cell-transcriptomic-data" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> Single-cell transcriptomic data<a class="anchor" aria-label="anchor" href="#single-cell-transcriptomic-data"><i class="fas fa-link"></i></a>
</h1>
<p>For use with single-cell transcriptomic data, some functions are prepared.
The example data used here is for the demonstrative purpose and the necessary preprocessing should be performed.</p>
<div id="visualizing-textual-information-for-marker-genes" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> Visualizing textual information for marker genes<a class="anchor" aria-label="anchor" href="#visualizing-textual-information-for-marker-genes"><i class="fas fa-link"></i></a>
</h2>
<p>Visualize the network for all the clusterâ€™s marker genes.</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat">Seurat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com">ggraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">biotextgraph</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/YuLab-SMU/ggsc">ggsc</a></span><span class="op">)</span> <span class="co">## Install using BiocManager::install("ggsc")</span></span></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dir</span> <span class="op">=</span> <span class="st">"filtered_gene_bc_matrices/hg19"</span></span>
<span><span class="va">pbmc.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/Read10X.html">Read10X</a></span><span class="op">(</span>data.dir <span class="op">=</span> <span class="va">dir</span><span class="op">)</span></span>
<span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/CreateSeuratObject.html">CreateSeuratObject</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="va">pbmc.data</span>, project <span class="op">=</span> <span class="st">"pbmc3k"</span>,</span>
<span>                           min.cells<span class="op">=</span><span class="fl">3</span>, min.features<span class="op">=</span><span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/NormalizeData.html">NormalizeData</a></span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span></span>
<span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html">FindVariableFeatures</a></span><span class="op">(</span><span class="va">pbmc</span>, selection.method <span class="op">=</span> <span class="st">"vst"</span><span class="op">)</span></span>
<span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/ScaleData.html">ScaleData</a></span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/RunPCA.html">RunPCA</a></span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/VariableFeatures.html">VariableFeatures</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindNeighbors.html">FindNeighbors</a></span><span class="op">(</span><span class="va">pbmc</span>, dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindClusters.html">FindClusters</a></span><span class="op">(</span><span class="va">pbmc</span>, resolution <span class="op">=</span> <span class="fl">0.5</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/RunTSNE.html">RunTSNE</a></span><span class="op">(</span><span class="va">pbmc</span>, reduction.use <span class="op">=</span> <span class="st">"cca.aligned"</span>, dims.use <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, do.fast <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html">DimPlot</a></span><span class="op">(</span><span class="va">pbmc</span>, reduction <span class="op">=</span> <span class="st">"pca"</span>,</span>
<span>        label <span class="op">=</span> <span class="cn">TRUE</span>, pt.size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> </span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/sc1-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Or, use ggsc (ggsc, https://yulab-smu.top/ggsc/)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggsc/man/sc-dim-methods.html">sc_dim</a></span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ggsc/man/sc-dim-geom-label.html">sc_dim_geom_label</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="fu">shadowtext</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/shadowtext/man/geom_shadowtext.html">geom_shadowtext</a></span>, </span>
<span>            color<span class="op">=</span><span class="st">'black'</span>, bg.color<span class="op">=</span><span class="st">'white'</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/sc1-2.png" width="100%" style="display: block; margin: auto;"></div>
<p><code>TextMarkers</code> function can be used for Seurat results. <code>pvalThresh</code> can be specified.</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindAllMarkers.html">FindAllMarkers</a></span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span></span>
<span><span class="va">texts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/TextMarkers.html">TextMarkers</a></span><span class="op">(</span><span class="va">markers</span>, type<span class="op">=</span><span class="st">"network"</span>, pvalThresh<span class="op">=</span><span class="fl">1e-50</span><span class="op">)</span></span>
<span><span class="co">#&gt; 0</span></span>
<span><span class="co">#&gt; Input genes: 75</span></span>
<span><span class="co">#&gt;   Converted input genes: 75</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; Ignoring corThresh, automatically determine the value</span></span>
<span><span class="co">#&gt; threshold = 0.514</span></span>
<span><span class="co">#&gt; 1</span></span>
<span><span class="co">#&gt; Input genes: 197</span></span>
<span><span class="co">#&gt;   Converted input genes: 190</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; Ignoring corThresh, automatically determine the value</span></span>
<span><span class="co">#&gt; threshold = 0.102</span></span>
<span><span class="co">#&gt; 2</span></span>
<span><span class="co">#&gt; Input genes: 8</span></span>
<span><span class="co">#&gt;   Converted input genes: 8</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; Ignoring corThresh, automatically determine the value</span></span>
<span><span class="co">#&gt; threshold = 0.323</span></span>
<span><span class="co">#&gt; 3</span></span>
<span><span class="co">#&gt; Input genes: 64</span></span>
<span><span class="co">#&gt;   Converted input genes: 60</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; Ignoring corThresh, automatically determine the value</span></span>
<span><span class="co">#&gt; threshold = 0.101</span></span>
<span><span class="co">#&gt; 4</span></span>
<span><span class="co">#&gt; Input genes: 16</span></span>
<span><span class="co">#&gt;   Converted input genes: 16</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; Ignoring corThresh, automatically determine the value</span></span>
<span><span class="co">#&gt; threshold = 0.2</span></span>
<span><span class="co">#&gt; 5</span></span>
<span><span class="co">#&gt; Input genes: 88</span></span>
<span><span class="co">#&gt;   Converted input genes: 82</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; Ignoring corThresh, automatically determine the value</span></span>
<span><span class="co">#&gt; threshold = 0.201</span></span>
<span><span class="co">#&gt; 6</span></span>
<span><span class="co">#&gt; Input genes: 40</span></span>
<span><span class="co">#&gt;   Converted input genes: 39</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; Ignoring corThresh, automatically determine the value</span></span>
<span><span class="co">#&gt; threshold = 0.1</span></span>
<span><span class="co">#&gt; 7</span></span>
<span><span class="co">#&gt; Input genes: 9</span></span>
<span><span class="co">#&gt;   Converted input genes: 8</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; Ignoring corThresh, automatically determine the value</span></span>
<span><span class="co">#&gt; threshold = 0.273</span></span>
<span><span class="co">#&gt; 8</span></span>
<span><span class="co">#&gt; Input genes: 63</span></span>
<span><span class="co">#&gt;   Converted input genes: 52</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; Ignoring corThresh, automatically determine the value</span></span>
<span><span class="co">#&gt; threshold = 0.102</span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html">wrap_plots</a></span><span class="op">(</span><span class="va">texts</span>, nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/sc1_5-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>Word clouds can also be shown.</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">texts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/TextMarkers.html">TextMarkers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">markers</span>, <span class="va">markers</span><span class="op">$</span><span class="va">cluster</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"6"</span>,<span class="st">"8"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     type<span class="op">=</span><span class="st">"wc"</span>, pvalThresh<span class="op">=</span><span class="fl">1e-50</span>, genePlot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; 6</span></span>
<span><span class="co">#&gt; Input genes: 40</span></span>
<span><span class="co">#&gt;   Converted input genes: 39</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 8</span></span>
<span><span class="co">#&gt; Input genes: 63</span></span>
<span><span class="co">#&gt;   Converted input genes: 52</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html">wrap_plots</a></span><span class="op">(</span><span class="va">texts</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/sc2-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="findmarkers-in-scran" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> <code>findMarkers()</code> in <code>scran</code><a class="anchor" aria-label="anchor" href="#findmarkers-in-scran"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">SingleCellExperiment</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://bioconductor.org/packages/scater/">scater</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">scran</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/as.SingleCellExperiment.html">as.SingleCellExperiment</a></span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/colLabels.html">colLabels</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">$</span><span class="va">ident</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">$</span><span class="va">ident</span></span></code></pre></div>
<p>The function <code>TextMarkersScran</code> performs text fetching recursively for each cluster.</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">marker.info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scran/man/findMarkers.html">findMarkers</a></span><span class="op">(</span><span class="va">sce</span>, <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/colLabels.html">colLabels</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">texts</span> <span class="op">&lt;-</span> <span class="va">marker.info</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/TextMarkersScran.html">TextMarkersScran</a></span><span class="op">(</span>top<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; 0</span></span>
<span><span class="co">#&gt; Input genes: 28</span></span>
<span><span class="co">#&gt;   Converted input genes: 28</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 1</span></span>
<span><span class="co">#&gt; Input genes: 20</span></span>
<span><span class="co">#&gt;   Converted input genes: 20</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 2</span></span>
<span><span class="co">#&gt; Input genes: 27</span></span>
<span><span class="co">#&gt;   Converted input genes: 27</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 3</span></span>
<span><span class="co">#&gt; Input genes: 22</span></span>
<span><span class="co">#&gt;   Converted input genes: 22</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 4</span></span>
<span><span class="co">#&gt; Input genes: 19</span></span>
<span><span class="co">#&gt;   Converted input genes: 19</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 5</span></span>
<span><span class="co">#&gt; Input genes: 18</span></span>
<span><span class="co">#&gt;   Converted input genes: 16</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 6</span></span>
<span><span class="co">#&gt; Input genes: 20</span></span>
<span><span class="co">#&gt;   Converted input genes: 20</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 7</span></span>
<span><span class="co">#&gt; Input genes: 26</span></span>
<span><span class="co">#&gt;   Converted input genes: 25</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 8</span></span>
<span><span class="co">#&gt; Input genes: 21</span></span>
<span><span class="co">#&gt;   Converted input genes: 20</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="va">texts</span><span class="op">$</span><span class="va">`6`</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/sc3_5-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="map-resulting-wordcloud-plots-on-the-dimensionality-reducing-plot." class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> Map resulting wordcloud plots on the dimensionality reducing plot.<a class="anchor" aria-label="anchor" href="#map-resulting-wordcloud-plots-on-the-dimensionality-reducing-plot."><i class="fas fa-link"></i></a>
</h2>
<p>Single-cell level wordclouds can be plotted on the reduced dimension plot of cells.
The title in the wordcloud or network can be suppressed by <code>withTitle=FALSE</code> in <code>TextMarkers</code> functions.
A function is prepared to generate colors and show word cloud on the reduced dimension plot using the same color as the original plot (<code>plotReducedDimWithTexts</code>).
This function can use <code>use_shadowtext</code> in <code><a href="https://lepennec.github.io/ggwordcloud/reference/geom_text_wordcloud.html">ggwordcloud::geom_text_wordcloud</a></code>, which is available from the forked repository (<code>noriakis/ggwordcloud</code>).
<code>bg.colour</code> is used to specify background color. Otherwise, one can specify <a href="https://ggfx.data-imaginist.com/"><code>ggfx</code></a> filtering functions to <code>withggfx</code> and <code>ggfxParams</code> as parameters, which reflects to wordcloud.</p>
<p>For <code>SingleCellExperiment</code>,</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggfx.data-imaginist.com">ggfx</a></span><span class="op">)</span></span>
<span><span class="va">candLabel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span>,<span class="st">"6"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/plotReducedDimWithTexts.html">plotReducedDimWithTexts</a></span><span class="op">(</span><span class="va">sce</span>, <span class="va">marker.info</span>, colour_by<span class="op">=</span><span class="st">"label"</span>,point_alpha<span class="op">=</span><span class="fl">0.3</span>,</span>
<span>    use_shadowtext<span class="op">=</span><span class="cn">TRUE</span>, which.label<span class="op">=</span><span class="va">candLabel</span><span class="op">)</span></span>
<span><span class="co">#&gt; 0</span></span>
<span><span class="co">#&gt; Input genes: 28</span></span>
<span><span class="co">#&gt;   Converted input genes: 28</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 6</span></span>
<span><span class="co">#&gt; Input genes: 20</span></span>
<span><span class="co">#&gt;   Converted input genes: 20</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/formal-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## Change the bg.colour</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/plotReducedDimWithTexts.html">plotReducedDimWithTexts</a></span><span class="op">(</span><span class="va">sce</span>, <span class="va">marker.info</span>, colour_by<span class="op">=</span><span class="st">"label"</span>,point_alpha<span class="op">=</span><span class="fl">0.3</span>,</span>
<span>    use_shadowtext<span class="op">=</span><span class="cn">TRUE</span>, bg.colour<span class="op">=</span><span class="st">"tomato"</span>,</span>
<span>    which.label<span class="op">=</span><span class="va">candLabel</span><span class="op">)</span></span>
<span><span class="co">#&gt; 0</span></span>
<span><span class="co">#&gt; Input genes: 28</span></span>
<span><span class="co">#&gt;   Converted input genes: 28</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 6</span></span>
<span><span class="co">#&gt; Input genes: 20</span></span>
<span><span class="co">#&gt;   Converted input genes: 20</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/formal-2.png" width="100%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## Use `with_outer_glow`</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/plotReducedDimWithTexts.html">plotReducedDimWithTexts</a></span><span class="op">(</span><span class="va">sce</span>, <span class="va">marker.info</span>, colour_by<span class="op">=</span><span class="st">"label"</span>,point_alpha<span class="op">=</span><span class="fl">0.3</span>,</span>
<span>    use_shadowtext<span class="op">=</span><span class="cn">FALSE</span>, withggfx<span class="op">=</span><span class="st">"with_outer_glow"</span>,</span>
<span>    which.label<span class="op">=</span><span class="va">candLabel</span><span class="op">)</span></span>
<span><span class="co">#&gt; 0</span></span>
<span><span class="co">#&gt; Input genes: 28</span></span>
<span><span class="co">#&gt;   Converted input genes: 28</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 6</span></span>
<span><span class="co">#&gt; Input genes: 20</span></span>
<span><span class="co">#&gt;   Converted input genes: 20</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/formal-3.png" width="100%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## Use `with_outer_glow` with parameters</span></span>
<span><span class="co">## Should only be used for just the visualization purpose</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/plotReducedDimWithTexts.html">plotReducedDimWithTexts</a></span><span class="op">(</span><span class="va">sce</span>, <span class="va">marker.info</span>, colour_by<span class="op">=</span><span class="st">"label"</span>,point_alpha<span class="op">=</span><span class="fl">0.3</span>,</span>
<span>    use_shadowtext<span class="op">=</span><span class="cn">FALSE</span>, withggfx<span class="op">=</span><span class="st">"with_outer_glow"</span>, dimred<span class="op">=</span><span class="st">"TSNE"</span>,</span>
<span>    ggfxParams<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"white"</span>, expand<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    which.label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2"</span>,<span class="st">"3"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.line<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.position<span class="op">=</span><span class="st">"none"</span>,</span>
<span>        panel.background<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.border<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.grid.major<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.grid.minor<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        plot.background<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; 2</span></span>
<span><span class="co">#&gt; Input genes: 27</span></span>
<span><span class="co">#&gt;   Converted input genes: 27</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 3</span></span>
<span><span class="co">#&gt; Input genes: 22</span></span>
<span><span class="co">#&gt;   Converted input genes: 22</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/formal-4.png" width="100%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="co">## Change the font</span></span>
<span><span class="co">## Use alien encounter fonts (http://www.hipsthetic.com/alien-encounters-free-80s-font-family/)</span></span>
<span><span class="fu">sysfonts</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_add.html">font_add</a></span><span class="op">(</span>family<span class="op">=</span><span class="st">"alien"</span>,regular<span class="op">=</span><span class="st">"SFAlienEncounters.ttf"</span><span class="op">)</span></span>
<span><span class="fu">showtext</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/showtext/man/showtext_auto.html">showtext_auto</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/plotReducedDimWithTexts.html">plotReducedDimWithTexts</a></span><span class="op">(</span><span class="va">sce</span>, <span class="va">marker.info</span>, colour_by<span class="op">=</span><span class="st">"label"</span>,point_alpha<span class="op">=</span><span class="fl">0.3</span>,</span>
<span>                        use_shadowtext<span class="op">=</span><span class="cn">TRUE</span>, bg.colour<span class="op">=</span><span class="st">"white"</span>, args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>fontFamily<span class="op">=</span><span class="st">"alien"</span><span class="op">)</span>,</span>
<span>                        which.label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"6"</span><span class="op">)</span>, wcScale<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; 6</span></span>
<span><span class="co">#&gt; Input genes: 20</span></span>
<span><span class="co">#&gt;   Converted input genes: 20</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/formal-5.png" width="100%" style="display: block; margin: auto;"></div>
<p>For the <code>Seurat</code> object, use <code><a href="https://rdrr.io/pkg/biotextgraph/man/DimPlotWithTexts.html">DimPlotWithTexts()</a></code>.</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">markers</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">markers</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/DimPlotWithTexts.html">DimPlotWithTexts</a></span><span class="op">(</span><span class="va">pbmc</span>, <span class="va">markers</span>, label<span class="op">=</span><span class="cn">FALSE</span>, rad<span class="op">=</span><span class="va">r</span>, which.label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"4"</span><span class="op">)</span>, wcScale<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; 1</span></span>
<span><span class="co">#&gt; Input genes: 1027</span></span>
<span><span class="co">#&gt;   Converted input genes: 966</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 4</span></span>
<span><span class="co">#&gt; Input genes: 316</span></span>
<span><span class="co">#&gt;   Converted input genes: 298</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/formal2-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>Give the function a data frame that is already filtered, like thersholding by adjusted p-values.</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">markers</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">markers</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">thresh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">markers</span>, <span class="va">markers</span><span class="op">$</span><span class="va">p_val_adj</span><span class="op">&lt;</span><span class="fl">1e-50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/DimPlotWithTexts.html">DimPlotWithTexts</a></span><span class="op">(</span><span class="va">pbmc</span>,</span>
<span>    <span class="va">thresh</span>,</span>
<span>    label<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>    rad<span class="op">=</span><span class="va">r</span>,</span>
<span>    which.label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2"</span>,<span class="st">"4"</span>,<span class="st">"6"</span><span class="op">)</span>,</span>
<span>    args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>numWords<span class="op">=</span><span class="fl">50</span>,scaleFreq<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; 2</span></span>
<span><span class="co">#&gt; Input genes: 8</span></span>
<span><span class="co">#&gt;   Converted input genes: 8</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 4</span></span>
<span><span class="co">#&gt; Input genes: 16</span></span>
<span><span class="co">#&gt;   Converted input genes: 16</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 6</span></span>
<span><span class="co">#&gt; Input genes: 40</span></span>
<span><span class="co">#&gt;   Converted input genes: 39</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/formal3-1.png" width="100%" style="display: block; margin: auto;"></div>
<p><code>geom_sc_wordcloud</code> is prepared to use in conjuction with <code>ggsc</code>.</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ggsc/man/sc-dim-methods.html">sc_dim</a></span><span class="op">(</span><span class="va">pbmc</span>,reduction <span class="op">=</span> <span class="st">"pca"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/geom_sc_wordcloud.html">geom_sc_wordcloud</a></span><span class="op">(</span><span class="va">markers</span>, show_markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>                    p_val_adj_threshold <span class="op">=</span> <span class="fl">1e-50</span>, wcScale<span class="op">=</span><span class="fl">7</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggsc/man/sc-dim-geom-label.html">sc_dim_geom_label</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="fu">shadowtext</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/shadowtext/man/geom_shadowtext.html">geom_shadowtext</a></span>, </span>
<span>                  color<span class="op">=</span><span class="st">'black'</span>, bg.color<span class="op">=</span><span class="st">'white'</span><span class="op">)</span></span>
<span><span class="co">#&gt; 3</span></span>
<span><span class="co">#&gt; Input genes: 64</span></span>
<span><span class="co">#&gt;   Converted input genes: 60</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 5</span></span>
<span><span class="co">#&gt; Input genes: 88</span></span>
<span><span class="co">#&gt;   Converted input genes: 82</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/scp-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>Some positioning arguments are prepared.</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ggsc/man/sc-dim-methods.html">sc_dim</a></span><span class="op">(</span><span class="va">pbmc</span>,reduction <span class="op">=</span> <span class="st">"pca"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/geom_sc_wordcloud.html">geom_sc_wordcloud</a></span><span class="op">(</span><span class="va">markers</span>, show_markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">7</span><span class="op">)</span>,</span>
<span>    p_val_adj_threshold <span class="op">=</span> <span class="fl">1e-50</span>,</span>
<span>    wcScale<span class="op">=</span><span class="fl">7</span>,</span>
<span>    base_dens<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; 4</span></span>
<span><span class="co">#&gt; Input genes: 16</span></span>
<span><span class="co">#&gt;   Converted input genes: 16</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 7</span></span>
<span><span class="co">#&gt; Input genes: 9</span></span>
<span><span class="co">#&gt;   Converted input genes: 8</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/scp2-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="plotting-marker-gene-names-in-plot" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> Plotting marker gene names in plot<a class="anchor" aria-label="anchor" href="#plotting-marker-gene-names-in-plot"><i class="fas fa-link"></i></a>
</h2>
<p>You can plot gene names instead of gene description by specifying <code>gene_name=TRUE</code> in <code><a href="https://rdrr.io/pkg/biotextgraph/man/geom_sc_wordcloud.html">geom_sc_wordcloud()</a></code>. Number of genes can be controlled with <code>geneNum</code>. The genes in each cluster are ordered by <code>sortBy</code>, in decreasing order in default (<code>decreasing</code> option).</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ggsc/man/sc-dim-methods.html">sc_dim</a></span><span class="op">(</span><span class="va">pbmc</span>,reduction <span class="op">=</span> <span class="st">"pca"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/geom_sc_wordcloud.html">geom_sc_wordcloud</a></span><span class="op">(</span><span class="va">markers</span>, show_markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>        gene_name <span class="op">=</span> <span class="cn">TRUE</span>, wcScale<span class="op">=</span><span class="fl">7</span>,</span>
<span>        p_val_adj_threshold <span class="op">=</span> <span class="fl">1e-50</span>, base_dens <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/scp3-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggsc/man/sc-dim-methods.html">sc_dim</a></span><span class="op">(</span><span class="va">pbmc</span>,reduction <span class="op">=</span> <span class="st">"pca"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/geom_sc_wordcloud.html">geom_sc_wordcloud</a></span><span class="op">(</span><span class="va">markers</span>, show_markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>        gene_name <span class="op">=</span> <span class="cn">TRUE</span>, wcScale<span class="op">=</span><span class="fl">7</span>, use_shadowtext<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>        withggfx<span class="op">=</span><span class="st">"with_outer_glow"</span>, ggfxParams<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"white"</span>, expand<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span>,</span>
<span>        p_val_adj_threshold <span class="op">=</span> <span class="fl">1e-50</span>, base_dens <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/scp3-2.png" width="100%" style="display: block; margin: auto;"></div>
<p>Scaling color should be called before <code><a href="https://rdrr.io/pkg/biotextgraph/man/geom_sc_wordcloud.html">geom_sc_wordcloud()</a></code>.</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ggsc/man/sc-dim-methods.html">sc_dim</a></span><span class="op">(</span><span class="va">pbmc</span>,reduction <span class="op">=</span> <span class="st">"pca"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">9</span>, <span class="st">"PuOr"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/geom_sc_wordcloud.html">geom_sc_wordcloud</a></span><span class="op">(</span><span class="va">markers</span>, show_markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>        gene_name <span class="op">=</span> <span class="cn">TRUE</span>, wcScale<span class="op">=</span><span class="fl">7</span>,</span>
<span>        p_val_adj_threshold <span class="op">=</span> <span class="fl">1e-50</span>, base_dens <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/scp4-1.png" width="100%" style="display: block; margin: auto;"></div>
<div id="plotting-the-enrichment-analysis-results-of-marker-genes" class="section level3" number="8.4.1">
<h3>
<span class="header-section-number">8.4.1</span> Plotting the enrichment analysis results of marker genes<a class="anchor" aria-label="anchor" href="#plotting-the-enrichment-analysis-results-of-marker-genes"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">markers</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">markers</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Enrichment analysis</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/DimPlotWithTexts.html">DimPlotWithTexts</a></span><span class="op">(</span><span class="va">pbmc</span>, <span class="va">thresh</span>, label<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>    point_alpha <span class="op">=</span> <span class="fl">0.8</span>,which.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>,</span>
<span>    args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>enrich<span class="op">=</span><span class="st">"kegg"</span>, scaleFreq<span class="op">=</span><span class="fl">10</span>, numWords<span class="op">=</span><span class="fl">50</span><span class="op">)</span>,</span>
<span>    reduction <span class="op">=</span> <span class="st">"pca"</span>, base_dens<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>    wcScale<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="co">#&gt; 0</span></span>
<span><span class="co">#&gt; Input genes: 75</span></span>
<span><span class="co">#&gt;   Converted input genes: 75</span></span>
<span><span class="co">#&gt; Performing enrichment analysis</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; 6</span></span>
<span><span class="co">#&gt; Input genes: 40</span></span>
<span><span class="co">#&gt;   Converted input genes: 39</span></span>
<span><span class="co">#&gt; Performing enrichment analysis</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-sc_files/figure-html/formal4-1.png" width="100%" style="display: block; margin: auto;"></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="quantitative-analysis.html"><span class="header-section-number">7</span> Quantitative analysis</a></div>
<div class="next"><a href="app.html"><span class="header-section-number">9</span> Application examples</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#single-cell-transcriptomic-data"><span class="header-section-number">8</span> Single-cell transcriptomic data</a></li>
<li><a class="nav-link" href="#visualizing-textual-information-for-marker-genes"><span class="header-section-number">8.1</span> Visualizing textual information for marker genes</a></li>
<li><a class="nav-link" href="#findmarkers-in-scran"><span class="header-section-number">8.2</span> findMarkers() in scran</a></li>
<li><a class="nav-link" href="#map-resulting-wordcloud-plots-on-the-dimensionality-reducing-plot."><span class="header-section-number">8.3</span> Map resulting wordcloud plots on the dimensionality reducing plot.</a></li>
<li>
<a class="nav-link" href="#plotting-marker-gene-names-in-plot"><span class="header-section-number">8.4</span> Plotting marker gene names in plot</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#plotting-the-enrichment-analysis-results-of-marker-genes"><span class="header-section-number">8.4.1</span> Plotting the enrichment analysis results of marker genes</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>biotextgraph</strong>" was written by Noriaki Sato. It was last built on 2024-02-01.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
