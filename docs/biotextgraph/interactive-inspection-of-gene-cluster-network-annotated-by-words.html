<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5 Interactive inspection of gene cluster network annotated by words | biotextgraph</title>
<meta name="author" content="Noriaki Sato">
<meta name="generator" content="bookdown 0.36 with bs4_book()">
<meta property="og:title" content="Chapter 5 Interactive inspection of gene cluster network annotated by words | biotextgraph">
<meta property="og:type" content="book">
<meta property="og:url" content="https://noriakis.github.io/software/biotextgraph/interactive-inspection-of-gene-cluster-network-annotated-by-words.html">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 5 Interactive inspection of gene cluster network annotated by words | biotextgraph">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-9FXY6YW4YZ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-9FXY6YW4YZ');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="library(biotextgraph) library(ggplot2) library(ggraph) library(org.Hs.eg.db) library(clusterProfiler) library(RColorBrewer) In this example, a Bayesian network showing the module eigengenes...">
<meta property="og:description" content="library(biotextgraph) library(ggplot2) library(ggraph) library(org.Hs.eg.db) library(clusterProfiler) library(RColorBrewer) In this example, a Bayesian network showing the module eigengenes...">
<meta name="twitter:description" content="library(biotextgraph) library(ggplot2) library(ggraph) library(org.Hs.eg.db) library(clusterProfiler) library(RColorBrewer) In this example, a Bayesian network showing the module eigengenes...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">biotextgraph</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> About</a></li>
<li><a class="" href="basic-usage.html"><span class="header-section-number">2</span> Basic usage</a></li>
<li><a class="" href="metacyc.html"><span class="header-section-number">3</span> Microbial functional analysis</a></li>
<li><a class="" href="the-other-usage-for-microbiome-related-data.html"><span class="header-section-number">4</span> The other usage for microbiome-related data</a></li>
<li><a class="active" href="interactive-inspection-of-gene-cluster-network-annotated-by-words.html"><span class="header-section-number">5</span> Interactive inspection of gene cluster network annotated by words</a></li>
<li><a class="" href="annotating-gene-cluster-dendrogram.html"><span class="header-section-number">6</span> Annotating gene cluster dendrogram</a></li>
<li><a class="" href="quantitative-analysis.html"><span class="header-section-number">7</span> Quantitative analysis</a></li>
<li><a class="" href="single-cell-transcriptomic-data.html"><span class="header-section-number">8</span> Single-cell transcriptomic data</a></li>
<li><a class="" href="app.html"><span class="header-section-number">9</span> Application examples</a></li>
<li><a class="" href="parsing.html"><span class="header-section-number">10</span> Parsing</a></li>
<li><a class="" href="tidy.html"><span class="header-section-number">11</span> Perform each process separately</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="interactive-inspection-of-gene-cluster-network-annotated-by-words" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Interactive inspection of gene cluster network annotated by words<a class="anchor" aria-label="anchor" href="#interactive-inspection-of-gene-cluster-network-annotated-by-words"><i class="fas fa-link"></i></a>
</h1>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">biotextgraph</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com">ggraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/biomedical-knowledge-mining-book/">clusterProfiler</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span></code></pre></div>
<p>In this example, a Bayesian network showing the module eigengenes relationship are inferred using <code>boot.strength</code> function in <code>bnlearn</code> from the weighted gene correlation network analysis (WGCNA) results. The modules are annotated by word clouds produced by <code><a href="https://rdrr.io/pkg/biotextgraph/man/refseq.html">refseq()</a></code>, and can be exported to the format of <code>Cytoscape.js</code> or <code>vis.js</code>. In this way, module relationship can be interactively inspected with the functional implications. The other functions like <code><a href="https://rdrr.io/pkg/biotextgraph/man/pubmed.html">pubmed()</a></code> can be used, however, you shold specify API keys for the function makes multiple queries.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## In this example, we simulate WGCNA results.</span></span>
<span><span class="co">## you can just use results from WGCNA.</span></span>
<span><span class="co">## Assuming WGCNA results are stored in `mod`</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">biotextgraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/returnExample.html">returnExample</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">MEs</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">MEs</span></span>
<span><span class="va">modColors</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">colors</span></span>
<span><span class="va">ensg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">modColors</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># library(bnlearn)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/">igraph</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Replace like boot.strength(mod$MEs, R=500, algorithm = "hc")</span></span>
<span><span class="co"># dag &lt;- model2network("[ME1][ME2|ME1]") # If using bnlearn</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_literal.html">graph_from_literal</a></span><span class="op">(</span> <span class="va">ME1</span><span class="op">-</span><span class="op">+</span><span class="va">ME2</span>, <span class="va">ME1</span><span class="op">-</span><span class="op">+</span><span class="va">ME3</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">## Convert to igraph</span></span>
<span><span class="co"># g &lt;- as.igraph(dag)</span></span>
<span></span>
<span><span class="co">## Assign edge attributes</span></span>
<span><span class="co">## Skip, if you perform boot.strength, the edge attributes can be added from the result</span></span>
<span><span class="co"># el &lt;- data.frame(as_edgelist(g))</span></span>
<span><span class="co"># colnames(el) &lt;- c("from","to")</span></span>
<span><span class="co"># el &lt;- left_join(el, bs)</span></span>
<span><span class="co"># E(g)$strength &lt;- el$strength</span></span>
<span><span class="co"># E(g)$direction &lt;- el$direction</span></span>
<span></span>
<span><span class="co">## Node attributes</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">stripName</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"ME"</span>,<span class="st">""</span>,<span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="va">sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">modColors</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">sizes</span><span class="op">[</span><span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">stripName</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Directory to save images and a script</span></span>
<span><span class="va">rootDir</span> <span class="op">&lt;-</span> <span class="st">"./"</span></span>
<span><span class="va">netDir</span> <span class="op">&lt;-</span> <span class="st">"visCyjs"</span></span>
<span><span class="va">imageDir</span> <span class="op">&lt;-</span> <span class="st">"images"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">rootDir</span>, <span class="st">"/"</span>, <span class="va">netDir</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">rootDir</span>, <span class="va">netDir</span>, <span class="st">"/"</span>, <span class="va">imageDir</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">images</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">plotType</span> <span class="op">&lt;-</span> <span class="st">"bar"</span></span>
<span><span class="va">numLim</span> <span class="op">&lt;-</span> <span class="fl">200</span> <span class="co"># limit for gene number</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span>    <span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"ME"</span>,<span class="st">""</span>,<span class="va">i</span><span class="op">)</span><span class="op">)</span> <span class="co"># strip ME</span></span>
<span></span>
<span>    <span class="va">queries</span> <span class="op">&lt;-</span> <span class="va">ensg</span><span class="op">[</span><span class="va">modColors</span><span class="op">==</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">queries</span><span class="op">)</span><span class="op">&gt;</span><span class="va">numLim</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/warning.html">warning</a></span><span class="op">(</span><span class="st">"Sampling random genes"</span><span class="op">)</span></span>
<span>        <span class="va">queries</span> <span class="op">&lt;-</span> <span class="va">queries</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-envirAPI.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">queries</span><span class="op">)</span>, <span class="va">numLim</span><span class="op">)</span><span class="op">]</span> <span class="co">## Temporary restrict to randomly chosen genes, should be replaced to like kME values</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co">## Convert to ENTREZ</span></span>
<span>    <span class="va">entre</span> <span class="op">&lt;-</span> <span class="fu">AnnotationDbi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html">select</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span>, keytype<span class="op">=</span><span class="st">"ENSEMBL"</span>,</span>
<span>        keys <span class="op">=</span> <span class="va">queries</span>, columns <span class="op">=</span> <span class="st">"ENTREZID"</span><span class="op">)</span><span class="op">$</span><span class="va">ENTREZID</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">plotType</span><span class="op">==</span><span class="st">"bar"</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">plt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/makeBar.html">makeBar</a></span><span class="op">(</span><span class="va">entre</span>, keyType<span class="op">=</span><span class="st">"ENTREZID"</span><span class="op">)</span> <span class="co"># get barplot</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span> <span class="co">## If wordcloud</span></span>
<span>        <span class="co"># A &lt;- refseq(entre, keyType="ENTREZID",</span></span>
<span>        <span class="co">#                    argList=list(rot.per=0.4,</span></span>
<span>        <span class="co">#                                 colors=brewer.pal(10,</span></span>
<span>        <span class="co">#                                                   sample(row.names(RColorBrewer::brewer.pal.info), 1)),</span></span>
<span>        <span class="co">#                                 random.order=FALSE),</span></span>
<span>        <span class="co">#                    numWords=80)</span></span>
<span>        <span class="co"># # plt &lt;- plotWC(A)</span></span>
<span>        <span class="co"># # </span></span>
<span>        <span class="co"># # ## This time use ggwordcloud()</span></span>
<span>        <span class="co"># plt &lt;- ggwordcloud::ggwordcloud(getSlot(A, "freqDf")$word, getSlot(A, "freqDf")$freq,</span></span>
<span>        <span class="co">#                      shape="circle", min.freq = 1,max.words = Inf,</span></span>
<span>        <span class="co">#                      rot.per = 0.5, random.order = FALSE,</span></span>
<span>        <span class="co">#                      colors = brewer.pal(10,</span></span>
<span>        <span class="co">#                                          sample(row.names(RColorBrewer::brewer.pal.info), 1)))+</span></span>
<span>        <span class="co">#          scale_size_area(max_size = 40)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="co">## Save images</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">rootDir</span>, <span class="va">netDir</span>, <span class="st">"/"</span>, <span class="va">imageDir</span>, <span class="st">"/"</span>, <span class="va">i</span> ,<span class="st">".png"</span><span class="op">)</span>,</span>
<span>           <span class="va">plt</span>, dpi<span class="op">=</span><span class="fl">300</span>, width<span class="op">=</span><span class="fl">10</span>, height<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span>    <span class="co">## Store image dir</span></span>
<span>    <span class="va">images</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">images</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">imageDir</span>, <span class="st">"/"</span>, <span class="va">i</span> ,<span class="st">".png"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "ME1"</span></span>
<span><span class="co">#&gt; Input genes: 12</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; [1] "ME2"</span></span>
<span><span class="co">#&gt; Input genes: 13</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; [1] "ME3"</span></span>
<span><span class="co">#&gt; Input genes: 7</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">image</span> <span class="op">&lt;-</span> <span class="va">images</span></span>
<span></span>
<span><span class="co">## Node shape</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">plotType</span><span class="op">==</span><span class="st">"bar"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"rectangle"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"circle"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Scale the node size</span></span>
<span><span class="va">sizeMin</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">sizeMax</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">rawMin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">size</span><span class="op">)</span></span>
<span><span class="va">rawMax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">size</span><span class="op">)</span></span>
<span><span class="va">scf</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">sizeMax</span><span class="op">-</span><span class="va">sizeMin</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">rawMax</span><span class="op">-</span><span class="va">rawMin</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="va">scf</span> <span class="op">*</span> <span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">size</span> <span class="op">+</span> <span class="va">sizeMin</span> <span class="op">-</span> <span class="va">scf</span> <span class="op">*</span> <span class="va">rawMin</span></span>
<span></span>
<span><span class="co">## Export</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/exportCyjs.html">exportCyjs</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">rootDir</span>, <span class="va">netDir</span><span class="op">)</span></span>
<span><span class="co"># or, exportVisjs(g, rootDir, netDir)</span></span></code></pre></div>
<p>Use like <code>http-server</code> in the directory containing a exported JavaScript, and interactively inspect the module relationship with word information. The example visualization is shown below (not by the code above, but Bayesian network of module eigenes inferred from RNA-seq dataset ofbladder cancer).</p>
<div class="float">
<img src="https://github.com/noriakis/software/blob/main/images/wcbn.png?raw=true" style="width:50.0%" alt="Example visualization of a Bayesian network"><div class="figcaption">Example visualization of a Bayesian network</div>
</div>
<p>Interactive inspection is possible using GitHub pages or the other hosting services like below.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_url.html">include_url</a></span><span class="op">(</span><span class="st">"https://noriakis.github.io/cyjs_test/wordcloud"</span><span class="op">)</span></span></code></pre></div>
<iframe src="https://noriakis.github.io/cyjs_test/wordcloud" width="100%" height="400px" data-external="1" style="border: none;">
</iframe>
<p>If you specify node attribute named <code>group</code>, and set <code>bubble=TRUE</code> in <code>exportCyjs</code> function, bubble sets will be plotted using <a href="https://github.com/upsetjs/cytoscape.js-bubblesets"><code>cytoscape.js-bubblesets</code></a>, useful for inspecting the similarity betwteen the gene cluster, like the output of <code>pvclust</code> and <code>pvpick</code> on module eigengenes.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="co"># exportCyjs(g, rootDir, netDir, bubble=TRUE)</span></span>
<span></span>
<span><span class="co">## Example, not by the code above.</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_url.html">include_url</a></span><span class="op">(</span><span class="st">"https://noriakis.github.io/cyjs_test/wordcloud_bubble"</span><span class="op">)</span></span></code></pre></div>
<iframe src="https://noriakis.github.io/cyjs_test/wordcloud_bubble" width="100%" height="400px" data-external="1" style="border: none;">
</iframe>
<p><code>vis.js</code> can be used, by exporting function <code>exportVisjs</code>.
In this example, the barplot of words are shown in the nodes.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_url.html">include_url</a></span><span class="op">(</span><span class="st">"https://noriakis.github.io/cyjs_test/visjs"</span><span class="op">)</span></span></code></pre></div>
<iframe src="https://noriakis.github.io/cyjs_test/visjs" width="100%" height="400px" data-external="1" style="border: none;">
</iframe>
<div id="wrapper-function-for-wordcloud-network" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Wrapper function for wordcloud network<a class="anchor" aria-label="anchor" href="#wrapper-function-for-wordcloud-network"><i class="fas fa-link"></i></a>
</h2>
<p>The network like the previous example can be conveniently exported using <code>exportWCNetwork</code> function, which wrapped the previous code. The input is <code>igraph</code> and named gene list.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">biotextgraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/returnExample.html">returnExample</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'select()' returned 1:many mapping between keys and</span></span>
<span><span class="co">#&gt; columns</span></span>
<span><span class="co">#&gt; 'select()' returned 1:1 mapping between keys and</span></span>
<span><span class="co">#&gt; columns</span></span>
<span><span class="co">#&gt; 'select()' returned 1:1 mapping between keys and</span></span>
<span><span class="co">#&gt; columns</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_literal.html">graph_from_literal</a></span><span class="op">(</span> <span class="va">ME1</span><span class="op">-</span><span class="op">+</span><span class="va">ME2</span>, <span class="va">ME1</span><span class="op">-</span><span class="op">+</span><span class="va">ME3</span> <span class="op">)</span></span>
<span><span class="va">geneList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"ME1"</span><span class="op">=</span><span class="va">mod</span><span class="op">$</span><span class="va">colors</span><span class="op">[</span><span class="va">mod</span><span class="op">$</span><span class="va">colors</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>     <span class="st">"ME2"</span><span class="op">=</span><span class="va">mod</span><span class="op">$</span><span class="va">colors</span><span class="op">[</span><span class="va">mod</span><span class="op">$</span><span class="va">colors</span><span class="op">==</span><span class="fl">2</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>     <span class="st">"ME3"</span><span class="op">=</span><span class="va">mod</span><span class="op">$</span><span class="va">colors</span><span class="op">[</span><span class="va">mod</span><span class="op">$</span><span class="va">colors</span><span class="op">==</span><span class="fl">3</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">g</span></span>
<span><span class="co">#&gt; IGRAPH 91c1169 DN-- 3 2 -- </span></span>
<span><span class="co">#&gt; + attr: name (v/c)</span></span>
<span><span class="co">#&gt; + edges from 91c1169 (vertex names):</span></span>
<span><span class="co">#&gt; [1] ME1-&gt;ME2 ME1-&gt;ME3</span></span>
<span><span class="va">geneList</span></span>
<span><span class="co">#&gt; $ME1</span></span>
<span><span class="co">#&gt;  [1] "ENSG00000108702" "ENSG00000108691" "ENSG00000277632"</span></span>
<span><span class="co">#&gt;  [4] "ENSG00000278567" "ENSG00000274221" "ENSG00000275302"</span></span>
<span><span class="co">#&gt;  [7] "ENSG00000277943" "ENSG00000275824" "ENSG00000271503"</span></span>
<span><span class="co">#&gt; [10] "ENSG00000274233" "ENSG00000108688" "ENSG00000108700"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ME2</span></span>
<span><span class="co">#&gt;  [1] "ENSG00000163739" "ENSG00000081041" "ENSG00000163734"</span></span>
<span><span class="co">#&gt;  [4] "ENSG00000163735" "ENSG00000124875" "ENSG00000169429"</span></span>
<span><span class="co">#&gt;  [7] "ENSG00000138755" "ENSG00000169245" "ENSG00000169248"</span></span>
<span><span class="co">#&gt; [10] "ENSG00000107562" "ENSG00000156234" "ENSG00000145824"</span></span>
<span><span class="co">#&gt; [13] "ENSG00000161921"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ME3</span></span>
<span><span class="co">#&gt; [1] "ENSG00000012061" "ENSG00000104884" "ENSG00000163161"</span></span>
<span><span class="co">#&gt; [4] "ENSG00000175595" "ENSG00000134899" "ENSG00000225830"</span></span>
<span><span class="co">#&gt; [7] "ENSG00000049167"</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/biotextgraph/man/exportWCNetwork.html">exportWCNetwork</a></span><span class="op">(</span><span class="va">g</span>,<span class="va">geneList</span>,keyType<span class="op">=</span><span class="st">"ENSEMBL"</span>,</span>
<span>    wcScale<span class="op">=</span><span class="fl">50</span>,scaleMax<span class="op">=</span><span class="fl">20</span>,scaleMin<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in brewer.pal(10, sample(row.names(RColorBrewer::brewer.pal.info), : n too large, allowed maximum for palette YlGnBu is 9</span></span>
<span><span class="co">#&gt; Returning the palette you asked for with that many colors</span></span>
<span><span class="co">#&gt; Warning in dir.create(paste0(dir)): 'network'</span></span>
<span><span class="co">#&gt; はすでに存在します</span></span>
<span><span class="co">#&gt; Warning in dir.create(paste0(dir, "/images")):</span></span>
<span><span class="co">#&gt; 'network/images' はすでに存在します</span></span>
<span><span class="co">#&gt; Input genes: 12</span></span>
<span><span class="co">#&gt; 'select()' returned 1:1 mapping between keys and</span></span>
<span><span class="co">#&gt; columns</span></span>
<span><span class="co">#&gt;   Converted input genes: 7</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; Scale for size is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for size, which will replace the</span></span>
<span><span class="co">#&gt; existing scale.</span></span>
<span><span class="co">#&gt; Warning in wordcloud_boxes(data_points =</span></span>
<span><span class="co">#&gt; points_valid_first, boxes = boxes, : Some words could not</span></span>
<span><span class="co">#&gt; fit on page. They have been removed.</span></span>
<span><span class="co">#&gt; Input genes: 13</span></span>
<span><span class="co">#&gt; 'select()' returned 1:1 mapping between keys and</span></span>
<span><span class="co">#&gt; columns</span></span>
<span><span class="co">#&gt;   Converted input genes: 13</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; Scale for size is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for size, which will replace the</span></span>
<span><span class="co">#&gt; existing scale.</span></span>
<span><span class="co">#&gt; Warning in wordcloud_boxes(data_points =</span></span>
<span><span class="co">#&gt; points_valid_first, boxes = boxes, : Some words could not</span></span>
<span><span class="co">#&gt; fit on page. They have been removed.</span></span>
<span><span class="co">#&gt; Input genes: 7</span></span>
<span><span class="co">#&gt; 'select()' returned 1:1 mapping between keys and</span></span>
<span><span class="co">#&gt; columns</span></span>
<span><span class="co">#&gt;   Converted input genes: 7</span></span>
<span><span class="co">#&gt; Filter based on GeneSummary</span></span>
<span><span class="co">#&gt; Filtered 77 words (frequency and/or tfidf)</span></span>
<span><span class="co">#&gt; Scale for size is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for size, which will replace the</span></span>
<span><span class="co">#&gt; existing scale.</span></span></code></pre></div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="the-other-usage-for-microbiome-related-data.html"><span class="header-section-number">4</span> The other usage for microbiome-related data</a></div>
<div class="next"><a href="annotating-gene-cluster-dendrogram.html"><span class="header-section-number">6</span> Annotating gene cluster dendrogram</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#interactive-inspection-of-gene-cluster-network-annotated-by-words"><span class="header-section-number">5</span> Interactive inspection of gene cluster network annotated by words</a></li>
<li><a class="nav-link" href="#wrapper-function-for-wordcloud-network"><span class="header-section-number">5.1</span> Wrapper function for wordcloud network</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>biotextgraph</strong>" was written by Noriaki Sato. It was last built on 2023-12-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
