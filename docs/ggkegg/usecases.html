<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5 Usecases | ggkegg</title>
<meta name="author" content="Noriaki Sato">
<meta name="generator" content="bookdown 0.33 with bs4_book()">
<meta property="og:title" content="Chapter 5 Usecases | ggkegg">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 5 Usecases | ggkegg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="5.1 Visualizing numerical attributes from DESeq2 By providing the results of the DESeq2 package, which is often used for transcriptome analysis, it is possible to reflect numerical results in the...">
<meta property="og:description" content="5.1 Visualizing numerical attributes from DESeq2 By providing the results of the DESeq2 package, which is often used for transcriptome analysis, it is possible to reflect numerical results in the...">
<meta name="twitter:description" content="5.1 Visualizing numerical attributes from DESeq2 By providing the results of the DESeq2 package, which is often used for transcriptome analysis, it is possible to reflect numerical results in the...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">ggkegg</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> About</a></li>
<li><a class="" href="pathway.html"><span class="header-section-number">2</span> Pathway</a></li>
<li><a class="" href="module.html"><span class="header-section-number">3</span> Module</a></li>
<li><a class="" href="network.html"><span class="header-section-number">4</span> Network</a></li>
<li><a class="active" href="usecases.html"><span class="header-section-number">5</span> Usecases</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="usecases" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Usecases<a class="anchor" aria-label="anchor" href="#usecases"><i class="fas fa-link"></i></a>
</h1>
<div id="visualizing-numerical-attributes-from-deseq2" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Visualizing numerical attributes from DESeq2<a class="anchor" aria-label="anchor" href="#visualizing-numerical-attributes-from-deseq2"><i class="fas fa-link"></i></a>
</h2>
<p>By providing the results of the DESeq2 package, which is often used for transcriptome analysis, it is possible to reflect numerical results in the nodes of a graph. The <code>assign_deseq2</code> function can be used for this purpose. By specifying the numerical value (e.g., <code>log2FoldChange</code>) that you want to reflect in the graph as the <code>column</code> argument, you can assign the value to the nodes. If multiple genes are hit, the <code>numeric_combine</code> argument specifies how to combine multiple values (the default is <code>mean</code>).</p>
<p>Here, we use a RNA-Seq dataset that analyzed the transcriptome changes in human urothelial cells infected with BK polyomavirus (<a href="https://doi.org/10.1038/s41388-022-02235-8">Baker et al.Â 2022</a>). The raw sequences obtained from Sequence Read Archive is processed by <a href="https://nf-co.re/rnaseq">nf-core</a>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ggkegg</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mikelove/DESeq2">DESeq2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"uro.deseq.res.rda"</span><span class="op">)</span> <span class="co">## Storing DESeq() result</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#&gt; class: DESeqDataSet </span></span>
<span><span class="co">#&gt; dim: 29744 26 </span></span>
<span><span class="co">#&gt; metadata(1): version</span></span>
<span><span class="co">#&gt; assays(8): counts avgTxLength ... replaceCounts</span></span>
<span><span class="co">#&gt;   replaceCooks</span></span>
<span><span class="co">#&gt; rownames(29744): A1BG A1BG-AS1 ... ZZEF1 ZZZ3</span></span>
<span><span class="co">#&gt; rowData names(27): baseMean baseVar ... maxCooks</span></span>
<span><span class="co">#&gt;   replace</span></span>
<span><span class="co">#&gt; colnames(26): SRR14509882 SRR14509883 ... SRR14509906</span></span>
<span><span class="co">#&gt;   SRR14509907</span></span>
<span><span class="co">#&gt; colData names(27): Assay.Type AvgSpotLen ...</span></span>
<span><span class="co">#&gt;   viral_infection replaceable</span></span>
<span><span class="va">vinf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/results.html">results</a></span><span class="op">(</span><span class="va">res</span>, contrast<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"viral_infection"</span>,<span class="st">"BKPyV (Dunlop) MOI=1"</span>,<span class="st">"No infection"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## LFC</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/pathway.html">pathway</a></span><span class="op">(</span><span class="st">"hsa04110"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>deseq2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/assign_deseq2.html">assign_deseq2</a></span><span class="op">(</span><span class="va">vinf</span><span class="op">)</span>,</span>
<span>                                   padj<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/assign_deseq2.html">assign_deseq2</a></span><span class="op">(</span><span class="va">vinf</span>, column<span class="op">=</span><span class="st">"padj"</span><span class="op">)</span>,</span>
<span>                                   converted_name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/convert_id.html">convert_id</a></span><span class="op">(</span><span class="st">"hsa"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">g</span>, layout<span class="op">=</span><span class="st">"manual"</span>, x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.5</span>, arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">'mm'</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                 start_cap <span class="op">=</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geometry.html">square</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">'cm'</span><span class="op">)</span>,</span>
<span>                 end_cap <span class="op">=</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geometry.html">square</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="st">'cm'</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">subtype</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_node_rect</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">deseq2</span>, filter<span class="op">=</span><span class="va">type</span><span class="op">==</span><span class="st">"gene"</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggfx</span><span class="fu">::</span><span class="fu"><a href="https://ggfx.data-imaginist.com/reference/with_outer_glow.html">with_outer_glow</a></span><span class="op">(</span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_text.html">geom_node_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">converted_name</span>, filter<span class="op">=</span><span class="va">type</span><span class="op">!=</span><span class="st">"group"</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span>, colour<span class="op">=</span><span class="st">"white"</span>, expand<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low<span class="op">=</span><span class="st">"blue"</span>,high<span class="op">=</span><span class="st">"red"</span>, name<span class="op">=</span><span class="st">"LFC"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-usecases_files/figure-html/deseq2-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## Adjusted p-values</span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">g</span>, layout<span class="op">=</span><span class="st">"manual"</span>, x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.5</span>, arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">'mm'</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                 start_cap <span class="op">=</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geometry.html">square</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">'cm'</span><span class="op">)</span>,</span>
<span>                 end_cap <span class="op">=</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geometry.html">square</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="st">'cm'</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">subtype</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_node_rect</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">padj</span>, filter<span class="op">=</span><span class="va">type</span><span class="op">==</span><span class="st">"gene"</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggfx</span><span class="fu">::</span><span class="fu"><a href="https://ggfx.data-imaginist.com/reference/with_outer_glow.html">with_outer_glow</a></span><span class="op">(</span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_text.html">geom_node_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">converted_name</span>, filter<span class="op">=</span><span class="va">type</span><span class="op">!=</span><span class="st">"group"</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span>, colour<span class="op">=</span><span class="st">"white"</span>, expand<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"padj"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-usecases_files/figure-html/deseq2-2.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="integrating-matrix-to-tbl_graph" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Integrating matrix to <code>tbl_graph</code><a class="anchor" aria-label="anchor" href="#integrating-matrix-to-tbl_graph"><i class="fas fa-link"></i></a>
</h2>
<p>If you want to reflect an expression matrix in a graph, the <code>append_edge_value</code> and <code>append_node_value</code> functions can be useful. By specifying a matrix and gene IDs, you can assign numeric values for each sample to the <code>tbl_graph</code>. <code>append_edge_value</code> assigns the sum of the two nodes connected by an edge, ignoring group nodes (<a href="https://doi.org/10.1186/s12859-020-03692-2">Adnan et al.Â 2020</a>).</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/vst.html">vst</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">new_g</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/append_edge_value.html">append_edge_value</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/append_node_value.html">append_node_value</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span><span class="va">new_g</span></span>
<span><span class="co">#&gt; # A tbl_graph: 134 nodes and 157 edges</span></span>
<span><span class="co">#&gt; #</span></span>
<span><span class="co">#&gt; # A directed acyclic multigraph with 40 components</span></span>
<span><span class="co">#&gt; #</span></span>
<span><span class="co">#&gt; # Node Data: 134 Ã 47 (active)</span></span>
<span><span class="co">#&gt;   name  type  reactiâ¦ graphiâ¦     x     y width height</span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 hsa:â¦ gene  &lt;NA&gt;    CDKN2Aâ¦   532  -218    46     17</span></span>
<span><span class="co">#&gt; 2 hsa:â¦ gene  &lt;NA&gt;    FZR1, â¦   981  -630    46     17</span></span>
<span><span class="co">#&gt; 3 hsa:â¦ gene  &lt;NA&gt;    MCM2, â¦   553  -681    46     17</span></span>
<span><span class="co">#&gt; 4 hsa:â¦ gene  &lt;NA&gt;    ORC6, â¦   494  -681    46     17</span></span>
<span><span class="co">#&gt; 5 hsa:â¦ gene  &lt;NA&gt;    ANAPC1â¦   981  -392    46     17</span></span>
<span><span class="co">#&gt; 6 hsa:â¦ gene  &lt;NA&gt;    ANAPC1â¦   981  -613    46     17</span></span>
<span><span class="co">#&gt; # â¦ with 128 more rows, and 39 more variables:</span></span>
<span><span class="co">#&gt; #   fgcolor &lt;chr&gt;, bgcolor &lt;chr&gt;, graphics_type &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   coords &lt;chr&gt;, xmin &lt;dbl&gt;, xmax &lt;dbl&gt;, ymin &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   ymax &lt;dbl&gt;, orig.id &lt;chr&gt;, pathway_id &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   deseq2 &lt;dbl&gt;, padj &lt;dbl&gt;, converted_name &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509882 &lt;dbl&gt;, SRR14509883 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509884 &lt;dbl&gt;, SRR14509885 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509886 &lt;dbl&gt;, SRR14509887 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509888 &lt;dbl&gt;, SRR14509889 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509890 &lt;dbl&gt;, SRR14509891 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509892 &lt;dbl&gt;, SRR14509893 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509894 &lt;dbl&gt;, SRR14509895 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509896 &lt;dbl&gt;, SRR14509897 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509898 &lt;dbl&gt;, SRR14509899 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509900 &lt;dbl&gt;, SRR14509901 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509902 &lt;dbl&gt;, SRR14509903 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509904 &lt;dbl&gt;, SRR14509905 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509906 &lt;dbl&gt;, SRR14509907 &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; #</span></span>
<span><span class="co">#&gt; # Edge Data: 157 Ã 32</span></span>
<span><span class="co">#&gt;    from    to type  subtype from_nd to_nd SRR145â¦ SRR145â¦</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1   118    39 GErel expresâ¦ undefiâ¦ hsa:â¦    NA      NA  </span></span>
<span><span class="co">#&gt; 2    50    61 PPrel inhibiâ¦ hsa:29â¦ hsa:â¦    24.4    23.5</span></span>
<span><span class="co">#&gt; 3    50    61 PPrel phosphâ¦ hsa:29â¦ hsa:â¦    24.4    23.5</span></span>
<span><span class="co">#&gt; # â¦ with 154 more rows, and 24 more variables:</span></span>
<span><span class="co">#&gt; #   SRR14509884 &lt;dbl&gt;, SRR14509885 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509886 &lt;dbl&gt;, SRR14509887 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509888 &lt;dbl&gt;, SRR14509889 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509890 &lt;dbl&gt;, SRR14509891 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509892 &lt;dbl&gt;, SRR14509893 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509894 &lt;dbl&gt;, SRR14509895 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509896 &lt;dbl&gt;, SRR14509897 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509898 &lt;dbl&gt;, SRR14509899 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509900 &lt;dbl&gt;, SRR14509901 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509902 &lt;dbl&gt;, SRR14509903 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509904 &lt;dbl&gt;, SRR14509905 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SRR14509906 &lt;dbl&gt;, SRR14509907 &lt;dbl&gt;</span></span></code></pre></div>
</div>
<div id="visualizing-multiple-enrichment-results" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> Visualizing multiple enrichment results<a class="anchor" aria-label="anchor" href="#visualizing-multiple-enrichment-results"><i class="fas fa-link"></i></a>
</h2>
<p>You can visualize the results of multiple enrichment analyses. Similar to using the <code>ggkegg</code> function with the <code>enrichResult</code> class, there is an <code>append_cp</code> function that can be used within the <code>mutate</code> function. By providing an <code>enrichResult</code> object to this function, if the pathway being visualized is present in the result, the gene information within the pathway can be reflected in the graph.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## These are RDAs storing DEGs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"degListRPTEC.rda"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"degURO.rda"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span>;</span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/biomedical-knowledge-mining-book/">clusterProfiler</a></span><span class="op">)</span>;</span>
<span><span class="va">input_uro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/bitr.html">bitr</a></span><span class="op">(</span><span class="va">uroUp</span>,</span>
<span>              fromType <span class="op">=</span> <span class="st">"SYMBOL"</span>,</span>
<span>              toType <span class="op">=</span> <span class="st">"ENTREZID"</span>,</span>
<span>              OrgDb <span class="op">=</span> <span class="va">org.Hs.eg.db</span><span class="op">)</span><span class="op">$</span><span class="va">ENTREZID</span></span>
<span><span class="va">input_rptec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/bitr.html">bitr</a></span><span class="op">(</span><span class="va">gls</span><span class="op">$</span><span class="va">day3_up_rptec</span>,</span>
<span>              fromType <span class="op">=</span> <span class="st">"SYMBOL"</span>,</span>
<span>              toType <span class="op">=</span> <span class="st">"ENTREZID"</span>,</span>
<span>              OrgDb <span class="op">=</span> <span class="va">org.Hs.eg.db</span><span class="op">)</span><span class="op">$</span><span class="va">ENTREZID</span></span>
<span></span>
<span><span class="va">ekuro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/enrichKEGG.html">enrichKEGG</a></span><span class="op">(</span>gene <span class="op">=</span> <span class="va">input_uro</span><span class="op">)</span></span>
<span><span class="va">ekrptec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/enrichKEGG.html">enrichKEGG</a></span><span class="op">(</span>gene <span class="op">=</span> <span class="va">input_rptec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/pathway.html">pathway</a></span><span class="op">(</span><span class="st">"hsa04110"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>uro<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/append_cp.html">append_cp</a></span><span class="op">(</span><span class="va">ekuro</span>, how<span class="op">=</span><span class="st">"all"</span><span class="op">)</span>,</span>
<span>                                    rptec<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/append_cp.html">append_cp</a></span><span class="op">(</span><span class="va">ekrptec</span>, how<span class="op">=</span><span class="st">"all"</span><span class="op">)</span>,</span>
<span>                                    converted_name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/convert_id.html">convert_id</a></span><span class="op">(</span><span class="st">"hsa"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">g1</span>, layout<span class="op">=</span><span class="st">"manual"</span>, x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.5</span>, arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">'mm'</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                 start_cap <span class="op">=</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geometry.html">square</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">'cm'</span><span class="op">)</span>,</span>
<span>                 end_cap <span class="op">=</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geometry.html">square</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="st">'cm'</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">subtype</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_node_rect</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">uro</span>, xmin<span class="op">=</span><span class="va">xmin</span>, xmax<span class="op">=</span><span class="va">x</span>,  filter<span class="op">=</span><span class="va">type</span><span class="op">==</span><span class="st">"gene"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_node_rect</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">rptec</span>, xmin<span class="op">=</span><span class="va">x</span>, xmax<span class="op">=</span><span class="va">xmax</span>, filter<span class="op">=</span><span class="va">type</span><span class="op">==</span><span class="st">"gene"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>,<span class="st">"tomato"</span><span class="op">)</span>, name<span class="op">=</span><span class="st">"urothelial|rptec"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggfx</span><span class="fu">::</span><span class="fu"><a href="https://ggfx.data-imaginist.com/reference/with_outer_glow.html">with_outer_glow</a></span><span class="op">(</span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_text.html">geom_node_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">converted_name</span>, filter<span class="op">=</span><span class="va">type</span><span class="op">!=</span><span class="st">"group"</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span>, colour<span class="op">=</span><span class="st">"white"</span>, expand<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-usecases_files/figure-html/multcp-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>The example below applies a similar reflection to the Raw KEGG map and highlights genes that show statistically significant changes under both conditions using <code>ggfx</code>, with composing <code>dotplot</code> produced by clusterProfiler for the enrichment results by <code>patchwork</code>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="va">right</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/dotplot.html">dotplot</a></span><span class="op">(</span><span class="va">ekuro</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Urothelial"</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span></span>
<span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/dotplot.html">dotplot</a></span><span class="op">(</span><span class="va">ekrptec</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RPTECs"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/pathway.html">pathway</a></span><span class="op">(</span><span class="st">"hsa03410"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>uro<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/append_cp.html">append_cp</a></span><span class="op">(</span><span class="va">ekuro</span>, how<span class="op">=</span><span class="st">"all"</span><span class="op">)</span>,</span>
<span>        rptec<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/append_cp.html">append_cp</a></span><span class="op">(</span><span class="va">ekrptec</span>, how<span class="op">=</span><span class="st">"all"</span><span class="op">)</span>,</span>
<span>        converted_name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/convert_id.html">convert_id</a></span><span class="op">(</span><span class="st">"hsa"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">g1</span>, layout<span class="op">=</span><span class="st">"manual"</span>, x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggfx</span><span class="fu">::</span><span class="fu"><a href="https://ggfx.data-imaginist.com/reference/with_outer_glow.html">with_outer_glow</a></span><span class="op">(</span></span>
<span>    <span class="fu">geom_node_rect</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>filter<span class="op">=</span><span class="va">uro</span><span class="op">&amp;</span><span class="va">rptec</span>, xmin<span class="op">=</span><span class="va">xmin</span><span class="op">+</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                   color<span class="op">=</span><span class="st">"gold"</span>, fill<span class="op">=</span><span class="st">"transparent"</span><span class="op">)</span>,</span>
<span>    colour<span class="op">=</span><span class="st">"gold"</span>, expand<span class="op">=</span><span class="fl">15</span>, sigma<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_node_rect</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">uro</span>, xmin<span class="op">=</span><span class="va">xmin</span><span class="op">+</span><span class="fl">0.5</span>, xmax<span class="op">=</span><span class="va">xmax</span>,  filter<span class="op">=</span><span class="va">type</span><span class="op">==</span><span class="st">"gene"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_node_rect</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">rptec</span>, xmin<span class="op">=</span><span class="va">x</span><span class="op">+</span><span class="fl">0.5</span>, xmax<span class="op">=</span><span class="va">xmax</span>, filter<span class="op">=</span><span class="va">type</span><span class="op">==</span><span class="st">"gene"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/overlay_raw_map.html">overlay_raw_map</a></span><span class="op">(</span><span class="st">"hsa03410"</span>, transparent_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#cccccc"</span>,<span class="st">"#FFFFFF"</span>,<span class="st">"#BFBFFF"</span>,<span class="st">"#BFFFBF"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>,<span class="st">"tomato"</span><span class="op">)</span>,</span>
<span>                    name<span class="op">=</span><span class="st">"urothelial|rptec"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gg2</span> <span class="op">&lt;-</span> <span class="va">gg</span> <span class="op">+</span> <span class="va">right</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>design<span class="op">=</span><span class="st">"</span></span>
<span><span class="st">AAAA###</span></span>
<span><span class="st">AAAABBB</span></span>
<span><span class="st">AAAABBB</span></span>
<span><span class="st">AAAA###</span></span>
<span><span class="st">"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"tmp.png"</span>,<span class="va">gg2</span>,width<span class="op">=</span><span class="fl">20</span>,height<span class="op">=</span><span class="fl">15</span>,dpi<span class="op">=</span><span class="fl">300</span>,units<span class="op">=</span><span class="st">"in"</span><span class="op">)</span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/draw_image.html">draw_image</a></span><span class="op">(</span><span class="st">"tmp.png"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-usecases_files/figure-html/multcp2-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="projecting-the-gene-regulatory-networks-on-kegg-map" class="section level2" number="5.4">
<h2>
<span class="header-section-number">5.4</span> Projecting the gene regulatory networks on KEGG map<a class="anchor" aria-label="anchor" href="#projecting-the-gene-regulatory-networks-on-kegg-map"><i class="fas fa-link"></i></a>
</h2>
<p>With this package, it is possible to project inferred networks such as gene regulatory networks or KO networks inferred by other software onto KEGG maps. The following is an example of projecting a subset of KO networks within a pathway inferred by CBNplot onto the reference map of the corresponding pathway using <code>MicrobiomeProfiler</code>. Of course, it is also possible to project networks created using other methods.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidygraph.data-imaginist.com">tidygraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/noriakis/CBNplot">CBNplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ggkegg</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/YuLab-SMU/MicrobiomeProfiler/">MicrobiomeProfiler</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Rat_data</span><span class="op">)</span></span>
<span><span class="va">ko.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MicrobiomeProfiler/man/enrichKO.html">enrichKO</a></span><span class="op">(</span><span class="va">Rat_data</span><span class="op">)</span></span>
<span><span class="va">exp.dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">910</span><span class="op">)</span><span class="op">)</span>, <span class="fl">91</span>, <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">set_rownames</a></span><span class="op">(</span>value<span class="op">=</span><span class="va">Rat_data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">set_colnames</a></span><span class="op">(</span>value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'S'</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">returnnet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CBNplot/man/bngeneplot.html">bngeneplot</a></span><span class="op">(</span><span class="va">ko.res</span>, exp<span class="op">=</span><span class="va">exp.dat</span>, pathNum<span class="op">=</span><span class="fl">1</span>, orgDb<span class="op">=</span><span class="cn">NULL</span>,returnNet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">pg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/pathway.html">pathway</a></span><span class="op">(</span><span class="st">"ko00650"</span><span class="op">)</span></span>
<span><span class="va">joined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/combine_with_bnlearn.html">combine_with_bnlearn</a></span><span class="op">(</span><span class="va">pg</span>, <span class="va">returnnet</span><span class="op">$</span><span class="va">str</span>, <span class="va">returnnet</span><span class="op">$</span><span class="va">av</span><span class="op">)</span></span></code></pre></div>
<p>Plot the resulting map. In this example, the strength estimated by CBNplot is first displayed with colored edges, and then the edges of the reference graph are drawn in black on top of it.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">joined</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html">activate</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>convertKO<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggkegg/man/convert_id.html">convert_id</a></span><span class="op">(</span><span class="st">"ko"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html">activate</a></span><span class="op">(</span><span class="va">edges</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">2</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>filter<span class="op">=</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">strength</span><span class="op">)</span>, color<span class="op">=</span><span class="va">strength</span><span class="op">)</span>,</span>
<span>                 start_cap<span class="op">=</span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geometry.html">circle</a></span><span class="op">(</span><span class="fl">4</span>,<span class="st">"mm"</span><span class="op">)</span>,</span>
<span>                 end_cap<span class="op">=</span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geometry.html">circle</a></span><span class="op">(</span><span class="fl">4</span>,<span class="st">"mm"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span></span>
<span>    width<span class="op">=</span><span class="fl">0.1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>filter<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">strength</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    start_cap<span class="op">=</span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geometry.html">circle</a></span><span class="op">(</span><span class="fl">4</span>,<span class="st">"mm"</span><span class="op">)</span>,</span>
<span>    end_cap<span class="op">=</span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geometry.html">circle</a></span><span class="op">(</span><span class="fl">4</span>,<span class="st">"mm"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/scale_edge_colour.html">scale_edge_color_gradient</a></span><span class="op">(</span>low<span class="op">=</span><span class="st">"blue"</span>,high<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_node_rect</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"white"</span>, color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_text.html">geom_node_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">convertKO</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-usecases_files/figure-html/konetplot-1.png" width="100%" style="display: block; margin: auto;"></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="network.html"><span class="header-section-number">4</span> Network</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#usecases"><span class="header-section-number">5</span> Usecases</a></li>
<li><a class="nav-link" href="#visualizing-numerical-attributes-from-deseq2"><span class="header-section-number">5.1</span> Visualizing numerical attributes from DESeq2</a></li>
<li><a class="nav-link" href="#integrating-matrix-to-tbl_graph"><span class="header-section-number">5.2</span> Integrating matrix to tbl_graph</a></li>
<li><a class="nav-link" href="#visualizing-multiple-enrichment-results"><span class="header-section-number">5.3</span> Visualizing multiple enrichment results</a></li>
<li><a class="nav-link" href="#projecting-the-gene-regulatory-networks-on-kegg-map"><span class="header-section-number">5.4</span> Projecting the gene regulatory networks on KEGG map</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>ggkegg</strong>" was written by Noriaki Sato. It was last built on 2023-04-25.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
