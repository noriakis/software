[{"path":"/articles/usage_of_stana.html","id":"stana","dir":"Articles","previous_headings":"","what":"stana","title":"stana","text":"stana library strain-level analysis metagenomic dataset using single nucleotide variants profile gene contents. Multiple softwares described, MIDAS2, metaSNV, InStrain. library load profile stana class object perform various analysis like marker gene detection visualization trees based metadata. , included sample stana class object profiled 26 metagenome samples processed MIDAS2 UHGG, random grouping PRJEB9584. data loaded loadMIDAS2 function. One species profile, identifier 100003 (s__Alistipes shahii) loaded. loading dataset, filter options can applied. filtType specifies filtering applied, whole group. filtNum specifies number, filtPer specifies fraction samples. instance, group filtNum=2, species sampled number equal 2 per group included.","code":"## Specify the output of `merge` command with grouping stana <- loadMIDAS2(\"merge_midas2_sample\", cl=randomGroup, candSp=\"100003\",                     loadSummary=TRUE,loadInfo=TRUE,loadDepth=TRUE,                     taxtbl=taxtbl, db=\"uhgg\") library(stana) ## Examine sample object load(system.file(\"extdata\", \"sysdata.rda\", package = \"stana\")) stana ## Type: MIDAS2 ## Directory: midas2_sample_merge_uhgg ## Species: 1 ## Filter type: group, number: 1, proportion: 0.8 ## Loaded SNV table: 1 ##   Species cleared SNV filter: 1 ## Loaded gene table (copynum): 1 ##   Species cleared gene filter: 1 ## 7.2 Mb"},{"path":"/articles/usage_of_stana.html","id":"filtering","dir":"Articles","previous_headings":"stana","what":"Filtering","title":"stana","text":"species satisfies filtering criteria specified can accessed slot clearSnps storing species ID. taxtbl provided load* functions, clearSnpsSpecies species name.","code":"stana@clearSnps ## [1] \"100003\" stana@clearSnpsSpecies ## [1] \"d__Bacteria;p__Bacteroidota;c__Bacteroidia;o__Bacteroidales;f__Rikenellaceae;g__Alistipes;s__Alistipes shahii\""},{"path":"/articles/usage_of_stana.html","id":"calling-consensus-sequence","dir":"Articles","previous_headings":"stana","what":"Calling consensus sequence","title":"stana","text":"can call consensus sequence based SNV frequency table. implementation filtering options based original MIDAS script (call_consensus.py). resulting FASTA written current directory, loaded fastaList slot.","code":"library(phangorn) library(ggtree) stana <- consensusSeqMIDAS2(stana, species=\"100003\", verbose=FALSE) ## Beginning calling for 100003 ##   Site number: 5019 ##   Outputting consensus sequence to 100003_consensus.fasta ## Tree estimation and visualization by `phangorn` and `ggtree` dm <- dist.ml(stana@fastaList$`100003`) tre <- NJ(dm) stana@treeList[[\"100003\"]] <- tre tre <- groupOTU(tre, stana@cl) tp <- ggtree(tre, aes(color=.data$group),              layout='circular') +         geom_tippoint(size=3) tp"},{"path":"/articles/usage_of_stana.html","id":"perform-permanova-based-on-the-groups","dir":"Articles","previous_headings":"stana","what":"Perform PERMANOVA based on the groups","title":"stana","text":"","code":"stana <- doAdonis(stana, specs = \"100003\",target=\"tree\") ## Performing adonis in 100003 ##   R2: 0.0740407267582884, Pr: 0.712 stana@adonisList[[\"100003\"]] ## Permutation test for adonis under reduced model ## Terms added sequentially (first to last) ## Permutation: free ## Number of permutations: 999 ##  ## adonis2(formula = d ~ gr) ##          Df SumOfSqs      R2      F Pr(>F) ## gr        1  0.15557 0.07404 0.7196  0.712 ## Residual  9  1.94558 0.92596               ## Total    10  2.10115 1.00000"},{"path":"/articles/usage_of_stana.html","id":"compare-gene-abundances","dir":"Articles","previous_headings":"stana","what":"Compare gene abundances","title":"stana","text":"","code":"gn <- compareGenes(stana, \"100003\") ## Testing total of 21806 gn[[1]] ##  ##  Exact Wilcoxon rank sum test ##  ## data:  c(0.982529, 0.435857, 0, 0.901798, 0, 2.774428) and c(0.300139, 1.343209, 0.512896, 3.748899, 0, 2.778549, 1.870304, c(0.982529, 0.435857, 0, 0.901798, 0, 2.774428) and 1.201922, 5.260091, 2.926356) ## W = 15, p-value = 0.1169 ## alternative hypothesis: true mu is not equal to 0"},{"path":"/articles/usage_of_stana.html","id":"identify-key-elements-for-differentiating-groups","dir":"Articles","previous_headings":"stana","what":"Identify key elements for differentiating groups","title":"stana","text":"Using profiled matrices, Boruta algorithm can run identify key elements distinguish groups. doBoruta function performs Boruta algorithm clusters specified cl (NULL, cl slot used). pre-processed matrices used, please pass mat.","code":"library(Boruta)  ## You can provide preprocessed matrix to `mat` doBoruta(stana, target = \"gene\", sp=\"100003\") ## Using grouping from the slot ## If needed, please provide preprocessed matrix of genes to `mat` ## Feature number: 21806 ## Performing Boruta ## $boruta ## Boruta performed 99 iterations in 52.69646 secs. ## Tentatives roughfixed over the last 99 iterations. ##  6 attributes confirmed important: UHGG000008_01798, UHGG025234_01098, ## UHGG044133_01185, UHGG060667_01243, UHGG158704_01078 and 1 more; ##  21800 attributes confirmed unimportant: UHGG000008_00008, ## UHGG000008_00009, UHGG000008_00010, UHGG000008_00012, UHGG000008_00015 ## and 21795 more;"},{"path":"/articles/usage_of_stana.html","id":"parsing-functional-annotations","dir":"Articles","previous_headings":"stana","what":"Parsing functional annotations","title":"stana","text":"Functional annotation genes can obtained PATRIC server (used MIDAS), annotation results ortholog assignment using eggNOG-mapper v2. checkPATRIC checkEGGNOG function can used parse obtained data. example returns KEGG ORTHOLOGY eggNOG-mapper v2 annotation file. , annotation file large code evaluated. Using parsed annotation tibble, gene copy number data frame can summarised user-defined function, mean. Note annotation tibble must ID value column specifying gene ID ID functional annotation KEGG ORTHOLOGY ID value.","code":"## Not to be evaluated annotationFile <- \"100003_uhgg_eggnog_out.emapper.annotations\" annot <- checkEGGNOG(annotationFile, ret = \"KEGG_ko\") annot ## Not to be evaluated summariseAbundance(stana, \"100224\", annot)"},{"path":"/articles/usage_of_stana.html","id":"visualization","dir":"Articles","previous_headings":"stana","what":"Visualization","title":"stana","text":"Several visualization functions implemented.","code":""},{"path":"/articles/usage_of_stana.html","id":"plotting-mean-coverage-across-samples","dir":"Articles","previous_headings":"stana > Visualization","what":"Plotting mean coverage across samples","title":"stana","text":"","code":"plotCoverage(stana, \"100003\")+ ## grouping is already set   ggrepel::geom_text_repel(aes(label=ids), bg.colour=\"white\")"},{"path":"/articles/usage_of_stana.html","id":"plotting-gene-abundances","dir":"Articles","previous_headings":"stana > Visualization","what":"Plotting gene abundances","title":"stana","text":"","code":"plotGenes(stana, \"100003\", geneID=stana@genes[[1]] |> row.names() |> head(3))"},{"path":"/articles/usage_of_stana.html","id":"plotting-circlize-plot","dir":"Articles","previous_headings":"stana > Visualization","what":"Plotting circlize plot","title":"stana","text":"example, mean minor allele frequency SNV genes genome UHGG000008 per group plotted per track.","code":"library(circlize) plotCirclize(stana, \"100003\",             genomeId=\"UHGG000008\",             thresh_snp_gene = 20,             MAF=TRUE) ## Type is MIDAS2 ## Number of features: 2 ## Genome ID in SNV information: ##   UHGG000008_1: 19931 - 833384, number of position: 1611 ##   UHGG000008_9: 13883 - 41747, number of position: 37 ##   UHGG000008_11: 1490 - 15204, number of position: 33 ##   UHGG000008_12: 572 - 7764, number of position: 4 ##   UHGG000008_14: 4620 - 9836, number of position: 13 ##   UHGG000008_2: 34980 - 674435, number of position: 794 ##   UHGG000008_6: 51520 - 157827, number of position: 196 ##   UHGG000008_7: 869 - 73025, number of position: 151 ##   UHGG000008_8: 23107 - 48826, number of position: 63 ##   UHGG000008_3: 170 - 539467, number of position: 787 ##   UHGG000008_5: 1294 - 174869, number of position: 241 ##   UHGG000008_4: 18001 - 535622, number of position: 1089 ## Genome ID: UHGG000008 ## Included position: 100 sessionInfo() ## R version 4.2.1 (2022-06-23 ucrt) ## Platform: x86_64-w64-mingw32/x64 (64-bit) ## Running under: Windows 10 x64 (build 22621) ##  ## Matrix products: default ##  ## locale: ## [1] LC_COLLATE=Japanese_Japan.utf8  LC_CTYPE=Japanese_Japan.utf8    ## [3] LC_MONETARY=Japanese_Japan.utf8 LC_NUMERIC=C                    ## [5] LC_TIME=Japanese_Japan.utf8     ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] circlize_0.4.15  Boruta_8.0.0     ggtree_3.6.2     phangorn_2.11.1  ## [5] ape_5.7-1        stana_0.99.0     BiocStyle_2.24.0 ##  ## loaded via a namespace (and not attached): ##   [1] colorspace_2.1-0      rjson_0.2.21          rprojroot_2.0.3       ##   [4] GlobalOptions_0.1.2   fs_1.6.1              aplot_0.1.10          ##   [7] rstudioapi_0.14       farver_2.1.1          graphlayouts_0.8.4    ##  [10] ggrepel_0.9.3         bit64_4.0.5           fansi_1.0.4           ##  [13] ranger_0.15.1         codetools_0.2-18      splines_4.2.1         ##  [16] cachem_1.0.7          knitr_1.42            polyclip_1.10-4       ##  [19] jsonlite_1.8.4        cluster_2.1.3         dbplyr_2.3.2          ##  [22] ggforce_0.4.1         BiocManager_1.30.20   compiler_4.2.1        ##  [25] httr_1.4.5            Matrix_1.5-4          fastmap_1.1.1         ##  [28] lazyeval_0.2.2        cli_3.6.1             tweenr_2.0.2          ##  [31] htmltools_0.5.4       tools_4.2.1           igraph_1.5.0          ##  [34] gtable_0.3.3          glue_1.6.2            dplyr_1.1.1           ##  [37] rappdirs_0.3.3        fastmatch_1.1-3       Rcpp_1.0.10           ##  [40] jquerylib_0.1.4       pkgdown_2.0.7         vctrs_0.6.1           ##  [43] nlme_3.1-157          exactRankTests_0.8-35 ggraph_2.1.0.9000     ##  [46] xfun_0.37             stringr_1.5.0         lifecycle_1.0.3       ##  [49] MASS_7.3-57           scales_1.2.1          tidygraph_1.2.3       ##  [52] ragg_1.2.5            parallel_4.2.1        RColorBrewer_1.1-3    ##  [55] yaml_2.3.7            curl_5.0.0            memoise_2.0.1         ##  [58] gridExtra_2.3         ggplot2_3.4.2         ggfun_0.0.9           ##  [61] yulab.utils_0.0.6     sass_0.4.5            stringi_1.7.12        ##  [64] RSQLite_2.3.0         highr_0.10            desc_1.4.2            ##  [67] tidytree_0.4.2        permute_0.9-7         filelock_1.0.2        ##  [70] shape_1.4.6           rlang_1.1.0           pkgconfig_2.0.3       ##  [73] systemfonts_1.0.4     bitops_1.0-7          evaluate_0.20         ##  [76] lattice_0.20-45       purrr_1.0.1           treeio_1.22.0         ##  [79] patchwork_1.1.2       labeling_0.4.2        bit_4.0.5             ##  [82] tidyselect_1.2.0      magrittr_2.0.3        bookdown_0.33         ##  [85] R6_2.5.1              generics_0.1.3        DBI_1.1.3             ##  [88] pillar_1.9.0          withr_2.5.0           mgcv_1.8-40           ##  [91] RCurl_1.98-1.10       tibble_3.2.1          crayon_1.5.2          ##  [94] utf8_1.2.3            BiocFileCache_2.6.1   rmarkdown_2.20        ##  [97] viridis_0.6.2         GetoptLong_1.0.5      grid_4.2.1            ## [100] data.table_1.14.8     blob_1.2.4            vegan_2.6-4           ## [103] digest_0.6.31         tidyr_1.3.0           gridGraphics_0.5-1    ## [106] textshaping_0.3.6     munsell_0.5.0         viridisLite_0.4.1     ## [109] ggplotify_0.1.0       bslib_0.4.2           quadprog_1.5-8"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Noriaki Sato. Maintainer, author.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Sato N (2023). stana: Strain-level metagenomic analysis R. R package version 0.99.0.","code":"@Manual{,   title = {stana: Strain-level metagenomic analysis in R},   author = {Noriaki Sato},   year = {2023},   note = {R package version 0.99.0}, }"},{"path":"/index.html","id":"stana","dir":"","previous_headings":"","what":"Strain-level metagenomic analysis in R","title":"Strain-level metagenomic analysis in R","text":"Strain-level metagenomic analysis R. Import analyse, plot output software like MIDAS, MIDAS2, metaSNV v1, metaSNV v2 inStrain. grow complete package. Primarly developed MIDAS MIDAS2.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Strain-level metagenomic analysis in R","text":"","code":"devtools::install_github(\"noriakis/stana\")"},{"path":"/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Strain-level metagenomic analysis in R","text":"documentation available using pkgdown https://noriakis.github.io/software/stana.","code":""},{"path":"/index.html","id":"databases","dir":"","previous_headings":"","what":"Databases","title":"Strain-level metagenomic analysis in R","text":"midas_db_v1.2: Contains 31,007 bacterial reference genomes clustered 5,952 species groups. UHGG (MIDAS2): Contains 286,997 genomes clustered 4,644 species (human stool samples). GTDB (MIDAS2): Contains 258,406 genomes clustered 45,555 bacterial 2,339 archaeal species. proGenomes2, proGenomes3","code":""},{"path":"/index.html","id":"example-analysis","dir":"","previous_headings":"","what":"Example analysis","title":"Strain-level metagenomic analysis in R","text":"function includes filtering species based clinical / environmental variables interested, calling consensus sequencing, constructing tree, plotting results based groups, functional annotations. example shows analysis subset PRJEB9584, sequenced HiSeq 2000. Packages including ggtree, ComplexHeatmap, simplyfyEnrichment, phangorn, circlize, ggraph used.","code":""},{"path":"/index.html","id":"todo","dir":"","previous_headings":"","what":"TODO","title":"Strain-level metagenomic analysis in R","text":"Read data S4 class, perform downstream analysis. Currently package reads data per function. Add filters tree inferring options consensusSeq(). Add reasonable filtering options loadInStrain loadmetaSNV","code":""},{"path":"/reference/alleleStat.html","id":null,"dir":"Reference","previous_headings":"","what":"alleleStat — alleleStat","title":"alleleStat — alleleStat","text":"Output statistics MAF, using site--sample  minor allele frequency table output MIDAS1 MIDAS2.","code":""},{"path":"/reference/alleleStat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"alleleStat — alleleStat","text":"","code":"alleleStat(stana, sp, cl = NULL, base = \"maj\", deleteZeroDepth = FALSE)"},{"path":"/reference/alleleStat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"alleleStat — alleleStat","text":"stana stana object sp candidate species cl named list clusters samples base \"maj\",\"ref\", \"majref\" deleteZeroDepth delete snvs zero depth","code":""},{"path":"/reference/anno_PATRIC_keywords.html","id":null,"dir":"Reference","previous_headings":"","what":"anno_PATRIC_keywords — anno_PATRIC_keywords","title":"anno_PATRIC_keywords — anno_PATRIC_keywords","text":"Annotate heatmap using functional terms derived PATRIC. function derived modified example  KeywordsEnrichment (https://github.com/jokergoo/KeywordsEnrichment)  using simplifyEnrichment package. Can replaced providing simplyfyEnrichment::anno_word_cloud()  split results checkPATRICSimple().","code":""},{"path":"/reference/anno_PATRIC_keywords.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"anno_PATRIC_keywords — anno_PATRIC_keywords","text":"","code":"anno_PATRIC_keywords(   split,   genes,   fnc = \"pathway_name\",   removeHigh = TRUE,   removeAdditional = NULL,   argList = list() )"},{"path":"/reference/anno_PATRIC_keywords.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"anno_PATRIC_keywords — anno_PATRIC_keywords","text":"split named list cluster genes gene names fnc \"pathway_name\" \"ec_description\" removeHigh remove frequent words removeAdditional remove words passed anno_word_cloud argList passed anno_word_cloud","code":""},{"path":"/reference/checkEGGNOG.html","id":null,"dir":"Reference","previous_headings":"","what":"checkEGGNOG — checkEGGNOG","title":"checkEGGNOG — checkEGGNOG","text":"interesting genes (e.g. differentially abundant category) found, one can query eggNOG-mapper functionality. function assumes one performs eggNOG-mapper centroids.ffn candidate species, parse annotation results.","code":""},{"path":"/reference/checkEGGNOG.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"checkEGGNOG — checkEGGNOG","text":"","code":"checkEGGNOG(annot_file, ret = \"all\", checkIDs = NULL)"},{"path":"/reference/checkEGGNOG.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"checkEGGNOG — checkEGGNOG","text":"annot_file path eggnog-mapper annotation ret default checkIDs return functions related IDs","code":""},{"path":"/reference/checkEGGNOG.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"checkEGGNOG — checkEGGNOG","text":"Choices IDs `ret`: \"COG_category\" \"Description\" \"Preferred_name\" \"GOs\"            \"EC\"             \"KEGG_ko\"        \"KEGG_Pathway\"   \"KEGG_Module\"    \"KEGG_Reaction\"  \"KEGG_rclass\"    \"BRITE\"          \"KEGG_TC\"        \"CAZy\"           \"BiGG_Reaction\"  \"PFAMs\"","code":""},{"path":"/reference/checkPATRIC.html","id":null,"dir":"Reference","previous_headings":"","what":"checkPATRIC — checkPATRIC","title":"checkPATRIC — checkPATRIC","text":"Obtain gene information PATRIC server. Input named list genes, returns queried results, Count functionality removing duplicate entries, network representation EC KEGG pathway. midas_db_v1.2 .","code":""},{"path":"/reference/checkPATRIC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"checkPATRIC — checkPATRIC","text":"","code":"checkPATRIC(   genes,   whichToCount = \"ec_description\",   delSize = 0,   showSubset = 5,   colText = \"cat\",   rel = FALSE,   lyt = \"nicely\",   nodeSize = \"count\",   skipGraph = TRUE )"},{"path":"/reference/checkPATRIC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"checkPATRIC — checkPATRIC","text":"genes named list genes whichToCount ec_description, ec_number, pathway_name, pathway_id delSize functions count threshold included showSubset graph, show number text ordered frequency (default: 5) colText color text (default: cat, EC KEGG) rel use relative frequency lyt ggraph layout (default: nicely) nodeSize 'count' 'degree' skipGraph skip graph plotting","code":""},{"path":"/reference/checkPATRICSimple.html","id":null,"dir":"Reference","previous_headings":"","what":"checkPATRICSimple — checkPATRICSimple","title":"checkPATRICSimple — checkPATRICSimple","text":"Obtain gene information PATRIC server. Input named list genes, returns named list functions. midas_db_v1.2 .","code":""},{"path":"/reference/checkPATRICSimple.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"checkPATRICSimple — checkPATRICSimple","text":"","code":"checkPATRICSimple(genes, whichToCount = \"ec_description\")"},{"path":"/reference/checkPATRICSimple.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"checkPATRICSimple — checkPATRICSimple","text":"genes named list genes whichToCount ec_description, ec_number, pathway_name, pathway_id","code":""},{"path":"/reference/checkProfile.html","id":null,"dir":"Reference","previous_headings":"","what":"checkProfile — checkProfile","title":"checkProfile — checkProfile","text":"Assess profile species return filtered species  based number samples category. MIDAS . Deprecated, use load* functions instead.","code":""},{"path":"/reference/checkProfile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"checkProfile — checkProfile","text":"","code":"checkProfile(midas_merge_dir, cl, filtNum = 2)"},{"path":"/reference/checkProfile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"checkProfile — checkProfile","text":"midas_merge_dir output directory merge_midas.py cl named list sample IDs filtNum species number threshold category returned","code":""},{"path":"/reference/cnDiscretize.html","id":null,"dir":"Reference","previous_headings":"","what":"Discretize copy number matrix at specified cutoff — cnDiscretize","title":"Discretize copy number matrix at specified cutoff — cnDiscretize","text":"Discretize copy number matrix specified cutoff","code":""},{"path":"/reference/cnDiscretize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Discretize copy number matrix at specified cutoff — cnDiscretize","text":"","code":"cnDiscretize(stana, species, cutoff = 0.35)"},{"path":"/reference/cnDiscretize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Discretize copy number matrix at specified cutoff — cnDiscretize","text":"stana stana object species species id cutoff cutoff value, default 0.35","code":""},{"path":"/reference/compareGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"compareGenes — compareGenes","title":"compareGenes — compareGenes","text":"compare gene abundances recursively performing Wilcoxon rank-sum tests Use exactRankTests package, multiple comparison adjustment performed","code":""},{"path":"/reference/compareGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"compareGenes — compareGenes","text":"","code":"compareGenes(   stana,   species,   geneID = NULL,   cl = NULL,   argList = list(),   verbose_zero = FALSE )"},{"path":"/reference/compareGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"compareGenes — compareGenes","text":"stana stana object species candidate species geneID gene ID plotted cl named list clusters argList argument list wilcox.exact verbose_zero show zero abundance genes","code":""},{"path":"/reference/compareGenes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"compareGenes — compareGenes","text":"ggplot","code":""},{"path":"/reference/consensusSeq.html","id":null,"dir":"Reference","previous_headings":"","what":"consensusSeq — consensusSeq","title":"consensusSeq — consensusSeq","text":"Output consensus sequences merged SNV output. Optionally, return phylogenetic tree inferred `phangorn`. specified cluster samples, additionally returns plot `ggtree`.","code":""},{"path":"/reference/consensusSeq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"consensusSeq — consensusSeq","text":"","code":"consensusSeq(stana, species, argList = list())"},{"path":"/reference/consensusSeq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"consensusSeq — consensusSeq","text":"stana stana object species species vectors argList parameters, passed corresponding functions","code":""},{"path":"/reference/consensusSeqMIDAS1.html","id":null,"dir":"Reference","previous_headings":"","what":"consensusSeqMIDAS1 — consensusSeqMIDAS1","title":"consensusSeqMIDAS1 — consensusSeqMIDAS1","text":"consensusSeqMIDAS1","code":""},{"path":"/reference/consensusSeqMIDAS1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"consensusSeqMIDAS1 — consensusSeqMIDAS1","text":"","code":"consensusSeqMIDAS1(   stana,   species,   mean_depth = 0,   fract_cov = 0,   site_depth = 5,   site_ratio = 5,   site_maf = 0.01,   allele_support = 0.5,   site_prev = 0.9,   cl = NULL,   max_sites = Inf,   tree = FALSE,   max_samples = Inf,   keep_samples = NULL,   exclude_samples = NULL,   rand_samples = NULL )"},{"path":"/reference/consensusSeqMIDAS1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"consensusSeqMIDAS1 — consensusSeqMIDAS1","text":"stana stana obj species candidate species vector mean_depth parameter filtering fract_cov parameter filtering site_depth parameter filtering site_ratio parameter filtering site_maf parameter filtering allele_support parameter filtering site_prev parameter filtering cl cluster, plot cladogram max_sites currently implemented tree perform tree inference max_samples currently implemented keep_samples currently implemented exclude_samples currently implemented rand_samples currently implemented","code":""},{"path":"/reference/consensusSeqMIDAS2.html","id":null,"dir":"Reference","previous_headings":"","what":"consensusSeqMIDAS2 — consensusSeqMIDAS2","title":"consensusSeqMIDAS2 — consensusSeqMIDAS2","text":"consensusSeqMIDAS2","code":""},{"path":"/reference/consensusSeqMIDAS2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"consensusSeqMIDAS2 — consensusSeqMIDAS2","text":"","code":"consensusSeqMIDAS2(   stana,   species,   output_seq = FALSE,   mean_depth = 0,   fract_cov = 0,   site_depth = 5,   site_ratio = 5,   site_maf = 0.01,   allele_support = 0.5,   site_prev = 0.9,   cl = NULL,   max_sites = Inf,   tree = FALSE,   max_samples = Inf,   keep_samples = NULL,   exclude_samples = NULL,   rand_samples = NULL,   verbose = FALSE )"},{"path":"/reference/consensusSeqMIDAS2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"consensusSeqMIDAS2 — consensusSeqMIDAS2","text":"stana stana obj species candidate species vector mean_depth parameter filtering fract_cov parameter filtering site_depth parameter filtering site_ratio parameter filtering site_maf parameter filtering allele_support parameter filtering site_prev parameter filtering cl cluster, plot cladogram max_sites default Inf tree perform tree inference max_samples currently implemented keep_samples currently implemented exclude_samples currently implemented rand_samples currently implemented verbose output current status","code":""},{"path":"/reference/doAdonis.html","id":null,"dir":"Reference","previous_headings":"","what":"doAdonis — doAdonis","title":"doAdonis — doAdonis","text":"Perform PERMANOVA distance matrix based  various distances based SNV frequency  gene matrix using `adonis2`. Named list samples provided. Note function currently performs  comparison using one category. complex design, one manually.","code":""},{"path":"/reference/doAdonis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doAdonis — doAdonis","text":"","code":"doAdonis(   stana,   specs,   cl = NULL,   target = \"snps\",   formula = NULL,   distMethod = \"manhattan\",   maj = FALSE,   deleteZeroDepth = FALSE,   argList = list() )"},{"path":"/reference/doAdonis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doAdonis — doAdonis","text":"stana stana object specs species examined cl named list samples target tree, snps, genes formula pass adonis2, specify distance matrix d. distMethod distance method passed dist() (default, manhattan) maj major allele distance deleteZeroDepth delete zero depth snvs (MIDAS2, denoted `-1`) argList parameters passed adonis2","code":""},{"path":"/reference/doBoruta.html","id":null,"dir":"Reference","previous_headings":"","what":"doBoruta — doBoruta","title":"doBoruta — doBoruta","text":"feature selection classification category using snv frequency gene matrix","code":""},{"path":"/reference/doBoruta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doBoruta — doBoruta","text":"","code":"doBoruta(   stana,   sp,   cl = NULL,   target = \"genes\",   mat = NULL,   whichToCount = \"ec_description\",   argList = list() )"},{"path":"/reference/doBoruta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doBoruta — doBoruta","text":"stana stana object sp candidate species ID cl named list category target default snps mat target snps, provide preprocessed gene matrix otherwise raw gene matrix used. whichToCount show box plots, pass checkPATRIC() (MIDAS1) argList passed Boruta()","code":""},{"path":"/reference/doBoruta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doBoruta — doBoruta","text":"Boruta object","code":""},{"path":"/reference/drawEGGNOG.html","id":null,"dir":"Reference","previous_headings":"","what":"drawEGGNOG — drawEGGNOG","title":"drawEGGNOG — drawEGGNOG","text":"draw graph representing eggNOG annotation","code":""},{"path":"/reference/drawEGGNOG.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"drawEGGNOG — drawEGGNOG","text":"","code":"drawEGGNOG(annot_file, geneIDs, candPlot)"},{"path":"/reference/drawEGGNOG.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"drawEGGNOG — drawEGGNOG","text":"annot_file annotation file geneIDs geneIDs candPlot vector consisting  \"cog\",\"ec\",\"ko\",\"kegg\",\"module\",\"reaction\"","code":""},{"path":"/reference/drawPATRIC.html","id":null,"dir":"Reference","previous_headings":"","what":"drawPATRIC — drawPATRIC","title":"drawPATRIC — drawPATRIC","text":"draw graph ec kegg pathway name using checkPATRIC().","code":""},{"path":"/reference/drawPATRIC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"drawPATRIC — drawPATRIC","text":"","code":"drawPATRIC(   genes,   whichToCount = \"ec_description\",   delSize = 0,   showSubset = 5,   colText = \"cat\",   rel = FALSE,   lyt = \"nicely\",   nodeSize = \"count\" )"},{"path":"/reference/drawPATRIC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"drawPATRIC — drawPATRIC","text":"genes named list genes whichToCount ec_description, ec_number, pathway_name, pathway_id delSize functions count threshold included showSubset graph, show number text ordered frequency (default: 5) colText color text (default: cat, EC KEGG) rel use relative frequency lyt ggraph layout (default: nicely) nodeSize 'count' 'degree'","code":""},{"path":"/reference/loadInStrain.html","id":null,"dir":"Reference","previous_headings":"","what":"loadInStrain — loadInStrain","title":"loadInStrain — loadInStrain","text":"InStrain, provide `compare` output --bams options implmented version 1.6. computes MAF var_base per position return frequency matrix. Filters popSNV conSNV added.","code":""},{"path":"/reference/loadInStrain.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"loadInStrain — loadInStrain","text":"","code":"loadInStrain(   compare_out_dir,   sample_threshold,   candidate_species,   just_species = FALSE )"},{"path":"/reference/loadInStrain.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"loadInStrain — loadInStrain","text":"compare_out_dir output directory compare. need `output` directory sample_threshold SNVs least number samples included candidate_species candidate species ID, e.g. `GUT_GENOME000024` just_species TRUE, returns vector species IDs","code":""},{"path":"/reference/loadmetaSNV.html","id":null,"dir":"Reference","previous_headings":"","what":"loadmetaSNV — loadmetaSNV","title":"loadmetaSNV — loadmetaSNV","text":"Assess store profile species return filtered species  based number samples category whole population. metaSNV .","code":""},{"path":"/reference/loadmetaSNV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"loadmetaSNV — loadmetaSNV","text":"","code":"loadmetaSNV(   metasnv_out_dir,   cl = NULL,   filtType = \"group\",   candSp = NULL,   filtNum = 2,   filtPer = 0.8 )"},{"path":"/reference/loadmetaSNV.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"loadmetaSNV — loadmetaSNV","text":"metasnv_out_dir output directory merge_midas.py cl named list sample IDs filtType \"whole\" \"group\" candSp candidate species ID filtNum species samples number returned filtPer filter fraction","code":""},{"path":"/reference/loadMIDAS.html","id":null,"dir":"Reference","previous_headings":"","what":"loadMIDAS — loadMIDAS","title":"loadMIDAS — loadMIDAS","text":"Assess store profile species return filtered species  based number samples category whole population. MIDAS .","code":""},{"path":"/reference/loadMIDAS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"loadMIDAS — loadMIDAS","text":"","code":"loadMIDAS(   midas_merge_dir,   cl,   filtType = \"group\",   candSp = NULL,   filtNum = 2,   filtPer = 0.8,   geneType = \"copynum\" )"},{"path":"/reference/loadMIDAS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"loadMIDAS — loadMIDAS","text":"midas_merge_dir output directory merge_midas.py cl named list sample IDs filtType \"whole\" \"group\" candSp candidate species ID filtNum species number threshold category returned filtPer filter fraction geneType \"presabs\" \"copynum\"","code":""},{"path":"/reference/loadMIDAS2.html","id":null,"dir":"Reference","previous_headings":"","what":"loadMIDAS2 — loadMIDAS2","title":"loadMIDAS2 — loadMIDAS2","text":"load MIDAS2 merge command output. location lz4 binary must added PATH. Taxonomy table can loaded downloaded MIDAS2 db directory (metadata.tsv). provided, additionally show tax names.","code":""},{"path":"/reference/loadMIDAS2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"loadMIDAS2 — loadMIDAS2","text":"","code":"loadMIDAS2(   midas_merge_dir,   cl,   filtNum = 2,   db = \"gtdb\",   filtPer = 0.8,   taxtbl = NULL,   candSp = NULL,   filtType = \"group\",   geneType = \"copynum\",   loadSummary = FALSE,   loadInfo = FALSE,   loadDepth = FALSE )"},{"path":"/reference/loadMIDAS2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"loadMIDAS2 — loadMIDAS2","text":"midas_merge_dir path merged directory cl named list category samples filtNum species samples number returned db data base used profile, default gtdb. filtPer filter fraction taxtbl tax table, row.names: 6-digits MIDAS2 ID `GTDB species` (gtdb) `Lineage` column. candSp candidate species ID filtType \"whole\" \"group\" geneType \"presabs\" \"copynum\" loadSummary default FALSE, load summary information. loadInfo default FALSE, load info information. loadDepth default FALSE, load depth information.","code":""},{"path":"/reference/plotCirclize.html","id":null,"dir":"Reference","previous_headings":"","what":"plotCirclize — plotCirclize","title":"plotCirclize — plotCirclize","text":"Using `circlize` package, make circular visualization  relationship genes corresponding SNVs genes.","code":""},{"path":"/reference/plotCirclize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotCirclize — plotCirclize","text":"","code":"plotCirclize(   stana,   candSp,   genomeId,   include_gene = NULL,   thresh_snp_gene = 5,   featList = list(),   cols = c(\"tomato\", \"steelblue\", \"gold\", \"seagreen\"),   controlColor = \"steelblue\",   MAF = FALSE,   cl = NULL,   featCircos = list(),   showGeneName = TRUE,   returnRawDf = FALSE,   featThresh = 0,   cex = 0.3,   textCex = 0.5,   bar_width = 10,   contPalette = c(\"steelblue\", \"tomato\"),   discPalette = \"Dark2\" )"},{"path":"/reference/plotCirclize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotCirclize — plotCirclize","text":"stana stana object candSp candidate species ID genomeId genome ID plot thresh_snp_gene include genes least number SNVs featList features plot cols color feature controlColor control (reaching `featThresh`) color points barplot MAF plot MAF group cl cluster information (named list) featCircos type circos use corresponding feature showGeneName show gene ID plot returnRawDf return raw data frame used plot featThresh numeric features, values value colored , default zero. cex point size textCex text size bar_width circos.barplot contPalette palette continuous scale discPalette palette discrete scale","code":""},{"path":"/reference/plotCirclize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plotCirclize — plotCirclize","text":"draw circlize plot","code":""},{"path":"/reference/plotCoverage.html","id":null,"dir":"Reference","previous_headings":"","what":"plotCoverage — plotCoverage","title":"plotCoverage — plotCoverage","text":"plot scatters mean coverage across groups MIDAS1","code":""},{"path":"/reference/plotCoverage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotCoverage — plotCoverage","text":"","code":"plotCoverage(stana, species, cl = NULL, pointSize = 5)"},{"path":"/reference/plotCoverage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotCoverage — plotCoverage","text":"stana stana object species candidate species cl named list clusters pointSize scatter point size","code":""},{"path":"/reference/plotCoverage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plotCoverage — plotCoverage","text":"ggplot","code":""},{"path":"/reference/plotGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"plotGenes — plotGenes","title":"plotGenes — plotGenes","text":"plot violin plot specific genes","code":""},{"path":"/reference/plotGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotGenes — plotGenes","text":"","code":"plotGenes(stana, species, geneID, cl = NULL)"},{"path":"/reference/plotGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotGenes — plotGenes","text":"stana stana object species candidate species geneID gene ID plotted cl named list clusters","code":""},{"path":"/reference/plotGenes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plotGenes — plotGenes","text":"ggplot","code":""},{"path":"/reference/plotPCA.html","id":null,"dir":"Reference","previous_headings":"","what":"plotPCA — plotPCA","title":"plotPCA — plotPCA","text":"plot PCA results snp gene table","code":""},{"path":"/reference/plotPCA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotPCA — plotPCA","text":"","code":"plotPCA(   stana,   species,   cl,   target = \"snps\",   ignore = FALSE,   replace = FALSE,   pointSize = 5,   ltype = 2,   useBlend = FALSE )"},{"path":"/reference/plotPCA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotPCA — plotPCA","text":"stana output midas merge species candidate species cl named list clusters target snps, genes ignore ignore SNVs containing -1 pointSize scatter point size ltype line type ellipse useBlend use ggblend point replaceZero replace SNVs -1 (zero depth) zero","code":""},{"path":"/reference/summariseAbundance.html","id":null,"dir":"Reference","previous_headings":"","what":"summariseAbundance — summariseAbundance","title":"summariseAbundance — summariseAbundance","text":"Given tibble `ID` `value` column, Obtain data.frame genes consisting `ID` within `value` summarise default `mean`.","code":""},{"path":"/reference/summariseAbundance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"summariseAbundance — summariseAbundance","text":"","code":"summariseAbundance(stana, sp, anno, how = mean)"},{"path":"/reference/summariseAbundance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"summariseAbundance — summariseAbundance","text":"stana stana object sp candidate species anno annotation tibble summarising function, default mean","code":""},{"path":"/reference/summariseAbundance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"summariseAbundance — summariseAbundance","text":"data.frame","code":""}]
